<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Validate your passwords using Elixir and haveibeenpwned.com's API | Ilija Eftimov ⚡️</title><meta name=keywords content="haveibeenpwned,api,passwords"><meta name=description content="Unless you&rsquo;ve been living under a rock for the last couple of years, you probably know what two-factor authentication (2FA) is. It&rsquo;s quite a neat trick actually - you have a password that you have to (obviously) enter correctly (first factor), but you also have to receive a second (random) code through a different medium, sometimes on a different device, that you have to enter to log in (second factor)."><meta name=author content="Ilija"><link rel=canonical href=https://ieftimov.com/post/haveibeenpwned-password-lookup-elixir/><link href=/assets/css/stylesheet.min.css rel="preload stylesheet" as=style><link rel=icon href=https://ieftimov.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ieftimov.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ieftimov.com/favicon-32x32.png><link rel=apple-touch-icon href=https://ieftimov.com/apple-touch-icon.png><link rel=mask-icon href=https://ieftimov.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.81.0"><script async defer data-domain=ieftimov.com src=https://plausible.io/js/plausible.js></script><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel=stylesheet><meta property="og:title" content="Validate your passwords using Elixir and haveibeenpwned.com's API"><meta property="og:description" content="Unless you&rsquo;ve been living under a rock for the last couple of years, you probably know what two-factor authentication (2FA) is. It&rsquo;s quite a neat trick actually - you have a password that you have to (obviously) enter correctly (first factor), but you also have to receive a second (random) code through a different medium, sometimes on a different device, that you have to enter to log in (second factor)."><meta property="og:type" content="article"><meta property="og:url" content="https://ieftimov.com/post/haveibeenpwned-password-lookup-elixir/"><meta property="og:image" content="https://ieftimov.com/cards/haveibeenpwned-password-lookup-elixir.png"><meta property="article:published_time" content="2018-12-23T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ieftimov.com/cards/haveibeenpwned-password-lookup-elixir.png"><meta name=twitter:title content="Validate your passwords using Elixir and haveibeenpwned.com's API"><meta name=twitter:description content="Unless you&rsquo;ve been living under a rock for the last couple of years, you probably know what two-factor authentication (2FA) is. It&rsquo;s quite a neat trick actually - you have a password that you have to (obviously) enter correctly (first factor), but you also have to receive a second (random) code through a different medium, sometimes on a different device, that you have to enter to log in (second factor)."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ieftimov.com/posts/"},{"@type":"ListItem","position":2,"name":"Validate your passwords using Elixir and haveibeenpwned.com's API","item":"https://ieftimov.com/post/haveibeenpwned-password-lookup-elixir/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Validate your passwords using Elixir and haveibeenpwned.com's API","name":"Validate your passwords using Elixir and haveibeenpwned.com\u0027s API","description":"Unless you\u0026amp;rsquo;ve been living under a rock for the last couple of years, you probably know what two-factor authentication (2FA) is. It\u0026amp;rsquo;s quite a neat trick actually - you …","keywords":["haveibeenpwned","api","passwords"],"articleBody":"Unless you’ve been living under a rock for the last couple of years, you probably know what two-factor authentication (2FA) is. It’s quite a neat trick actually - you have a password that you have to (obviously) enter correctly (first factor), but you also have to receive a second (random) code through a different medium, sometimes on a different device, that you have to enter to log in (second factor).\nNow, obviously this adds quite a bit of overhead to logging in, but it adds a disproportionate value when it comes to security. If you work in any sort of organisation it was probably no surprise when you were asked to turn on 2FA for all your accounts. If you haven’t been asked to (or haven’t done it), it’s time to act ;)\nBut, what about factor No. 1? The password. Did we give up on them?\nNot really. But, for sure we had to become more vigilant and smarter when setting our passwords. Why? Allow me to explain.\nReader, meet haveibeenpwned.com Let me introduce you to haveibeenpwned.com. It’s a free resource for anyone to quickly assess if they may have been put at risk due to an online account of their’s having been compromised or “pwned” in a data breach. As you can imagine, to fulfil its purpose, this service also contains quite a long list of pwned passwords (about 500 million of them to be more precise), which are open for querying through a REST API.\nIf you want to learn more about the project, or it’s author, I suggest checking out the About page of the project.\nUsing the pwned passwords API This API allows us to check if any password is present in haveibeenpwned database. This means that if you send an already pwned password it will tell you that this password has been pwned and that it’s suggested to choose another one.\nImagine you have a website where people can set their passwords, and once the user finished typing their new password you can ping this service and check if the password they chose has been pwned before.\nNow, if you are thinking along the lines of “are you telling me to send a plain-text password across the wire to some random API?” then you’re a step ahead, well done!\nSorry to disappoint, but no, actually I am not saying that. Instead of sending the whole password in plain-text, this API only requires the 5 characters of the SHA-1 hash of the actual password.\nIn Elixir terms, that would look like:\n1 2 3  :crypto.hash(:sha, \"password\") | Base.encode16 | String.slice(0..4)   Interestingly what it sends back is the remainder of the hashed passwords that match the 5 characters that you sent. Basically, this means if we take a SHA-1 of “password”:\n1 2  iex(1) :crypto.hash(:sha, \"password\") | Base.encode16 \"5BAA61E4C9B93F3F0682250B6CF8331B7EE68FD8\"   We will send only 5BAA6 to the API, while in the response body we will receive a big list of strings that will represent the rest of the SHA-1, or in our example that would be 1E4C9B93F3F0682250B6CF8331B7EE68FD8.\nTroy Hunt, who’s the author of haveibeenpwned has written quite an extensive explanation on how this works - you can read it here.\nPinging the API For the purpose of this exercise, we will create a small Mix package that will encapsulate all of the behaviours. If you’re not familiar with how to create new packages using Mix, I suggest reading my article Write and publish your first Elixir library.\nWe will call our package Pwnex because somehow my brain always thinks that I have to mix up the main word (pwned) with Elixir to come up with a name. Anyway, let’s create it:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  › mix new pwnex * creating README.md * creating .formatter.exs * creating .gitignore * creating mix.exs * creating config * creating config/config.exs * creating lib * creating lib/pwnex.ex * creating test * creating test/test_helper.exs * creating test/pwnex_test.exs Your Mix project was created successfully. You can use \"mix\" to compile it, test it, and more: cd pwnex mix test Run \"mix help\" for more commands.   Now that we have the package bootstrapped locally, let’s open lib/pwnex.ex and add some documentation:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  defmodule Pwnex do @moduledoc \"\"\" Consults haveibeenpwned.com's API for pwned passwords. \"\"\" @doc \"\"\" Checks if a given password is already pwned. ##Examples iex Pwnex.pwned?(\"password\") {:pwned, 3_000_000} iex Pwnex.pwned?(\"m4Z2fJJ]r3fxQ*o27\") {:ok, 0} \"\"\" def pwned?(password) do end end   The moduledoc briefly explains the purpose of the package, while the doc explains the purpose of the pwned?/1 function and has two examples that we could use in the doctests.\nOur little algorithm Let’s see what would be the steps to implement the Pwnex.pwned?/1 function:\n1 2 3 4 5 6 7 8 9 10 11 12 13  def pwned?(password) do {hash_head, hash_tail} = password | sanitize | hash | split_password hash_head | fetch_pwns | handle_response | find_pwns(hash_tail) | return_result end   Once more - the pipeline operator in Elixir makes this function so clear and procedure-like that explaining feels a tad redundant. Still, here it is:\n sanitize - we want to remove all leading and trailing whitespaces from the password hash - we want to convert the password to a SHA1 hash and return it’s first 5 characters split_password - we want to split the head - first 5 characters that we will send to the API and the tail - the rest of the SHA-1 hash fetch_pwns - we will send an API request to haveibeenpwned to get all (if any) pwns of the password handle_response - depending on the response we will either get the body, or the reason for failure returned find_pwns - we will take the response body, and because haveibeenpwned uses a k-Anonymity model we will need to find the actual match ourselves (if present) return_result - will return the tuple which will contain a result atom and a pwns count  Let’s take a step by step approach and implement these functions.\nManipulating the password Let’s start easy. In sanitize, we want to trim leading and trailing whitespaces, while in hash we want to turn the password to SHA1 and return it’s first five characters.\n1  def sanitize(password), do: String.trim(password)   There isn’t much to explain here really. Instead of using sanitize we can use String.trim/1, but I prefer to have a separate function that we could extend and test for any edge cases.\n1 2 3 4  defp hash(password) do :crypto.hash(:sha, password) | Base.encode16 end   :crypto is an Erlang module that provides a set of cryptographic functions. Interestingly, it’s not part of the standard library, but it comes included in the distribution. One of the functions, as you can see in the code above, is hash/2, which takes the hashing algorithm as the first argument and the actual string to be hashed as the second argument. It returns the binary hash, that we can convert to hex by using Base.encode16.\nSending request to an API I bet you’re thinking HTTPoison. Aren’t you? While I was writing this article I was also wondering do we have to include to a whole package just to do a simple GET request. You guessed it - we do not.\nAlthough Elixir does not ship an HTTP client, Erlang does. And just like with :crypto, you can use Erlang’s HTTP client from Elixir using :httpc. This module provides the API to an HTTP/1.1 compatible client. I suggest giving it’s documentation a quick scan before we move on.\nLet’s let’s open up IEx and give :httpc a spin:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  iex(1) :httpc.request('https://api.pwnedpasswords.com/range/21FCB') {:ok, \\{\\{'HTTP/1.1', 200, 'OK'}, [ {'cache-control', 'public, max-age=2678400'}, {'connection', 'keep-alive'}, {'date', 'Sat, 22 Dec 2018 11:09:46 GMT'}, {'server', 'cloudflare'}, {'vary', 'Accept-Encoding'}, {'content-length', '19951'}, {'content-type', 'text/plain'}, {'expires', 'Tue, 22 Jan 2019 11:09:46 GMT'}, {'last-modified', 'Thu, 12 Jul 2018 01:32:06 GMT'}, {'set-cookie', '__cfduid=d51115381191fd7bd0a003d466916efc41545476986; expires=Sun, 22-Dec-19 11:09:46 GMT; path=/; domain=.pwnedpasswords.com; HttpOnly; Secure'}, {'cf-cache-status', 'HIT'}, {'access-control-allow-origin', '*'}, {'arr-disable-session-affinity', 'True'}, {'cf-ray', '48d2235cbe93bf5c-AMS'}, {'expect-ct', 'max-age=604800, report-uri=\"https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct\"'}, {'strict-transport-security', 'max-age=31536000; includeSubDomains; preload'}, {'x-content-type-options', 'nosniff'}, {'x-powered-by', 'ASP.NET'} ], 'THEBODYISHERE\\r\\nOMGSOMUCHSTUFFHEREWHATISTHISEVEN' ++ ...}}   You see, although the output is pretty verbose if you have ever sent an HTTP request via cURL or you’ve opened your browser’s debugging tools, there shouldn’t be any surprises here. The request/1 function will send a request to the pwnedpasswords API and it will return a ton of nested tuples, most of them being the response headers and the raw body of the response.\nFor our purpose, we can keep it simple. We are only interested if the function will return :ok atom as the first item in the tuple, or :error. We can use pattern matching to do this:\n1 2  iex(1) {:ok, {_status, _headers, body }} = :httpc.request('https://api.pwnedpasswords.com/range/21FCB')   So, lets get back to our Pwnex.fetch_pwns/1 function. The function will receive the first 5 characters of the hashed password, it will send that to the API and will return the body of the response:\n1 2 3  def fetch_pwns(head) do :httpc.request('https://api.pwnedpasswords.com/range/#{head}') end   Handling the response The handle_response will actually be one function with three bodies:\n1 2 3  def handle_response({:ok, {_status, _headers, body}}), do: body def handle_response({:error, {reason, _meta}}), do: reason def handle_response(_), do: nil   By using pattern matching we can have three types of function bodies. The first one will be invoked when the response status is HTTP 200 OK, the second one when there’s an error and the third one for any other case.\nAs you can imagine, we could have used conditional logic here, but having the power of pattern matching allows us to have three tiny functions that are very easy to read, understand and test.\nParsing the response Here’s the body of the response:\n1  003D68EB55068C33ACE09247EE4C639306B:3\\r\\n012C192B2F16F82EA0EB9EF18D9D539B0DD:1\\r\\n01330C689E5D64F660D6947A93AD634EF8F:1\\r\\n0198748F3315F40B1A102BF18EEA0194CD9:1\\r\\n01F9033B3C00C65DBFD6D1DC4D22918F5E9:2\\r\\n0424DB98C7A0846D2C6C75E697092A0CC3E:5\\r\\n047F229A81EE2747253F9897DA38946E241:1\\r\\n04A37A676E312CC7C4D236C93FBD992AA3C:5\\r\\n04AE045B134BDC43043B216AEF66100EE00:2\\r\\n0502EA98ED7A1000D932B10F7707D37FFB4:5\\r\\n0539F86F519AACC7030B728CD47803E5B22:5\\r\\n054A0BD53E2BC83A87EFDC236E2D0498C08:3\\r\\n05AA835DC9423327DAEC1CBD38FA99B8834:1\\r\\n05E0182DEAE22D02F6ED35280BCAC370179:4   If you look carefully you’ll notice that it’s actually a list of partial SHA-1 hashes separated by \\r\\n. With a closer inspection of the first one:\n1  003D68EB55068C33ACE09247EE4C639306B:3   you notice that it’s actually a part of the hash, a colon : and a number (3 in the example above). This is actually the hash without it’s first 5 characters and the number of times that particular password has been pwned.\nThis means that the password who’s SHA-1 hash is 5BAA6003D68EB55068C33ACE09247EE4C639306B has been pwned 3 times, according to haveibeenpwned.com.\nWhat we need to with this response body is to split it, to convert it to a list which we will iterate and find our matching hash in. Let’s do that:\n1 2 3 4 5 6  def find_pwns(response, hash_tail) do response | to_string | String.split() | Enum.find(\u0026(String.starts_with?(\u00261, hash_tail))) end   Although find_pwns/2 might look a bit loaded, let me assure you it’s not. Let’s see what each of the lines do here:\n to_string will convert the character list we receive from fetch_pwns and will convert it to a string so we can parse it in the next steps String.split will split the string on the \\r\\n characters and will create a list of strings, looking like: [\"003D68EB55068C33ACE09247EE4C639306B:3\", ...] We will invoke Enum.find which takes the list and a function as arguments. The list is the parsed list of hash tails and their pwns count, while the function is String.starts_with?/2, which will return true when a line starts with the value of hash_tail.  That’s all. At the end, the find_pwns/2 function will return either the line that contains the matched hash tail or it will return nil.\nReturning a meaningful result Now that we have found the count of pwns for the hash (or just a nil), we need to handle that and return a meaningful tuple to the user of the module.\nWhen the find_pwns function does find a count, we want to return a tuple like {:pwned, count}. Otherwise, when find_pwns does not find a count it will return nil, which we handle in the second definition of the return_result function:\n1 2 3 4 5 6  def return_result(line) when is_binary(line) do [_, count] = String.split(line, \":\") {:pwned, count} end def return_result(_), do: {:ok, 0}   In the first function body we will take the line, which should be a binary (string), split it at the : character and then return the tuple with the count. In the second function body we take any argument (which in our case is nil) and return a tuple with 0 as the count.\nUsing Pwnex Now, let’s load Pwnex in IEx and give it a spin. To load it in IEx, you need to open the root of the module and run iex -S mix. This will open a IEx session and execute mix in it, which will in fact, load and compile the module and make it available for invocation directly from IEx:\n1 2 3 4 5 6 7 8 9 10 11 12 13  › iex -S mix Erlang/OTP 21 [erts-10.2] [source] [64-bit] [smp:4:4] [ds:4:4:10] [async-threads:1] [hipe] [dtrace] Interactive Elixir (1.7.4) - press Ctrl+C to exit (type h() ENTER for help) iex(1) h Pwnex Pwnex Consults haveibeenpwned.com's API for pwned passwords. iex(2) Pwnex.pwned?(\"password\") {:pwned, 3533661} iex(3) Pwnex.pwned?(\"123!@#asd*\u0026(*123SAkjhda\") {:ok, 0}   As you can see, password has been pwned about 3.5 million times, while 123!@#asd*\u0026(*123SAkjhda never.\nThat’s basically it. We have Pwnex working - it takes our input as a function argument, talks to an API through an Erlang HTTP client, parses its response body, builds a map of hashes and finds any pwns for the given password.\nAs you can see, this whole package does quite a bit in 65 lines of code.\nIn this article, we saw how we can create a new package, use it to communicate with an API over HTTP, we learned why you don’t always need HTTPoison, how you can parse a request body and how you can mingle with some data.\nIf you would like to see the actual code that we wrote in this article, head over to its repo on Github.\nLiked this article? You can buy me a coffee. Or simply subscribe to my newsletter and get my fresh posts in your inbox. It's short and sweet, going out monthly to over 1,000 subscribers.  ","wordCount":"2381","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Ilija"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ieftimov.com/post/haveibeenpwned-password-lookup-elixir/"},"publisher":{"@type":"Organization","name":"Ilija Eftimov ⚡️","logo":{"@type":"ImageObject","url":"https://ieftimov.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://ieftimov.com/ accesskey=h title="Ilija Eftimov ⚡️ (Alt + H)">Ilija Eftimov ⚡️</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://ieftimov.com/posts title=Archive><span>Archive</span></a></li><li><a href=https://ieftimov.com/about title=About><span>About</span></a></li><li><a href=https://ieftimov.com/newsletter title=Newsletter><span>Newsletter</span></a></li><li><a href=https://forms.gle/orfXK5jh1LRaiFzo8 title="Suggest a topic"><span>Suggest a topic</span></a></li><li><a href=https://www.buymeacoffee.com/ieftimov title="Buy me a ☕"><span>Buy me a ☕</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Validate your passwords using Elixir and haveibeenpwned.com's API</h1><div class=post-meta>December 23, 2018&nbsp;·&nbsp;12 min&nbsp;·&nbsp;Ilija</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#reader-meet-haveibeenpwnedcom aria-label="Reader, meet haveibeenpwned.com">Reader, meet haveibeenpwned.com</a></li><li><a href=#using-the-pwned-passwords-api aria-label="Using the pwned passwords API">Using the pwned passwords API</a></li><li><a href=#pinging-the-api aria-label="Pinging the API">Pinging the API</a></li><li><a href=#our-little-algorithm aria-label="Our little algorithm">Our little algorithm</a></li><li><a href=#manipulating-the-password aria-label="Manipulating the password">Manipulating the password</a></li><li><a href=#sending-request-to-an-api aria-label="Sending request to an API">Sending request to an API</a></li><li><a href=#handling-the-response aria-label="Handling the response">Handling the response</a></li><li><a href=#parsing-the-response aria-label="Parsing the response">Parsing the response</a></li><li><a href=#returning-a-meaningful-result aria-label="Returning a meaningful result">Returning a meaningful result</a></li><li><a href=#using-pwnex aria-label="Using Pwnex">Using Pwnex</a></li></ul></div></details></div><div class=post-content><p>Unless you&rsquo;ve been living under a rock for the last couple of years, you
probably know what two-factor authentication (2FA) is. It&rsquo;s quite a neat trick
actually - you have a password that you have to (obviously) enter correctly
(first factor), but you also have to receive a second (random) code through a
different medium, sometimes on a different device, that you have to enter to
log in (second factor).</p><p>Now, obviously this adds quite a bit of overhead to logging in, but it adds a
disproportionate value when it comes to security. If you work in any sort of
organisation it was probably no surprise when you were asked to turn on 2FA for
all your accounts. If you haven&rsquo;t been asked to (or haven&rsquo;t done it), it&rsquo;s time
to act ;)</p><p>But, what about factor No. 1? The password. Did we give up on them?</p><p>Not really. But, for sure we had to become more vigilant and smarter when
setting our passwords. Why? Allow me to explain.</p><h2 id=reader-meet-haveibeenpwnedcom>Reader, meet haveibeenpwned.com<a hidden class=anchor aria-hidden=true href=#reader-meet-haveibeenpwnedcom>#</a></h2><p>Let me introduce you to <a href=https://haveibeenpwned.com>haveibeenpwned.com</a>. It&rsquo;s
a free resource for anyone to quickly assess if they may have been put at risk
due to an online account of their&rsquo;s having been compromised or &ldquo;pwned&rdquo; in a
data breach. As you can imagine, to fulfil its purpose, this service also
contains quite a long list of pwned passwords (about 500 million of them to be
more precise), which are open for querying through a REST API.</p><p>If you want to learn more about the project, or it&rsquo;s
<a href=https://www.troyhunt.com/>author</a>, I suggest checking
out the <a href=https://haveibeenpwned.com/About>About</a> page of the project.</p><h2 id=using-the-pwned-passwords-api>Using the pwned passwords API<a hidden class=anchor aria-hidden=true href=#using-the-pwned-passwords-api>#</a></h2><p>This API allows us to check if any password is present in haveibeenpwned
database. This means that if you send an already pwned password it will tell
you that this password has been pwned and that it&rsquo;s suggested to choose another
one.</p><p>Imagine you have a website where people can set their passwords, and once the
user finished typing their new password you can ping this service and check if
the password they chose has been pwned before.</p><p>Now, if you are thinking along the lines of &ldquo;are you telling me to send a
plain-text password across the wire to some random API?&rdquo; then you&rsquo;re a step
ahead, well done!</p><p>Sorry to disappoint, but no, actually I am not saying that. Instead of sending
the whole password in plain-text, this API only requires the 5 characters of
the SHA-1 hash of the actual password.</p><p>In Elixir terms, that would look like:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=color:#00afaf>:crypto</span>.hash(<span style=color:#00afaf>:sha</span>, <span style=color:#00afaf>&#34;password&#34;</span>)
|&gt; <span style=color:#0087ff>Base</span>.encode16
|&gt; <span style=color:#0087ff>String</span>.slice(<span style=color:#00afaf>0</span>..<span style=color:#00afaf>4</span>)</code></pre></td></tr></table></div></div><p>Interestingly what it sends back is <em>the remainder of the hashed passwords</em>
that match the 5 characters that you sent. Basically, this means if we take a
SHA-1 of &ldquo;password&rdquo;:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir>iex(<span style=color:#00afaf>1</span>)&gt; <span style=color:#00afaf>:crypto</span>.hash(<span style=color:#00afaf>:sha</span>, <span style=color:#00afaf>&#34;password&#34;</span>) |&gt; <span style=color:#0087ff>Base</span>.encode16
<span style=color:#00afaf>&#34;5BAA61E4C9B93F3F0682250B6CF8331B7EE68FD8&#34;</span></code></pre></td></tr></table></div></div><p>We will send only <code>5BAA6</code> to the API, while in the response body we will
receive a big list of strings that will represent the rest of the SHA-1, or in
our example that would be <code>1E4C9B93F3F0682250B6CF8331B7EE68FD8</code>.</p><p>Troy Hunt, who&rsquo;s the author of haveibeenpwned has written quite an extensive
explanation on how this works - you can read it
<a href=https://www.troyhunt.com/ive-just-launched-pwned-passwords-version-2/>here</a>.</p><h2 id=pinging-the-api>Pinging the API<a hidden class=anchor aria-hidden=true href=#pinging-the-api>#</a></h2><p>For the purpose of this exercise, we will create a small Mix package that will
encapsulate all of the behaviours. If you&rsquo;re not familiar with how to create
new packages using Mix, I suggest reading my article <a href=/writing-elixir-library>Write and publish your
first Elixir library</a>.</p><p>We will call our package <code>Pwnex</code> because somehow my brain always thinks that I
have to mix up the main word (pwned) with Elixir to come up with a name.
Anyway, let&rsquo;s create it:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>› mix new pwnex
* creating README.md
* creating .formatter.exs
* creating .gitignore
* creating mix.exs
* creating config
* creating config/config.exs
* creating lib
* creating lib/pwnex.ex
* creating <span style=color:#0087ff>test</span>
* creating test/test_helper.exs
* creating test/pwnex_test.exs

Your Mix project was created successfully.
You can use <span style=color:#00afaf>&#34;mix&#34;</span> to compile it, <span style=color:#0087ff>test</span> it, and more:

    <span style=color:#0087ff>cd</span> pwnex
    mix <span style=color:#0087ff>test</span>

Run <span style=color:#00afaf>&#34;mix help&#34;</span> <span style=color:#5f8700>for</span> more commands.</code></pre></td></tr></table></div></div><p>Now that we have the package bootstrapped locally, let&rsquo;s open <code>lib/pwnex.ex</code> and
add some documentation:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=color:#0087ff>defmodule</span> <span style=color:#0087ff>Pwnex</span> <span style=color:#5f8700>do</span>
  @moduledoc <span style=color:#00afaf>&#34;&#34;&#34;
</span><span style=color:#00afaf>  Consults haveibeenpwned.com&#39;s API for pwned passwords.
</span><span style=color:#00afaf>  &#34;&#34;&#34;</span>

  @doc <span style=color:#00afaf>&#34;&#34;&#34;
</span><span style=color:#00afaf>  Checks if a given password is already pwned.
</span><span style=color:#00afaf>
</span><span style=color:#00afaf>  </span>##<span style=color:#00afaf> Examples
</span><span style=color:#00afaf>
</span><span style=color:#00afaf>      iex&gt; Pwnex.pwned?(&#34;password&#34;)
</span><span style=color:#00afaf>      {:pwned, 3_000_000}
</span><span style=color:#00afaf>
</span><span style=color:#00afaf>      iex&gt; Pwnex.pwned?(&#34;m4Z2fJJ]r3fxQ*o27&#34;)
</span><span style=color:#00afaf>      {:ok, 0}
</span><span style=color:#00afaf>
</span><span style=color:#00afaf>  &#34;&#34;&#34;</span>
  <span style=color:#0087ff>def</span> pwned?(password) <span style=color:#5f8700>do</span>
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>The <code>moduledoc</code> briefly explains the purpose of the package, while the <code>doc</code>
explains the purpose of the <code>pwned?/1</code> function and has two examples that we
could use in the doctests.</p><h2 id=our-little-algorithm>Our little algorithm<a hidden class=anchor aria-hidden=true href=#our-little-algorithm>#</a></h2><p>Let&rsquo;s see what would be the steps to implement the <code>Pwnex.pwned?/1</code> function:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=color:#0087ff>def</span> pwned?(password) <span style=color:#5f8700>do</span>
  {hash_head, hash_tail} =
    password
    |&gt; sanitize
    |&gt; hash
    |&gt; split_password

  hash_head
    |&gt; fetch_pwns
    |&gt; handle_response
    |&gt; find_pwns(hash_tail)
    |&gt; return_result
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>Once more - the pipeline operator in Elixir makes this function so clear and
procedure-like that explaining feels a tad redundant. Still, here it is:</p><ul><li><code>sanitize</code> - we want to remove all leading and trailing whitespaces from the
password</li><li><code>hash</code> - we want to convert the password to a SHA1 hash and return it&rsquo;s first
5 characters</li><li><code>split_password</code> - we want to split the head - first 5 characters that we
will send to the API and the tail - the rest of the SHA-1 hash</li><li><code>fetch_pwns</code> - we will send an API request to haveibeenpwned to get all (if
any) pwns of the password</li><li><code>handle_response</code> - depending on the response we will either get the body, or
the reason for failure returned</li><li><code>find_pwns</code> - we will take the response body, and because haveibeenpwned uses
a k-Anonymity model we will need to find the actual match ourselves (if
present)</li><li><code>return_result</code> - will return the tuple which will contain a result atom and
a pwns count</li></ul><p>Let&rsquo;s take a step by step approach and implement these functions.</p><h2 id=manipulating-the-password>Manipulating the password<a hidden class=anchor aria-hidden=true href=#manipulating-the-password>#</a></h2><p>Let&rsquo;s start easy. In sanitize, we want to trim leading and trailing
whitespaces, while in <code>hash</code> we want to turn the password to SHA1 and return
it&rsquo;s first five characters.</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=color:#0087ff>def</span> sanitize(password), <span style=color:#00afaf>do</span>: <span style=color:#0087ff>String</span>.trim(password)</code></pre></td></tr></table></div></div><p>There isn&rsquo;t much to explain here really. Instead of using <code>sanitize</code> we can use
<code>String.trim/1</code>, but I prefer to have a separate function that we could extend
and test for any edge cases.</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=color:#0087ff>defp</span> hash(password) <span style=color:#5f8700>do</span>
  <span style=color:#00afaf>:crypto</span>.hash(<span style=color:#00afaf>:sha</span>, password)
  |&gt; <span style=color:#0087ff>Base</span>.encode16
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p><code>:crypto</code> is an <a href=http://erlang.org/doc/man/crypto.html>Erlang module</a> that
provides a set of cryptographic functions. Interestingly, it&rsquo;s not part of the
standard library, but it comes included in the distribution. One of the
functions, as you can see in the code above, is <code>hash/2</code>, which takes the
hashing algorithm as the first argument and the actual string to be hashed as
the second argument. It returns the binary hash, that we can convert to hex by
using <code>Base.encode16</code>.</p><h2 id=sending-request-to-an-api>Sending request to an API<a hidden class=anchor aria-hidden=true href=#sending-request-to-an-api>#</a></h2><p>I bet you&rsquo;re thinking <a href=https://hex.pm/packages/httpoison>HTTPoison</a>. Aren&rsquo;t
you? While I was writing this article I was also wondering do we have to
include to a whole package just to do a simple GET request. You guessed it - we
do not.</p><p>Although Elixir does not ship an HTTP client, Erlang does. And just like with
<code>:crypto</code>, you can use Erlang&rsquo;s HTTP client from Elixir using <code>:httpc</code>. This
module provides the API to an HTTP/1.1 compatible client. I suggest giving
<a href=http://erlang.org/doc/man/httpc.html>it&rsquo;s documentation</a> a quick scan before
we move on.</p><p>Let&rsquo;s let&rsquo;s open up IEx and give <code>:httpc</code> a spin:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">27
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir>iex(<span style=color:#00afaf>1</span>)&gt; <span style=color:#00afaf>:httpc</span>.request(<span style=color:#00afaf>&#39;https://api.pwnedpasswords.com/range/21FCB&#39;</span>)
{<span style=color:#00afaf>:ok</span>,
 \{\{<span style=color:#00afaf>&#39;HTTP/1.1&#39;</span>, <span style=color:#00afaf>200</span>, <span style=color:#00afaf>&#39;OK&#39;</span>},
  [
    {<span style=color:#00afaf>&#39;cache-control&#39;</span>, <span style=color:#00afaf>&#39;public, max-age=2678400&#39;</span>},
    {<span style=color:#00afaf>&#39;connection&#39;</span>, <span style=color:#00afaf>&#39;keep-alive&#39;</span>},
    {<span style=color:#00afaf>&#39;date&#39;</span>, <span style=color:#00afaf>&#39;Sat, 22 Dec 2018 11:09:46 GMT&#39;</span>},
    {<span style=color:#00afaf>&#39;server&#39;</span>, <span style=color:#00afaf>&#39;cloudflare&#39;</span>},
    {<span style=color:#00afaf>&#39;vary&#39;</span>, <span style=color:#00afaf>&#39;Accept-Encoding&#39;</span>},
    {<span style=color:#00afaf>&#39;content-length&#39;</span>, <span style=color:#00afaf>&#39;19951&#39;</span>},
    {<span style=color:#00afaf>&#39;content-type&#39;</span>, <span style=color:#00afaf>&#39;text/plain&#39;</span>},
    {<span style=color:#00afaf>&#39;expires&#39;</span>, <span style=color:#00afaf>&#39;Tue, 22 Jan 2019 11:09:46 GMT&#39;</span>},
    {<span style=color:#00afaf>&#39;last-modified&#39;</span>, <span style=color:#00afaf>&#39;Thu, 12 Jul 2018 01:32:06 GMT&#39;</span>},
    {<span style=color:#00afaf>&#39;set-cookie&#39;</span>,
     <span style=color:#00afaf>&#39;__cfduid=d51115381191fd7bd0a003d466916efc41545476986; expires=Sun, 22-Dec-19 11:09:46 GMT; path=/; domain=.pwnedpasswords.com; HttpOnly; Secure&#39;</span>},
    {<span style=color:#00afaf>&#39;cf-cache-status&#39;</span>, <span style=color:#00afaf>&#39;HIT&#39;</span>},
    {<span style=color:#00afaf>&#39;access-control-allow-origin&#39;</span>, <span style=color:#00afaf>&#39;*&#39;</span>},
    {<span style=color:#00afaf>&#39;arr-disable-session-affinity&#39;</span>, <span style=color:#00afaf>&#39;True&#39;</span>},
    {<span style=color:#00afaf>&#39;cf-ray&#39;</span>, <span style=color:#00afaf>&#39;48d2235cbe93bf5c-AMS&#39;</span>},
    {<span style=color:#00afaf>&#39;expect-ct&#39;</span>,
     <span style=color:#00afaf>&#39;max-age=604800, report-uri=&#34;https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct&#34;&#39;</span>},
    {<span style=color:#00afaf>&#39;strict-transport-security&#39;</span>,
     <span style=color:#00afaf>&#39;max-age=31536000; includeSubDomains; preload&#39;</span>},
    {<span style=color:#00afaf>&#39;x-content-type-options&#39;</span>, <span style=color:#00afaf>&#39;nosniff&#39;</span>},
    {<span style=color:#00afaf>&#39;x-powered-by&#39;</span>, <span style=color:#00afaf>&#39;ASP.NET&#39;</span>}
  ],
  <span style=color:#00afaf>&#39;THEBODYISHERE</span><span style=color:#af0000>\r\n</span><span style=color:#00afaf>OMGSOMUCHSTUFFHEREWHATISTHISEVEN&#39;</span> ++ ...}}</code></pre></td></tr></table></div></div><p>You see, although the output is pretty verbose if you have ever sent an HTTP
request via cURL or you&rsquo;ve opened your browser&rsquo;s debugging tools, there
shouldn&rsquo;t be any surprises here. The <code>request/1</code> function will send a request
to the pwnedpasswords API and it will return a ton of nested tuples, most of
them being the response headers and the raw body of the response.</p><p>For our purpose, we can keep it simple. We are only interested if the function
will return <code>:ok</code> atom as the first item in the tuple, or <code>:error</code>. We can use
pattern matching to do this:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir>iex(<span style=color:#00afaf>1</span>)&gt; {<span style=color:#00afaf>:ok</span>, {_status, _headers, body }} =
  <span style=color:#00afaf>:httpc</span>.request(<span style=color:#00afaf>&#39;https://api.pwnedpasswords.com/range/21FCB&#39;</span>)</code></pre></td></tr></table></div></div><p>So, lets get back to our <code>Pwnex.fetch_pwns/1</code> function. The function will
receive the first 5 characters of the hashed password, it will send that to the
API and will return the <code>body</code> of the response:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=color:#0087ff>def</span> fetch_pwns(head) <span style=color:#5f8700>do</span>
  <span style=color:#00afaf>:httpc</span>.request(<span style=color:#00afaf>&#39;https://api.pwnedpasswords.com/range/</span><span style=color:#00afaf>#{</span>head<span style=color:#00afaf>}</span><span style=color:#00afaf>&#39;</span>)
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><h2 id=handling-the-response>Handling the response<a hidden class=anchor aria-hidden=true href=#handling-the-response>#</a></h2><p>The <code>handle_response</code> will actually be one function with three bodies:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir>  <span style=color:#0087ff>def</span> handle_response({<span style=color:#00afaf>:ok</span>, {_status, _headers, body}}), <span style=color:#00afaf>do</span>: body
  <span style=color:#0087ff>def</span> handle_response({<span style=color:#00afaf>:error</span>, {reason, _meta}}), <span style=color:#00afaf>do</span>: reason
  <span style=color:#0087ff>def</span> handle_response(_), <span style=color:#00afaf>do</span>: <span style=color:#d75f00>nil</span></code></pre></td></tr></table></div></div><p>By using pattern matching we can have three types of function bodies. The first
one will be invoked when the response status is HTTP 200 OK, the second one
when there&rsquo;s an error and the third one for any other case.</p><p>As you can imagine, we could have used conditional logic here, but having the
power of pattern matching allows us to have three tiny functions that are very
easy to read, understand and test.</p><h2 id=parsing-the-response>Parsing the response<a hidden class=anchor aria-hidden=true href=#parsing-the-response>#</a></h2><p>Here&rsquo;s the body of the response:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>003D68EB55068C33ACE09247EE4C639306B:3\r\n012C192B2F16F82EA0EB9EF18D9D539B0DD:1\r\n01330C689E5D64F660D6947A93AD634EF8F:1\r\n0198748F3315F40B1A102BF18EEA0194CD9:1\r\n01F9033B3C00C65DBFD6D1DC4D22918F5E9:2\r\n0424DB98C7A0846D2C6C75E697092A0CC3E:5\r\n047F229A81EE2747253F9897DA38946E241:1\r\n04A37A676E312CC7C4D236C93FBD992AA3C:5\r\n04AE045B134BDC43043B216AEF66100EE00:2\r\n0502EA98ED7A1000D932B10F7707D37FFB4:5\r\n0539F86F519AACC7030B728CD47803E5B22:5\r\n054A0BD53E2BC83A87EFDC236E2D0498C08:3\r\n05AA835DC9423327DAEC1CBD38FA99B8834:1\r\n05E0182DEAE22D02F6ED35280BCAC370179:4</code></pre></td></tr></table></div></div><p>If you look carefully you&rsquo;ll notice that it&rsquo;s actually a list of partial SHA-1
hashes separated by <code>\r\n</code>. With a closer inspection of the first one:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>003D68EB55068C33ACE09247EE4C639306B:3</code></pre></td></tr></table></div></div><p>you notice that it&rsquo;s actually a part of the hash, a colon <code>:</code> and a number (<code>3</code>
in the example above). This is actually the hash without it&rsquo;s first 5
characters and the number of times that particular password has been pwned.</p><p>This means that the password who&rsquo;s SHA-1 hash is
<code>5BAA6003D68EB55068C33ACE09247EE4C639306B</code> has been pwned 3 times, according to
haveibeenpwned.com.</p><p>What we need to with this response body is to split it, to convert it to a list
which we will iterate and find our matching hash in. Let&rsquo;s do that:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=color:#0087ff>def</span> find_pwns(response, hash_tail) <span style=color:#5f8700>do</span>
  response
  |&gt; to_string
  |&gt; <span style=color:#0087ff>String</span>.split()
  |&gt; <span style=color:#0087ff>Enum</span>.find(&amp;(<span style=color:#0087ff>String</span>.starts_with?(<span style=color:#d75f00>&amp;1</span>, hash_tail)))
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>Although <code>find_pwns/2</code> might look a bit loaded, let me assure you it&rsquo;s not.
Let&rsquo;s see what each of the lines do here:</p><ol><li><code>to_string</code> will convert the character list we receive from <code>fetch_pwns</code> and
will convert it to a string so we can parse it in the next steps</li><li><code>String.split</code> will split the string on the <code>\r\n</code> characters and will
create a list of strings, looking like:
<code>["003D68EB55068C33ACE09247EE4C639306B:3", ...]</code></li><li>We will invoke <code>Enum.find</code> which takes the list and a function as arguments.
The list is the parsed list of hash tails and their pwns count, while the
function is <code>String.starts_with?/2</code>, which will return <code>true</code> when a line
starts with the value of <code>hash_tail</code>.</li></ol><p>That&rsquo;s all. At the end, the <code>find_pwns/2</code> function will return either the line
that contains the matched hash tail or it will return <code>nil</code>.</p><h2 id=returning-a-meaningful-result>Returning a meaningful result<a hidden class=anchor aria-hidden=true href=#returning-a-meaningful-result>#</a></h2><p>Now that we have found the count of pwns for the hash (or just a <code>nil</code>), we
need to handle that and return a meaningful tuple to the user of the module.</p><p>When the <code>find_pwns</code> function does find a count, we want to return a tuple like
<code>{:pwned, count}</code>. Otherwise, when <code>find_pwns</code> does not find a count it will
return <code>nil</code>, which we handle in the second definition of the <code>return_result</code>
function:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=color:#0087ff>def</span> return_result(line) <span style=color:#5f8700>when</span> is_binary(line) <span style=color:#5f8700>do</span>
  [_, count] = <span style=color:#0087ff>String</span>.split(line, <span style=color:#00afaf>&#34;:&#34;</span>)
  {<span style=color:#00afaf>:pwned</span>, count}
<span style=color:#5f8700>end</span>

<span style=color:#0087ff>def</span> return_result(_), <span style=color:#00afaf>do</span>: {<span style=color:#00afaf>:ok</span>, <span style=color:#00afaf>0</span>}</code></pre></td></tr></table></div></div><p>In the first function body we will take the <code>line</code>, which should be a binary
(string), split it at the <code>:</code> character and then return the tuple with the
count. In the second function body we take any argument (which in our case is
<code>nil</code>) and return a tuple with <code>0</code> as the count.</p><h2 id=using-pwnex>Using Pwnex<a hidden class=anchor aria-hidden=true href=#using-pwnex>#</a></h2><p>Now, let&rsquo;s load Pwnex in IEx and give it a spin. To load it in IEx, you need to
open the root of the module and run <code>iex -S mix</code>. This will open a IEx session
and execute <code>mix</code> in it, which will in fact, load and compile the module and
make it available for invocation directly from IEx:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir>› iex -<span style=color:#0087ff>S</span> mix
<span style=color:#0087ff>Erlang</span>/<span style=color:#0087ff>OTP</span> <span style=color:#00afaf>21</span> [erts-<span style=color:#00afaf>10.2</span>] [source] [<span style=color:#00afaf>64</span>-bit] [smp:<span style=color:#00afaf>4</span>:<span style=color:#00afaf>4</span>] [ds:<span style=color:#00afaf>4</span>:<span style=color:#00afaf>4</span>:<span style=color:#00afaf>10</span>] [async-threads:<span style=color:#00afaf>1</span>] [hipe] [dtrace]

<span style=color:#0087ff>Interactive</span> <span style=color:#0087ff>Elixir</span> (<span style=color:#00afaf>1.7</span>.<span style=color:#00afaf>4</span>) - press <span style=color:#0087ff>Ctrl</span>+<span style=color:#0087ff>C</span> to exit (type h() <span style=color:#0087ff>ENTER</span> <span style=color:#5f8700>for</span> help)
iex(<span style=color:#00afaf>1</span>)&gt; h <span style=color:#0087ff>Pwnex</span>

                          <span style=color:#0087ff>Pwnex</span>

<span style=color:#0087ff>Consults</span> haveibeenpwned.com<span style=color:#00afaf>&#39;s API for pwned passwords.
</span><span style=color:#00afaf>iex(2)&gt; Pwnex.pwned?(&#34;password&#34;)
</span><span style=color:#00afaf>{:pwned, 3533661}
</span><span style=color:#00afaf>iex(3)&gt; Pwnex.pwned?(&#34;123!@</span>#<span style=color:#00afaf>asd*&amp;(*123SAkjhda&#34;)
</span><span style=color:#00afaf>{:ok, 0}</span></code></pre></td></tr></table></div></div><p>As you can see, <code>password</code> has been pwned about 3.5 million times, while
<code>123!@#asd*&(*123SAkjhda</code> never.</p><p>That&rsquo;s basically it. We have Pwnex working - it takes our input as a function
argument, talks to an API through an Erlang HTTP client, parses its response
body, builds a map of hashes and finds any pwns for the given password.</p><p>As you can see, this whole package does quite a bit in 65 lines of code.</p><p>In this article, we saw how we can create a new package, use it to communicate
with an API over HTTP, we learned why you don&rsquo;t always need HTTPoison, how you
can parse a request body and how you can mingle with some data.</p><p>If you would like to see the actual code that we wrote in this article, head
over to <a href=https://github.com/fteem/pwnex>its repo on Github</a>.</p><section class=subscribe><b>Liked this article?</b>
You can <a href=https://www.buymeacoffee.com/ieftimov>buy me a coffee</a>.
Or simply <a href=/newsletter>subscribe to my
newsletter</a> and get my fresh posts in your inbox. It's short and sweet,
going out monthly to over 1,000 subscribers.</section></div><footer class=post-footer><ul class=post-tags><li><a href=https://ieftimov.com/tags/haveibeenpwned/>haveibeenpwned</a></li><li><a href=https://ieftimov.com/tags/api/>api</a></li><li><a href=https://ieftimov.com/tags/passwords/>passwords</a></li></ul><nav class=paginav><a class=prev href=https://ieftimov.com/post/a-deeper-dive-in-elixir-plug/><span class=title>« Prev Page</span><br><span>A deeper dive in Elixir's Plug</span></a>
<a class=next href=https://ieftimov.com/post/golang-datastructures-stacks-queues/><span class=title>Next Page »</span><br><span>Data structures in Go: Stacks and queues</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Validate your passwords using Elixir and haveibeenpwned.com's API on twitter" href="https://twitter.com/intent/tweet/?text=Validate%20your%20passwords%20using%20Elixir%20and%20haveibeenpwned.com%27s%20API&url=https%3a%2f%2fieftimov.com%2fpost%2fhaveibeenpwned-password-lookup-elixir%2f&hashtags=haveibeenpwned%2capi%2cpasswords"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Validate your passwords using Elixir and haveibeenpwned.com's API on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fieftimov.com%2fpost%2fhaveibeenpwned-password-lookup-elixir%2f&title=Validate%20your%20passwords%20using%20Elixir%20and%20haveibeenpwned.com%27s%20API&summary=Validate%20your%20passwords%20using%20Elixir%20and%20haveibeenpwned.com%27s%20API&source=https%3a%2f%2fieftimov.com%2fpost%2fhaveibeenpwned-password-lookup-elixir%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Validate your passwords using Elixir and haveibeenpwned.com's API on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fieftimov.com%2fpost%2fhaveibeenpwned-password-lookup-elixir%2f&title=Validate%20your%20passwords%20using%20Elixir%20and%20haveibeenpwned.com%27s%20API"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Validate your passwords using Elixir and haveibeenpwned.com's API on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fieftimov.com%2fpost%2fhaveibeenpwned-password-lookup-elixir%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Validate your passwords using Elixir and haveibeenpwned.com's API on whatsapp" href="https://api.whatsapp.com/send?text=Validate%20your%20passwords%20using%20Elixir%20and%20haveibeenpwned.com%27s%20API%20-%20https%3a%2f%2fieftimov.com%2fpost%2fhaveibeenpwned-password-lookup-elixir%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Validate your passwords using Elixir and haveibeenpwned.com's API on telegram" href="https://telegram.me/share/url?text=Validate%20your%20passwords%20using%20Elixir%20and%20haveibeenpwned.com%27s%20API&url=https%3a%2f%2fieftimov.com%2fpost%2fhaveibeenpwned-password-lookup-elixir%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>Copyright 2021 © Ilija Eftimov</span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>