<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Create and manage MacOS LaunchAgents using Go - Ilija Eftimov</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Ilija Eftimov" />
  <meta name="description" content="If you have ever tried writing a daemon for MacOS you have met with launchd. For those that don&amp;rsquo;t have the experience, think of it as a framework for starting, stopping and managing daemons, applications, processes, and scripts. If you have any *nix experience the word daemon should not be too alien to you.
For those unfamiliar, a daemon is a program running in the background without requiring user input." />

  <meta name="keywords" content="Software, Programming, Computer Science, Products" />






<meta name="generator" content="Hugo 0.55.5" />


<link rel="canonical" href="https://ieftimov.com/post/create-manage-macos-launchd-agents-golang/" />



<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.ec807d8b802a40889537c26e014f733206312ea440d42e1f0dabed80918de1ac.css" integrity="sha256-7IB9i4AqQIiVN8JuAU9zMgYxLqRA1C4fDavtgJGN4aw=" media="screen" crossorigin="anonymous">




<link rel="stylesheet" href="/css/overrides.css">

<link rel="stylesheet" href="/css/subscribe.css">


<meta property="og:title" content="Create and manage MacOS LaunchAgents using Go" />
<meta property="og:description" content="If you have ever tried writing a daemon for MacOS you have met with launchd. For those that don&rsquo;t have the experience, think of it as a framework for starting, stopping and managing daemons, applications, processes, and scripts. If you have any *nix experience the word daemon should not be too alien to you.
For those unfamiliar, a daemon is a program running in the background without requiring user input." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ieftimov.com/post/create-manage-macos-launchd-agents-golang/" />

<meta property="og:image" content="https://ieftimov.com/cards/create-manage-macos-launchd-agents-golang.png" />
<meta property="article:published_time" content="2018-01-30T00:00:00&#43;00:00"/>


<meta itemprop="name" content="Create and manage MacOS LaunchAgents using Go">
<meta itemprop="description" content="If you have ever tried writing a daemon for MacOS you have met with launchd. For those that don&rsquo;t have the experience, think of it as a framework for starting, stopping and managing daemons, applications, processes, and scripts. If you have any *nix experience the word daemon should not be too alien to you.
For those unfamiliar, a daemon is a program running in the background without requiring user input.">



<meta itemprop="wordCount" content="3634">

  <meta itemprop="image" content="https://ieftimov.com/cards/create-manage-macos-launchd-agents-golang.png">



<meta itemprop="keywords" content="launchagent,launchd,launchctl,lpc,signals," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://ieftimov.com/cards/create-manage-macos-launchd-agents-golang.png"/>

<meta name="twitter:title" content="Create and manage MacOS LaunchAgents using Go"/>
<meta name="twitter:description" content="If you have ever tried writing a daemon for MacOS you have met with launchd. For those that don&rsquo;t have the experience, think of it as a framework for starting, stopping and managing daemons, applications, processes, and scripts. If you have any *nix experience the word daemon should not be too alien to you.
For those unfamiliar, a daemon is a program running in the background without requiring user input."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-11264459-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Ilija Eftimov</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://ieftimov.com/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://ieftimov.com/testing-in-go/">Testing in Go</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://ieftimov.com/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://ieftimov.com/about/">About</a>
          
        
      </li>
    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Ilija Eftimov
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://ieftimov.com/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://ieftimov.com/testing-in-go/">Testing in Go</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://ieftimov.com/post/">Archives</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://ieftimov.com/about/">About</a>
          

        

      </li>
    
    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Create and manage MacOS LaunchAgents using Go</h1>
      
      <div class="post-meta">
        <time datetime="2018-01-30" class="post-time">
          30-01-2018
        </time>
        <div class="post-category">
            <a href="https://ieftimov.com/categories/go/"> go </a>
            <a href="https://ieftimov.com/categories/launchd/"> launchd </a>
            
          </div>
        

        
        

        
        
      </div>
    </header>

    
    

    
    <div class="post-content">
      

<p>If you have ever tried writing a daemon for MacOS you have met with <code>launchd</code>. For
those that don&rsquo;t have the experience, think of it as a framework for starting,
stopping and managing daemons, applications, processes, and scripts. If you have
any *nix experience the word daemon should not be too alien to you.</p>

<p>For those unfamiliar, a daemon is a program running in the background without
requiring user input. A typical daemon might, for instance, perform daily
maintenance tasks or scan a device for malware when connected.</p>

<p>This post is aimed at folks that know a little bit about what daemons are, what
is the common way of using them and know a bit about Go. Also, if you have
ever written a daemon for any other *nix system, you will have a good idea of
what we are going to talk here. If you are an absolute beginner in Go or systems
this might prove to be an overwhelming article. Still, feel free to give it a
shot and let me know how it goes.</p>

<p>If you ever find yourself wanting to write a MacOS daemon with Go you would like
to know most of the stuff we are going to talk about in this article. Without
further ado, let&rsquo;s dive in.</p>

<h2 id="what-is-launchd-and-how-it-works">What is <code>launchd</code> and how it works?</h2>

<p><code>launchd</code> is a unified service-management framework, that starts, stops and manages
daemons, applications, processes, and scripts in MacOS.</p>

<p>One of its key features is that it differentiates between agents and daemons.
In <code>launchd</code> land, an agent runs on behalf of the logged in user while a daemon
runs on behalf of the root user or any specified user.</p>

<h3 id="defining-agents-and-daemons">Defining agents and daemons</h3>

<p>An agent/daemon is defined in an XML file, which states the properties of the
program that will execute, among a list of other properties. Another aspect to
keep in mind is that <code>launchd</code> decides if a program will be treated as a daemon
or an agent by where the program XML is located.</p>

<p>Over at <a href="https://launchd.info">launchd.info</a>, there&rsquo;s a simple table that shows where
you would (or not) place your program&rsquo;s XML:</p>

<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">+----------------+-------------------------------+----------------------------------------------------+
| Type           | Location                      | Run on behalf of                                   |
+----------------+-------------------------------+----------------------------------------------------+
| User Agents    | ~/Library/LaunchAgents        | Currently logged in user                           |
| Global Agents  | /Library/LaunchAgents         | Currently logged in user                           |
| Global Daemons | /Library/LaunchDaemons        | root or the user specified with the key &#39;UserName&#39; |
| System Agents  | /System/Library/LaunchAgents  | Currently logged in user                           |
| System Daemons | /System/Library/LaunchDaemons | root or the user specified with the key &#39;UserName&#39; |
+----------------+-------------------------------+----------------------------------------------------+</code></pre></div>

<p>This means that when we set our XML file in, for example, the <code>/Library/LaunchAgents</code>
path our process will be treated as a global agent. The main difference between the
daemons and agents is that LaunchDaemons will run as root, and are generally
background processes. On the other hand, LaunchAgents are jobs that will run as
a user or in the context of userland. These may be scripts or other foreground
items and they also have access to the MacOS UI (e.g. you can send notifications,
control the windows, etc.)</p>

<p>So, how do we define an agent? Let&rsquo;s take a look at a simple XML file that
<code>launchd</code> understands:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--- Example blatantly ripped off from http://www.launchd.info/ --&gt;</span>
<span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC &#34;-//Apple//DTD PLIST 1.0//EN&#34; &#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd&#34;&gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">&#34;1.0&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;dict&gt;</span>
		<span class="nt">&lt;key&gt;</span>Label<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;string&gt;</span>com.example.app<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;key&gt;</span>Program<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;string&gt;</span>/Users/Me/Scripts/cleanup.sh<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;key&gt;</span>RunAtLoad<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;true/&gt;</span>
	<span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span></code></pre></td></tr></table>
</div>
</div>

<p>The XML is quite self-explanatory, unless it&rsquo;s the first time you are seeing
an XML file. The file has three main properties, with values. In fact, if you
take a better look you will see the <code>dict</code> keyword which means <code>dictionary</code>. This
actually means that the XML represents a key-value structure, so in Go it would
look like:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">{</span>
        <span class="s">&#34;Label&#34;</span><span class="p">:</span>     <span class="s">&#34;com.example.app&#34;</span><span class="p">,</span>
        <span class="s">&#34;Program&#34;</span><span class="p">:</span>   <span class="s">&#34;/Users/Me/Scripts/cleanup.sh&#34;</span><span class="p">,</span>
        <span class="s">&#34;RunAtLoad&#34;</span><span class="p">:</span> <span class="s">&#34;true&#34;</span><span class="p">,</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>

<p>Letâ€™s look at each of the keys:</p>

<ol>
<li><code>Label</code> - The job definition or the name of the job. This is the
unique identifier for the job within the <code>launchd</code> instance. Usually, the label
(and hence the name) is written in
<a href="en.wikipedia.org/wiki/Reverse_domain_name_notation">Reverse domain name notation</a>.</li>
<li><code>Program</code> - This key defines what the job should start, in our case a script
with the path <code>/Users/Me/Scripts/cleanup.sh</code>.</li>
<li><code>RunAtLoad</code> - This key specifies when the job should be run, in this case
right after it&rsquo;s loaded.</li>
</ol>

<p>As you can see, the keys used in this XML file are quite self-explanatory. This
is the case for the remaining 30-40 keys that <code>launchd</code> supports. Last but not
least these files although have an XML syntax, in fact, they have a <code>.plist</code>
extension (which means <code>Property List</code>). Makes a lot of sense, right?</p>

<h2 id="launchd-v-s-launchctl"><code>launchd</code> v.s. <code>launchctl</code></h2>

<p>Before we continue with our little exercise of creating daemons/agents with
Go, let&rsquo;s first see how <code>launchd</code> allows us to control these jobs. While
<code>launchd</code>&rsquo;s job is to boot the system and to load and maintain services, there
is a different command used for jobs management - <code>launchctl</code>. With <code>launchd</code>
facilitating jobs, the control of services is centralized in the <code>launchctl</code>
command.</p>

<p><code>launchctl</code> has a long list of subcommands that we can use. For example, loading
or unloading a job is done via:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">launchctl unload/load ~/Library/LaunchAgents/com.example.app.plist</code></pre></td></tr></table>
</div>
</div>

<p>Or, starting/stopping a job is done via:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">launchctl start/stop ~/Library/LaunchAgents/com.example.app.plist</code></pre></td></tr></table>
</div>
</div>

<p>To get any confusion out of the way, <code>load</code> and <code>start</code> are different. While
<code>start</code> only starts the agent/daemon, <code>load</code> loads the job and it might also
start it if the job is configured to run on load. This is achieved by setting
the <code>RunAtLoad</code> property in the property list XML of the job:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--- Example blatantly ripped off from http://www.launchd.info/ --&gt;</span>
<span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC &#34;-//Apple//DTD PLIST 1.0//EN&#34; &#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd&#34;&gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">&#34;1.0&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;dict&gt;</span>
		<span class="nt">&lt;key&gt;</span>Label<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;string&gt;</span>com.example.app<span class="nt">&lt;/string&gt;</span>
		<span class="nt">&lt;key&gt;</span>Program<span class="nt">&lt;/key&gt;</span>
		<span class="nt">&lt;string&gt;</span>/Users/Me/Scripts/cleanup.sh<span class="nt">&lt;/string&gt;</span>

		<span class="nt">&lt;key&gt;</span>RunAtLoad<span class="nt">&lt;/key&gt;&lt;true/&gt;</span>

	<span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span></code></pre></td></tr></table>
</div>
</div>

<p>If you would like to see what other commands <code>launchctl</code> supports, you can run
<code>man launchctl</code> in your terminal and see the options in detail.</p>

<h2 id="automating-with-go">Automating with Go</h2>

<p>After getting the basics of <code>launchd</code> and <code>launctl</code> out of the way, why don&rsquo;t we
see how we can add an agent to any Go package? For our example, we are going to
write a simple way of plugging in a <code>launchd</code> agent for any of your Go packages.</p>

<p>As we already established before, <code>launchd</code> speaks in XML. Or, rather, it
understands XML files, called <em>property lists</em> (or <code>.plist</code>). This means, for
our Go package to have an agent running on MacOS, it will need to tell <code>launchd</code>
&ldquo;hey, <code>launchd</code>, run this thing!&ldquo;. And since <code>launch</code> speaks only in <code>.plist</code>,
that means our package needs to be capable of generating XML files.</p>

<h3 id="templates-in-go">Templates in Go</h3>

<p>While one could have a hardcoded <code>.plist</code> file in their project and copy it
across to the <code>~/Library/LaunchAgents</code> path, a more programmatical way
to do this would be to use a template to generate these XML files. The good thing
is Go&rsquo;s standard library has us covered - the <code>text/template</code> package
(<a href="https://godoc.org/text/template">docs</a>) does exactly what we need.</p>

<p>In a nutshell, <code>text/template</code> implements data-driven templates for generating
textual output. Or in other words, you give it a template and a data structure,
it will mash them up together and produce a nice and clean text file. Perfect.</p>

<p>Let&rsquo;s say the <code>.plist</code> we need to generate in our case is the following:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC \&#34;-//Apple Computer//DTD PLIST 1.0//EN\&#34; \&#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\&#34; &gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">&#39;1.0&#39;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dict&gt;</span>
    <span class="nt">&lt;key&gt;</span>Label<span class="nt">&lt;/key&gt;&lt;string&gt;</span>Ticker<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;key&gt;</span>Program<span class="nt">&lt;/key&gt;&lt;string&gt;</span>/usr/local/bin/ticker<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;key&gt;</span>StandardOutPath<span class="nt">&lt;/key&gt;&lt;string&gt;</span>/tmp/ticker.out.log<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;key&gt;</span>StandardErrorPath<span class="nt">&lt;/key&gt;&lt;string&gt;</span>/tmp/ticker.err.log<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;key&gt;</span>KeepAlive<span class="nt">&lt;/key&gt;&lt;true/&gt;</span>
    <span class="nt">&lt;key&gt;</span>RunAtLoad<span class="nt">&lt;/key&gt;&lt;true/&gt;</span>
  <span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span></code></pre></td></tr></table>
</div>
</div>

<p>We want to keep it quite simple in our little exercise. It will contain only
six properties: <code>Label</code>, <code>Program</code>, <code>StandardOutPath</code>, <code>StandardErrorPath</code>,
<code>KeepAlive</code> and <code>RunAtLoad</code>. To generate such a XML, its template would look
something like this:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC \&#34;-//Apple Computer//DTD PLIST 1.0//EN\&#34; \&#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\&#34; &gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">&#39;1.0&#39;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dict&gt;</span>
    <span class="nt">&lt;key&gt;</span>Label<span class="nt">&lt;/key&gt;&lt;string&gt;</span>{{.Label}}<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;key&gt;</span>Program<span class="nt">&lt;/key&gt;&lt;string&gt;</span>{{.Program}}<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;key&gt;</span>StandardOutPath<span class="nt">&lt;/key&gt;&lt;string&gt;</span>/tmp/{{.Label}}.out.log<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;key&gt;</span>StandardErrorPath<span class="nt">&lt;/key&gt;&lt;string&gt;</span>/tmp/{{.Label}}.err.log<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;key&gt;</span>KeepAlive<span class="nt">&lt;/key&gt;</span><span class="err">&lt;</span>{{.KeepAlive}}/&gt;
    <span class="nt">&lt;key&gt;</span>RunAtLoad<span class="nt">&lt;/key&gt;</span><span class="err">&lt;</span>{{.RunAtLoad}}/&gt;
  <span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span></code></pre></td></tr></table>
</div>
</div>

<p>As you can see, the difference between the two XMLs is that the second one has
the double curly braces with expressions in them in places where the first XML
has some sort of a value. These are called &ldquo;actions&rdquo;, which can be data
evaluations or control structures and are delimited by &ldquo;{{&rdquo; and &ldquo;}}&rdquo;. Any of the
text outside actions is copied to the output untouched.</p>

<h3 id="injecting-your-data">Injecting your data</h3>

<p>Now that we have our template with its glorious XML and curly braces
(or actions), let&rsquo;s see how we can inject our data into it. Since things are
generally simple in Go, especially when it comes to its standard library, you
should not worry - this will be easy!</p>

<p>To keep thing simple, we will store the whole XML template in a plain old string.
Yes, weird, I know. The best way would be to store it in a file and
read it from there, or embed it in the binary itself, but in our little example
let&rsquo;s keep it simple:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml">// template.go
package main

func Template() string {
	return `
<span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;</span>
 <span class="cp">&lt;!DOCTYPE plist PUBLIC \&#34;-//Apple Computer//DTD PLIST 1.0//EN\&#34; \&#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\&#34; &gt;</span>
 <span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">&#39;1.0&#39;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;dict&gt;</span>
     <span class="nt">&lt;key&gt;</span>Label<span class="nt">&lt;/key&gt;&lt;string&gt;</span>{{.Label}}<span class="nt">&lt;/string&gt;</span>
     <span class="nt">&lt;key&gt;</span>Program<span class="nt">&lt;/key&gt;&lt;string&gt;</span>{{.Program}}<span class="nt">&lt;/string&gt;</span>
     <span class="nt">&lt;key&gt;</span>StandardOutPath<span class="nt">&lt;/key&gt;&lt;string&gt;</span>/tmp/{{.Label}}.out.log<span class="nt">&lt;/string&gt;</span>
     <span class="nt">&lt;key&gt;</span>StandardErrorPath<span class="nt">&lt;/key&gt;&lt;string&gt;</span>/tmp/{{.Label}}.err.log<span class="nt">&lt;/string&gt;</span>
     <span class="nt">&lt;key&gt;</span>KeepAlive<span class="nt">&lt;/key&gt;</span><span class="err">&lt;</span>{{.KeepAlive}}/&gt;
     <span class="nt">&lt;key&gt;</span>RunAtLoad<span class="nt">&lt;/key&gt;</span><span class="err">&lt;</span>{{.RunAtLoad}}/&gt;
   <span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span>
`
}</code></pre></td></tr></table>
</div>
</div>

<p>And the program that will use our little template function:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// main.go
</span><span class="c1"></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;log&#34;</span>
	<span class="s">&#34;os&#34;</span>
	<span class="s">&#34;text/template&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">data</span> <span class="o">:=</span> <span class="kd">struct</span> <span class="p">{</span>
		<span class="nx">Label</span>     <span class="kt">string</span>
		<span class="nx">Program</span>   <span class="kt">string</span>
		<span class="nx">KeepAlive</span> <span class="kt">bool</span>
		<span class="nx">RunAtLoad</span> <span class="kt">bool</span>
	<span class="p">}{</span>
		<span class="nx">Label</span><span class="p">:</span>     <span class="s">&#34;ticker&#34;</span><span class="p">,</span>
		<span class="nx">Program</span><span class="p">:</span>   <span class="s">&#34;/usr/local/bin/ticker&#34;</span><span class="p">,</span>
		<span class="nx">KeepAlive</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
		<span class="nx">RunAtLoad</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
	<span class="p">}</span>
	<span class="nx">t</span> <span class="o">:=</span> <span class="nx">template</span><span class="p">.</span><span class="nf">Must</span><span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;launchdConfig&#34;</span><span class="p">).</span><span class="nf">Parse</span><span class="p">(</span><span class="nf">Template</span><span class="p">()))</span>
	<span class="nx">err</span> <span class="o">:=</span> <span class="nx">t</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="nx">os</span><span class="p">.</span><span class="nx">Stdout</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
		<span class="nx">log</span><span class="p">.</span><span class="nf">Fatalf</span><span class="p">(</span><span class="s">&#34;Template generation failed: %s&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>

<p>So, what happens there, in the <code>main</code> function? It&rsquo;s actually quite simple:</p>

<ol>
<li>We declare a small <code>struct</code>, which has only the properties that will be needed
in the template, and we immediately initialize it with the values for our program.</li>
<li>We build a new template, using the <code>template.New</code> function, with the name
<code>launchdConfig</code>. Then, we invoke the <code>Parse</code> function on it, which takes the
XML template as an argument.</li>
<li>We invoke the <code>template.Must</code> function, which takes our built template as
argument. From the documentation, <code>template.Must</code> is a helper that wraps a call
to a function returning <code>(*Template, error)</code> and panics if the error is non-<code>nil</code>.
Actually, <code>template.Must</code> is built to, in a way, validate if the template can be
understood by the <code>text/template</code> package.</li>
<li>Finally, we invoke <code>Execute</code> on our built template, which takes a data structure
and applies its attributes to the actions in the template. Then it sends the
output to <code>os.Stdout</code>, which does the trick for our example. Of course, the
output can be sent to any struct that implements the <code>io.Writer</code> interface, like
a file (<code>os.File</code>).</li>
</ol>

<h3 id="make-and-load-my-plist">Make and load my <code>.plist</code></h3>

<p>Instead of sending all this nice XML to standard out, let&rsquo;s throw in an open
file descriptor to the <code>Execute</code> function and finally save our <code>.plist</code> file in
<code>~/Library/LaunchAgents</code>. There are a couple of main points we need to change.</p>

<p>First, getting the location of the binary. Since it&rsquo;s a Go binary, and we will
install it via <code>go install</code>, we can assume that the path will be at <code>$GOPATH/bin</code>.
Second, since we don&rsquo;t know the actual <code>$HOME</code> of the current user, we will have
to get it through the environment. Both of these can be done via <code>os.Getenv</code>
(<a href="https://godoc.org/os#Getenv">docs</a>) which takes a variable name and returns
its value.</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// main.go
</span><span class="c1"></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;log&#34;</span>
	<span class="s">&#34;os&#34;</span>
	<span class="s">&#34;text/template&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">data</span> <span class="o">:=</span> <span class="kd">struct</span> <span class="p">{</span>
		<span class="nx">Label</span>     <span class="kt">string</span>
		<span class="nx">Program</span>   <span class="kt">string</span>
		<span class="nx">KeepAlive</span> <span class="kt">bool</span>
		<span class="nx">RunAtLoad</span> <span class="kt">bool</span>
	<span class="p">}{</span>
		<span class="nx">Label</span><span class="p">:</span>     <span class="s">&#34;com.ieftimov.ticker&#34;</span><span class="p">,</span> <span class="c1">// Reverse-DNS naming convention
</span><span class="c1"></span>		<span class="nx">Program</span><span class="p">:</span>   <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s/bin/ticker&#34;</span><span class="p">,</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Getenv</span><span class="p">(</span><span class="s">&#34;GOPATH&#34;</span><span class="p">)),</span>
		<span class="nx">KeepAlive</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
		<span class="nx">RunAtLoad</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
	<span class="p">}</span>

        <span class="nx">plistPath</span> <span class="o">:=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s/Library/LaunchAgents/%s.plist&#34;</span><span class="p">,</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Getenv</span><span class="p">(</span><span class="s">&#34;HOME&#34;</span><span class="p">),</span> <span class="nx">data</span><span class="p">.</span><span class="nx">Label</span><span class="p">)</span>
        <span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="nx">plistPath</span><span class="p">)</span>
	<span class="nx">t</span> <span class="o">:=</span> <span class="nx">template</span><span class="p">.</span><span class="nf">Must</span><span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;launchdConfig&#34;</span><span class="p">).</span><span class="nf">Parse</span><span class="p">(</span><span class="nf">Template</span><span class="p">()))</span>
	<span class="nx">err</span> <span class="o">:=</span> <span class="nx">t</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
		<span class="nx">log</span><span class="p">.</span><span class="nf">Fatalf</span><span class="p">(</span><span class="s">&#34;Template generation failed: %s&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>

<p>That&rsquo;s about it. The first part, about setting the correct <code>Program</code> property,
is done by concatenating the name of the program and <code>$GOPATH</code>:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s/bin/ticker&#34;</span><span class="p">,</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Getenv</span><span class="p">(</span><span class="s">&#34;GOPATH&#34;</span><span class="p">))</span>
<span class="o">//</span> <span class="nx">Output</span><span class="p">:</span> <span class="o">/</span><span class="nx">Users</span><span class="o">/</span><span class="p">&lt;</span><span class="nx">username</span><span class="p">&gt;</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">ticker</span></code></pre></td></tr></table>
</div>
</div>

<p>The second part is slightly more complex, and it&rsquo;s done by concatenating three
strings, the <code>$HOME</code> environment variable, the <code>Label</code> property of the program
and the <code>/Library/LaunchAgents</code> string:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s/Library/LaunchAgents/%s.plist&#34;</span><span class="p">,</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Getenv</span><span class="p">(</span><span class="s">&#34;HOME&#34;</span><span class="p">),</span> <span class="nx">data</span><span class="p">.</span><span class="nx">Label</span><span class="p">)</span>
<span class="o">//</span> <span class="nx">Output</span><span class="p">:</span> <span class="o">/</span><span class="nx">Users</span><span class="o">/</span><span class="p">&lt;</span><span class="nx">username</span><span class="p">&gt;</span><span class="o">/</span><span class="nx">Library</span><span class="o">/</span><span class="nx">LaunchAgents</span><span class="o">/</span><span class="nx">com</span><span class="p">.</span><span class="nx">ieftimov</span><span class="p">.</span><span class="nx">ticker</span><span class="p">.</span><span class="nx">plist</span></code></pre></td></tr></table>
</div>
</div>

<p>By having these two paths, opening the file and writing to it is very trivial -
we open the file via <code>os.Open</code> and we pass in the <code>os.File</code> structure to
<code>t.Execute</code> which writes to the file descriptor.</p>

<h2 id="what-about-the-launch-agent">What about the Launch Agent?</h2>

<p>We will keep this one simple as well. Let&rsquo;s throw in a command to our package,
make it installable via <code>go install</code> (not that there&rsquo;s much to it) and make it
runnable by our <code>.plist</code> file:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// cmd/ticker/main.go
</span><span class="c1"></span><span class="kn">package</span> <span class="nx">ticker</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s">&#34;time&#34;</span>
  <span class="s">&#34;fmt&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="k">range</span> <span class="nx">time</span><span class="p">.</span><span class="nf">Tick</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;tick!&#34;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>

<p>This the <code>ticker</code> program will use <code>time.Tick</code>, to execute an action every 30
seconds. Since this will be an infinite loop, <code>launchd</code> will kick off the program
on boot (because <code>RunAtLoad</code> is set to <code>true</code> in the <code>.plist</code> file) and will
keep it running. But, to make the program controllable from the operating system,
we need to make the program react to some OS signals, like <code>SIGINT</code> or <code>SIGTERM</code>.</p>

<h3 id="understanding-and-handling-os-signals">Understanding and handling OS signals</h3>

<p>While there&rsquo;s quite a bit to be learned about OS signals, in our
example we will scratch a bit off the surface. (If you know a lot about
inter-process communication this might be too much of an oversimplification to
you - and I apologize up front. Feel free to drop some links on the topic in the
comments so others can learn more!)</p>

<p>The best way to think about a signal is that it&rsquo;s a message from the operating
system or another process, to a process. It is an asynchronous notification sent
to a process or to a specific thread within the same process to notify it of an
event that occurred.</p>

<p>There are quite a bit of various signals that can be sent to a process
(or a thread), like <code>SIGKILL</code> (which kills a process), <code>SIGSTOP</code> (stop), <code>SIGTERM</code>
(termination), <code>SIGILL</code> and so on and so forth. There&rsquo;s an exhaustive list of
signal types on <a href="https://en.wikipedia.org/wiki/Signal_(IPC)">Wikipedia&rsquo;s page</a>
on signals.</p>

<p>To get back to <code>launchd</code>, if we look at its documentation about stopping a job
we will notice the following:</p>

<blockquote>
<p>Stopping a job will send the signal <code>SIGTERM</code> to the process. Should this not
stop the process launchd will wait <code>ExitTimeOut</code> seconds (20 seconds by default)
before sending <code>SIGKILL</code>.</p>
</blockquote>

<p>Pretty self-explanatory, right? We need to handle one signal - <code>SIGTERM</code>.
Why not <code>SIGKILL</code>? Because <code>SIGKILL</code> is a special signal that cannot be caught -
it kills the process without any chance for a graceful shutdown, no questions
asked. That&rsquo;s why there&rsquo;s a termination signal and a &ldquo;kill&rdquo; signal.</p>

<p>Let&rsquo;s throw in a bit of signal handling in our code, so our program knows that
it needs to exit when it gets told to do so:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;fmt&#34;</span>
	<span class="s">&#34;os&#34;</span>
	<span class="s">&#34;os/signal&#34;</span>
	<span class="s">&#34;syscall&#34;</span>
	<span class="s">&#34;time&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">sigs</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Signal</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
	<span class="nx">signal</span><span class="p">.</span><span class="nf">Notify</span><span class="p">(</span><span class="nx">sigs</span><span class="p">,</span> <span class="nx">syscall</span><span class="p">.</span><span class="nx">SIGINT</span><span class="p">,</span> <span class="nx">syscall</span><span class="p">.</span><span class="nx">SIGTERM</span><span class="p">)</span>

	<span class="k">go</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="o">&lt;-</span><span class="nx">sigs</span>
		<span class="nx">os</span><span class="p">.</span><span class="nf">Exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
	<span class="p">}()</span>

	<span class="k">for</span> <span class="k">range</span> <span class="nx">time</span><span class="p">.</span><span class="nf">Tick</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;tick!&#34;</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>

<p>In the new version, the agent program has two new packages imported: <code>os/signal</code>
and <code>syscall</code>. <code>os/signal</code> implements access to incoming signals, that are
primarily used on Unix-like systems. Since in this article we are specifically
interested in MacOS, this is exactly what we need.</p>

<p>Package <code>syscall</code> contains an interface to the low-level operating system
primitives. An important note about <code>syscall</code> is that it is locked down since
Go v1.4. This means that any code outside of the standard library that uses
the <code>syscall</code> package should be migrated to use the new <code>golang.org/x/sys</code>
<a href="https://golang.org/x/sys">package</a>. Since we are using <strong>only</strong> the signals constants of
<code>syscall</code> we can get away with this.</p>

<p>(If you want to read more about the package lockdown, you can see
<a href="https://docs.google.com/document/d/1QXzI9I1pOfZPujQzxhyRy6EeHYTQitKKjHfpq0zpxZs/edit">the rationale on locking it down</a>
by the Go team and the new <a href="https://golang.org/x/sys">golang.org/s/sys</a> package.)</p>

<p>Having the basics of the packages out of the way, let&rsquo;s go step by step through
the new lines of code added:
1. We make a buffered channel of type <code>os.Signal</code>, with a size of <code>1</code>. <code>os.Signal</code>
is a type that represents an operating system signal.
2. We call <code>signal.Notify</code> with the new channel as an argument, plus
<code>syscall.SIGINT</code> and <code>syscall.SIGTERM</code>. This function states &ldquo;when the OS sends
a <code>SIGINT</code> or a <code>SIGTERM</code> signal to this program, send the signal to the
channel&rdquo;. This allows us to somehow handle the sent OS signal.
3. The new goroutine that we spawn waits for any of the signals to arrive through
the channel. Since we know that any of the signals that will arrive are about
shutting down the program, after receiving any signal we use <code>os.Exit(0)</code>
(<a href="https://godoc.org/os#Exit">docs</a>) to gracefully stop the program. One caveat
here is that if we had any <code>defer</code>red calls they would not be run.</p>

<p>Now <code>launchd</code> can run the agent program and we can <code>load</code> and <code>unload</code>,
<code>start</code> and <code>stop</code> it using <code>launchctl</code>.</p>

<h2 id="putting-it-all-together">Putting it all together</h2>

<p>Now that we have all the pieces ready, we need to put them together to a
good use. Our application will consist of two binaries - a CLI tool and an
agent (daemon). Both of the programs will be stored in separate subdirectories
of the <code>cmd</code> directory.</p>

<p>The CLI tool:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// cmd/cli/main.go
</span><span class="c1"></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;log&#34;</span>
	<span class="s">&#34;os&#34;</span>
	<span class="s">&#34;text/template&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">data</span> <span class="o">:=</span> <span class="kd">struct</span> <span class="p">{</span>
		<span class="nx">Label</span>     <span class="kt">string</span>
		<span class="nx">Program</span>   <span class="kt">string</span>
		<span class="nx">KeepAlive</span> <span class="kt">bool</span>
		<span class="nx">RunAtLoad</span> <span class="kt">bool</span>
	<span class="p">}{</span>
		<span class="nx">Label</span><span class="p">:</span>     <span class="s">&#34;com.ieftimov.ticker&#34;</span><span class="p">,</span> <span class="c1">// Reverse-DNS naming convention
</span><span class="c1"></span>		<span class="nx">Program</span><span class="p">:</span>   <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s/bin/ticker&#34;</span><span class="p">,</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Getenv</span><span class="p">(</span><span class="s">&#34;GOPATH&#34;</span><span class="p">)),</span>
		<span class="nx">KeepAlive</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
		<span class="nx">RunAtLoad</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
	<span class="p">}</span>

        <span class="nx">plistPath</span> <span class="o">:=</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s/Library/LaunchAgents/%s.plist&#34;</span><span class="p">,</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Getenv</span><span class="p">(</span><span class="s">&#34;HOME&#34;</span><span class="p">),</span> <span class="nx">data</span><span class="p">.</span><span class="nx">Label</span><span class="p">)</span>
        <span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="nx">plistPath</span><span class="p">)</span>
	<span class="nx">t</span> <span class="o">:=</span> <span class="nx">template</span><span class="p">.</span><span class="nf">Must</span><span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;launchdConfig&#34;</span><span class="p">).</span><span class="nf">Parse</span><span class="p">(</span><span class="nf">Template</span><span class="p">()))</span>
	<span class="nx">err</span> <span class="o">:=</span> <span class="nx">t</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
		<span class="nx">log</span><span class="p">.</span><span class="nf">Fatalf</span><span class="p">(</span><span class="s">&#34;Template generation failed: %s&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>

<p>And the ticker program:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// cmd/ticker/main.go
</span><span class="c1"></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;fmt&#34;</span>
	<span class="s">&#34;os&#34;</span>
	<span class="s">&#34;os/signal&#34;</span>
	<span class="s">&#34;syscall&#34;</span>
	<span class="s">&#34;time&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">sigs</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Signal</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
	<span class="nx">signal</span><span class="p">.</span><span class="nf">Notify</span><span class="p">(</span><span class="nx">sigs</span><span class="p">,</span> <span class="nx">syscall</span><span class="p">.</span><span class="nx">SIGINT</span><span class="p">,</span> <span class="nx">syscall</span><span class="p">.</span><span class="nx">SIGTERM</span><span class="p">)</span>

	<span class="k">go</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="o">&lt;-</span><span class="nx">sigs</span>
		<span class="nx">os</span><span class="p">.</span><span class="nf">Exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
	<span class="p">}()</span>

	<span class="k">for</span> <span class="k">range</span> <span class="nx">time</span><span class="p">.</span><span class="nf">Tick</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;tick!&#34;</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>

<p>To install them both, we need to run <code>go install ./...</code> in the project root. The
command will install all the sub-packages that are located within the project.
This will leave us with two available binaries, installed in the <code>$GOPATH/bin</code>
path.</p>

<p>To install our launch agent, we need to run only the CLI tool, via the <code>cli</code>
command. This will generate the <code>.plist</code> file and place it in the
<code>~/Library/LaunchAgents</code> path. We don&rsquo;t need to touch the <code>ticker</code> binary - that
one will be managed by <code>launchd</code>.</p>

<p>To load the newly created <code>.plist</code> file, we need to run:</p>

<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">launchctl load ~/Library/LaunchAgents/com.ieftimov.ticker.plist</code></pre></div>

<p>When we run it, we will not see anything immediately, but after 30 seconds
the ticker will add a <code>tick!</code> line in <code>/tmp/ticker.out.log</code>. We can <code>tail</code>
the file to see the new lines being added. If we want to unload the agent, we
can use:</p>

<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">launchctl unload ~/Library/LaunchAgents/com.ieftimov.ticker.plist</code></pre></div>

<p>This will unload the launch agent and will stop the ticker from running. Remember
the signal handling we added? This is the case where it&rsquo;s being used! Also, we
could have automated the (un)loading of the file via the CLI tool but for
simplicity, we left it out. You can try to improve the CLI tool by making it a
bit smarter with subcommands and flags, as a follow-up exercise from this
tutorial.</p>

<p>Finally, if you decide to completely delete the launch agent, you can remove the
<code>.plist</code> file:</p>

<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">rm ~/Library/LaunchAgents/com.ieftimov.ticker.plist</code></pre></div>

<h2 id="in-closing">In closing</h2>

<p>As part of this (quite long!) article, we saw how we can work with <code>launchd</code> and
Golang. We took a detour, like learning about <code>launchd</code> and
<code>launchctl</code>, generating XML files using the <code>text/template</code> package, we took
a look at OS signals and how we can gracefully shutdown a Go program by handling
the <code>SIGINT</code> and <code>SIGTERM</code> signals. There was quite a bit to learn and see, but
we got to the end.</p>

<p>Of course, we only scratched the surface with this article. For example,
<code>launchd</code> is quite an interesting tool. You can use it also like <code>crontab</code>
because it allows running programs at explicit time/date combinations or on
specific days. Or, for example, the XML template can be embedded in the program
binary using tools like <a href="https://github.com/jteeuwen/go-bindata"><code>go-bindata</code></a>,
instead of hardcoding it in a function. Also, you explore more about signals,
how they work and how Go implements these low-level primitives so you can use
them with ease in your programs. The options are plenty, feel free to explore!</p>

<p>If you have found any mistakes in the article, feel free to drop a comment
below - I will appreciate it a ton. I find learning through teaching (blogging)
a very pleasant experience and would like to have all the details fully
correct in my posts.</p>

    </div>

    
    


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://ieftimov.com/tags/launchagent/">launchagent</a>
          <a href="https://ieftimov.com/tags/launchd/">launchd</a>
          <a href="https://ieftimov.com/tags/launchctl/">launchctl</a>
          <a href="https://ieftimov.com/tags/lpc/">lpc</a>
          <a href="https://ieftimov.com/tags/signals/">signals</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/golang-datastructures-linked-lists/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">Data structures in Go: Linked lists</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/post/golang-package-multiple-binaries/">
            <span class="next-text nav-default">Packing multiple binaries in a Golang package</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  <div class="disqus-comment">
  <div class="disqus-button" id="load_disqus" onclick="load_disqus()">
    Show Disqus Comments
  </div>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = "https://ieftimov.com/post/create-manage-macos-launchd-agents-golang/";
    };
    function load_disqus() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'eftimov';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

      $('#load_disqus').remove();
    };
  </script>
  <noscript>Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
  
  </div>

    

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="https://stackoverflow.com/users/601555/ilija-eftimov" rel="me noopener" class="iconfont"
      title="stack-overflow"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M809.714286 932.571429l-638.857143 0 0-274.285714-91.428571 0 0 365.714286 821.714286 0 0-365.714286-91.428571 0 0 274.285714zm-538.285714-299.428571l18.857143-89.714286 447.428571 94.285714-18.857143 89.142857zm58.857143-213.714286l38.285714-83.428571 414.285714 193.714286-38.285714 82.857143zm114.857143-203.428571l58.285714-70.285714 350.857143 293.142857-58.285714 70.285714zm226.857143-216l272.571429 366.285714-73.142857 54.857143-272.571429-366.285714zm-410.285714 840.571429l0-90.857143 457.142857 0 0 90.857143-457.142857 0z"></path>
</svg>

    </a>
  
    <a href="https://twitter.com/fteem" rel="me noopener" class="iconfont"
      title="twitter"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1264 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M1229.8616 18.043658c0 0-117.852626 63.135335-164.151872 67.344358-105.225559-164.151872-505.082682-92.598492-437.738325 223.078185C278.622548 312.675223 89.216542 47.506814 89.216542 47.506814s-117.852626 189.406006 75.762402 345.139833C127.097743 396.85567 55.544363 371.601535 55.544363 371.601535S26.081207 535.753407 253.368414 615.724832c-21.045112 29.463156-113.643603 8.418045-113.643603 8.418045s25.254134 143.10676 231.496229 180.987961c-143.10676 130.479693-387.230056 92.598492-370.393967 105.225559 206.242095 189.406006 1119.599946 231.496229 1128.01799-643.98042C1179.353331 249.539887 1263.533778 123.269217 1263.533778 123.269217s-130.479693 37.881201-138.897738 33.672179C1225.652577 98.015083 1229.8616 18.043658 1229.8616 18.043658"></path>
</svg>

    </a>
  
    <a href="https://www.linkedin.com/in/ieftimov/" rel="me noopener" class="iconfont"
      title="linkedin"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="33" height="33">
  <path d="M872.405333 872.618667h-151.637333v-237.610667c0-56.661333-1.152-129.578667-79.018667-129.578667-79.061333 0-91.136 61.653333-91.136 125.397334v241.792H398.976V384h145.664v66.602667h1.962667c20.352-38.4 69.845333-78.933333 143.786666-78.933334 153.642667 0 182.058667 101.12 182.058667 232.746667v268.202667zM227.712 317.141333a87.978667 87.978667 0 0 1-88.021333-88.106666 88.064 88.064 0 1 1 88.021333 88.106666z m76.032 555.477334H151.68V384h152.064v488.618667zM948.266667 0H75.562667C33.792 0 0 33.024 0 73.770667v876.458666C0 991.018667 33.792 1024 75.562667 1024h872.576C989.866667 1024 1024 991.018667 1024 950.229333V73.770667C1024 33.024 989.866667 0 948.138667 0h0.128z"></path>
</svg>

    </a>
  
    <a href="https://github.com/fteem" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>
  
    <a href="ieftimovcom@gmail.com" rel="me noopener" class="iconfont"
      title="email"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>


<a href="https://ieftimov.com/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2014 -
    2019
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        Ilija Eftimov
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>






  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  













</body>
</html>
