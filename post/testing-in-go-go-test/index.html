<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Testing in Go: go test | Ilija Eftimov ⚡️</title><meta name=keywords content><meta name=description content="If you&rsquo;re going to remember anything from this article, remember this: go test is a command which automates the execution of test files and functions in a Go project. The go test command ships with Go itself, so if you have Go installed there&rsquo;s nothing to check - it&rsquo;s available on your machine.
go test will recompile each package along with any files with names matching the file pattern *_test.go. These *_test."><meta name=author content="Ilija"><link rel=canonical href=https://ieftimov.com/post/testing-in-go-go-test/><link href=/assets/css/stylesheet.min.css rel="preload stylesheet" as=style><link rel=icon href=https://ieftimov.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ieftimov.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ieftimov.com/favicon-32x32.png><link rel=apple-touch-icon href=https://ieftimov.com/apple-touch-icon.png><link rel=mask-icon href=https://ieftimov.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><script async defer data-domain=ieftimov.com src=https://plausible.io/js/plausible.js></script><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel=stylesheet><meta property="og:title" content="Testing in Go: go test"><meta property="og:description" content="If you&rsquo;re going to remember anything from this article, remember this: go test is a command which automates the execution of test files and functions in a Go project. The go test command ships with Go itself, so if you have Go installed there&rsquo;s nothing to check - it&rsquo;s available on your machine.
go test will recompile each package along with any files with names matching the file pattern *_test.go. These *_test."><meta property="og:type" content="article"><meta property="og:url" content="https://ieftimov.com/post/testing-in-go-go-test/"><meta property="og:image" content="https://ieftimov.com/cards/testing-in-go-go-test.png"><meta property="article:published_time" content="2019-07-01T00:00:00+00:00"><meta property="article:modified_time" content="2019-07-01T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ieftimov.com/cards/testing-in-go-go-test.png"><meta name=twitter:title content="Testing in Go: go test"><meta name=twitter:description content="If you&rsquo;re going to remember anything from this article, remember this: go test is a command which automates the execution of test files and functions in a Go project. The go test command ships with Go itself, so if you have Go installed there&rsquo;s nothing to check - it&rsquo;s available on your machine.
go test will recompile each package along with any files with names matching the file pattern *_test.go. These *_test."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ieftimov.com/posts/"},{"@type":"ListItem","position":2,"name":"Testing in Go: go test","item":"https://ieftimov.com/post/testing-in-go-go-test/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Testing in Go: go test","name":"Testing in Go: go test","description":"If you\u0026amp;rsquo;re going to remember anything from this article, remember this: go test is a command which automates the execution of test files and functions in a Go project. The go …","keywords":[],"articleBody":"If you’re going to remember anything from this article, remember this: go test is a command which automates the execution of test files and functions in a Go project. The go test command ships with Go itself, so if you have Go installed there’s nothing to check - it’s available on your machine.\ngo test will recompile each package along with any files with names matching the file pattern *_test.go. These *_test.go files can contain test functions, benchmark functions, and example functions. Each listed package will cause the execution of a separate test binary.\ngo test compiles test files, that declare a package, ending with the suffix *_test.go as a separate package. It then links them with the main test binary and runs them.\nWhile go test seems simple on the surface, it actually has many options and commands. It allows for control of what test to be run, as in file-specific or package-specific tests, has flags for skipping tests, reporting test coverage and other options. Also, it has smart caching mechanisms under the hood, to avoids rebuilding packages every time we run our tests.\ngo test is a compact yet a rich tool that every Gopher should have a solid command of. We will not look at all its features, but at the end of this article, we will have a good understanding of the workings of the tool.\n  Running modes go test has two running modes. Understanding them is essential to having an easy time working with the tool:\n Local directory mode, or running without arguments Package list mode, or running with arguments  In the local directory mode, go test compiles the package sources and tests found in the current directory and then runs the resulting test binary. This mode disables caching. After the package test finishes, go test prints a summary line showing the test status (‘ok’ or ‘FAIL’), the package name, and elapsed time.\nTo run your tests in this mode, run go test in your project’s root directory.\nIn the package list mode, go test compiles and tests each of the packages listed as arguments to the command. If a package test passes, go test prints only the final ‘ok’ summary line. If a package test fails, go test prints the full test output.\nTo run your test in this mode, run go test with explicit package arguments. For example, we can run go test PACKAGE_NAME to test a specific package or go test ./... to test all packages in a directory tree or go test . to run all tests in the current directory.\nIn our daily work with go test, the difference between the two modes is caching.\nWhen we run go test in package list mode it will cache successful package test results to avoid unnecessary reruns. When it can find the result of a test in the cache, go test will redisplay the cached result instead of running the tests again. When this happens, go test will annotate the test results with (cached) in place of the elapsed time in the summary line.\nTest run control One of the major features of the go test command is the ability to control what tests files and test functions we can run. As we discussed before, go test has two modes to which we can supply package or file names. Additionally, we can also selectively run one or more test functions.\nTo have an easier time further in this post, we will define a type Person. It will have two functions: a constructor NewPerson and a function older, which will take a *Person and return if one *Person is older than another *Person.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  package person import \"errors\" type Person struct { age int } func NewPerson(age int) (*Person, error) { if age 1 { return nil, errors.New(\"A person is at least 1 years old\") } return \u0026Person{ age: age, }, nil } func (p *Person) older(other *Person) bool { return p.age  other.age }   Let’s add tests for the constructor and the older function. We want to test that the constructor will return an error when a negative integer is passed as the age argument:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  package person import ( \"testing\" ) func TestNewPersonPositiveAge(t *testing.T) { _, err := NewPerson(1) if err != nil { t.Errorf(\"Expected person, received %v\", err) } } func TestNewPersonNegativeAge(t *testing.T) { p, err := NewPerson(-1) if err == nil { t.Errorf(\"Expected error, received %v\", p) } }   Let’s add two more tests for the older function. We will create two *Person with different ages and check for the return value of the older function:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  func TestOlderFirstOlderThanSecond(t *testing.T) { p1, _ := NewPerson(1) p2, _ := NewPerson(2) if p1.older(p2) { t.Errorf(\"Expected p1 with age %d to be younger than p2 with age %d\", p1.age, p2.age) } } func TestOlderSecondOlderThanFirst(t *testing.T) { p1, _ := NewPerson(2) p2, _ := NewPerson(1) if !p1.older(p2) { t.Errorf(\"Expected p1 with age %d to be older than p2 with age %d\", p1.age, p2.age) } }   (If you find the tests a bit confusing I apologise - tried hard to make them more readable but it was hard. I guess that says something about the example.)\nThe first way to control tests running is by supplying the test files as arguments to the go test command. For example, if we have a person.go and person_test.go files, we need to run:\n1 2  $ go test person.go person_test.go ok command-line-arguments\t0.005s   The go test command prints only the final ok, because all the test cases passed. If we would like to see a more detailed output, we can use the -v flag:\n1 2 3 4 5 6 7 8 9 10 11  $ go test person.go person_test.go -v === RUN TestNewPersonPositiveAge --- PASS: TestNewPersonPositiveAge (0.00s) === RUN TestNewPersonNegativeAge --- PASS: TestNewPersonNegativeAge (0.00s) === RUN TestOlderFirstOlderThanSecond --- PASS: TestOlderFirstOlderThanSecond (0.00s) === RUN TestOlderSecondOlderThanFirst --- PASS: TestOlderSecondOlderThanFirst (0.00s) PASS ok command-line-arguments\t0.005s   The second way to run the test for the person package is to supply its name to the go test command:\n1 2  $ go test person ok person\t0.004s   This way, the go test locates the package, builds it and runs its tests. (Adding the -v flag will produce the same output as before.)\nThe third way to run tests is by specifying a test function to be run, using the -run flag. The flag takes an argument, which is a regex that will try to match against any test functions in the current directory. For example, if we would like to run the TestNewPersonPositiveAge and TestNewPersonNegativeAge function, we can do this:\n1 2 3 4 5 6 7  $ go test -run TestNewPerson -v === RUN TestNewPersonPositiveAge --- PASS: TestNewPersonPositiveAge (0.00s) === RUN TestNewPersonNegativeAge --- PASS: TestNewPersonNegativeAge (0.00s) PASS ok person\t0.004s   If we mistakenly supply a regexp that will not match anything, go test will inform us about it:\n1 2 3 4  $ go test -run TestFoo -v testing: warning: no tests to run PASS ok person\t0.004s   Failing Fast Often when running tests we want to lower the waiting time and stop at the first test failure we hit. The default mode is to wait for all tests to finish before the errors are reported, so depending on the project this can save us some time.\nTo do this, go test has a special flag we can use: -failfast. Fail fast does what it advertises: it will stop at the first test that fails, exiting the process that is running the test suite/files. To see it in action, we will break one of the test functions for the older function that we introduced earlier:\n1 2 3 4 5 6 7 8 9 10  // Removing everything else for brewity...  func TestOlderFirstOlderThanSecond(t *testing.T) { p1, _ := NewPerson(100) p2, _ := NewPerson(2) if p1.older(p2) { t.Errorf(\"Expected p1 with age %d to be younger than p2 with age %d\", p1.age, p2.age) } }   We know this test will fail: p1 will be older than p2, because they are 100 and 2 years old respectively. If we run go test it will run all the test functions, regardless if some fail:\n1 2 3 4 5 6 7 8 9 10 11 12 13  $ go test -v === RUN TestNewPersonPositiveAge --- PASS: TestNewPersonPositiveAge (0.00s) === RUN TestNewPersonNegativeAge --- PASS: TestNewPersonNegativeAge (0.00s) === RUN TestOlderFirstOlderThanSecond --- FAIL: TestOlderFirstOlderThanSecond (0.00s) person_test.go:26: Expected p1 with age 100 to be younger than p2 with age 2 === RUN TestOlderSecondOlderThanFirst --- PASS: TestOlderSecondOlderThanFirst (0.00s) FAIL exit status 1 FAIL\tperson\t0.004s   Now, let’s see the difference if we add the -failfast flag:\n1 2 3 4 5 6 7 8 9 10 11  $ go test -v -failfast === RUN TestNewPersonPositiveAge --- PASS: TestNewPersonPositiveAge (0.00s) === RUN TestNewPersonNegativeAge --- PASS: TestNewPersonNegativeAge (0.00s) === RUN TestOlderFirstOlderThanSecond --- FAIL: TestOlderFirstOlderThanSecond (0.00s) person_test.go:26: Expected p1 with age 100 to be younger than p2 with age 2 FAIL exit status 1 FAIL\tperson\t0.004s   By adding the -failfast flag we actually stopped right where we got the first failure - when running the TestOlderFirstOlderThanSecond test function. This option is useful when we do some heavier refactorings of our code. If our refactor breaks some tests, instead of being overwhelmed by all the errors we can add the -failfast flag and fix errors one by one.\nNext time you do some big refactors give it a shot, it might save you some sanity as you’re fixing the tests.\n  Coverage Another interesting feature that is packed in go test is test coverage. Taken from Go’s website from the blog post on coverage:\n Test coverage is a term that describes how much of a package’s code is exercised by running the package’s tests. If executing the test suite causes 80% of the package’s source statements to be run, we say that the test coverage is 80%.\n We will not go in detail here on how the coverage tools work. I recommend referring to the “Test coverage for Go” section in the aforementioned post to understand how it actually measures the coverage.\nIf we would like to check the test coverage on our Person type and its functions, we can run go test -cover:\n1 2 3 4  $ go test -cover PASS coverage: 100.0% of statements ok person\t0.004s   This is great - it means that our tests cover all the functionality of our functions. To see the coverage tool in action, we can add some more functionality to the NewPerson constructor function. Creating a person that is 1000 years old doesn’t make much sense, especially knowing that the older person ever recorded was 122 years old. We can extend the constructor to validate that the newly created Person instance cannot be older than 130 years:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  package person import \"errors\" type Person struct { age int } func NewPerson(age int) (*Person, error) { if age 1 { return nil, errors.New(\"A person is at least 1 years old\") } if age = 130 { return nil, errors.New(\"A person cannot be older than 130 years\") } return \u0026Person{ age: age, }, nil } func (p *Person) older(other *Person) bool { return p.age  other.age }   If we would run the coverage report again, we will see the following output:\n1 2 3 4 5 6 7 8 9 10 11 12  $ go test -cover -v === RUN TestNewPersonPositiveAge --- PASS: TestNewPersonPositiveAge (0.00s) === RUN TestNewPersonNegativeAge --- PASS: TestNewPersonNegativeAge (0.00s) === RUN TestOlderFirstOlderThanSecond --- PASS: TestOlderFirstOlderThanSecond (0.00s) === RUN TestOlderSecondOlderThanFirst --- PASS: TestOlderSecondOlderThanFirst (0.00s) PASS coverage: 83.3% of statements ok person\t0.004s   Whoops, our coverage dropped from 100% to 83.3%. To see where our problem is, we can ask go test to create a coverage profile for us, using the -coverprofile flag:\n1 2 3 4  $ go test -coverprofile=prof.out PASS coverage: 83.3% of statements ok person\t0.004s   This will create a prof.out file, looking like this:\n1 2 3 4 5 6 7 8  $ cat prof.out mode: set person/person.go:9.42,10.13 1 1 person/person.go:14.2,14.16 1 1 person/person.go:18.2,20.3 1 1 person/person.go:10.13,12.3 1 1 person/person.go:14.16,16.3 1 0 person/person.go:23.44,25.2 1 1   We don’t have to understand the output here, because Go has another tool that we can use with the profile file to visualise the coverage report better: its name is go tool cover. Using the prof.out profile file we have, we can generate an HTML page that will visualise what parts of the code are covered by tests:\n1  $ go tool cover -html=prof.out   This command pops open our browser with a page looking like this:\n  Looking at the image above, the red coloured code is the one that is never run. In other words, the red code is not covered, while the green one is. The grey code is not tracked, because from the coverage tool perspective it’s boilerplate (read: not needed to be tested).\nFrom the image, it’s clear that our tests never run the new branch where we handle unreasonably old age as the argument. Let’s add another quick test function that will cover this functionality:\n1 2 3 4 5 6 7  // person_test.go func TestNewPersonHugeAge(t *testing.T) { p, err := NewPerson(150) if err == nil { t.Errorf(\"Expected error, received %v\", p) } }   After running go test -coverprofile=hundred.out -v we will see the coverage go back to 100% again:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  $ go test -coverprofile=hundred.out -v === RUN TestNewPersonPositiveAge --- PASS: TestNewPersonPositiveAge (0.00s) === RUN TestNewPersonNegativeAge --- PASS: TestNewPersonNegativeAge (0.00s) === RUN TestNewPersonHugeAge --- PASS: TestNewPersonHugeAge (0.00s) === RUN TestOlderFirstOlderThanSecond --- PASS: TestOlderFirstOlderThanSecond (0.00s) === RUN TestOlderSecondOlderThanFirst --- PASS: TestOlderSecondOlderThanFirst (0.00s) PASS coverage: 100.0% of statements ok person\t0.004s   Here’s the HTML output of the coverage profile:\n  The go test and go tool cover tools packs more combined functionality. I encourage you to read more about it in the official blog post and to expriment further with the tools.\nRunning modes Software is built to serve highly mutable business requirements, which results in applications that grow and evolve over time. Such applications are (hopefully) well tested, with tests operating on unit, integration and end-to-end levels.\nA common technique on bigger projects often is to be explicit what type of tests we want to run. For example, when running go test, do we want to include running the integration tests of the project, or just the unit tests? In such cases, there are two useful techniques that come out of the box with Go: build tags and short mode.\nUsing -short mode The -short mode for go test allows us to mark any long-running tests to be skipped in this mode. go test and the testing package support this via the t.Skip(), the testing.Short() functions and the -short flag.\nWe can skip a test function by checking if the short mode is on and invoking the t.Skip function if that returns true. Let’s see this by changing an earlier example:\n1 2 3 4 5 6 7 8 9 10 11  func TestOlderFirstOlderThanSecond(t *testing.T) { if testing.Short() { t.Skip(\"Skipping long-running test.\") } p1, _ := NewPerson(1) p2, _ := NewPerson(2) if p1.older(p2) { t.Errorf(\"Expected p1 with age %d to be younger than p2 with age %d\", p1.age, p2.age) } }   If we run the tests normally, using go test -v we should see no change in the output:\n1 2 3 4 5 6 7 8 9 10 11 12 13  $ go test -v === RUN TestNewPersonPositiveAge --- PASS: TestNewPersonPositiveAge (0.00s) === RUN TestNewPersonNegativeAge --- PASS: TestNewPersonNegativeAge (0.00s) === RUN TestNewPersonHugeAge --- PASS: TestNewPersonHugeAge (0.00s) === RUN TestOlderFirstOlderThanSecond --- PASS: TestOlderFirstOlderThanSecond (0.00s) === RUN TestOlderSecondOlderThanFirst --- PASS: TestOlderSecondOlderThanFirst (0.00s) PASS ok person\t0.004s   If we would enable the short mode using the -short flag, we should see the change in the behaviour and output:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  $ go test -short -v === RUN TestNewPersonPositiveAge --- PASS: TestNewPersonPositiveAge (0.00s) === RUN TestNewPersonNegativeAge --- PASS: TestNewPersonNegativeAge (0.00s) === RUN TestNewPersonHugeAge --- PASS: TestNewPersonHugeAge (0.00s) === RUN TestOlderFirstOlderThanSecond --- SKIP: TestOlderFirstOlderThanSecond (0.00s) person_test.go:30: Skipping long-running test. === RUN TestOlderSecondOlderThanFirst --- PASS: TestOlderSecondOlderThanFirst (0.00s) PASS ok person\t0.005s   We can see that the output contains one SKIP line, meaning in short mode go test skipped the test function. We can use -short in other ways, besides skipping a test. For example, mocking networks calls instead of opening a connection or loading simple fixtures instead of loading them from a database. The options are many, it all depends on the function that the test is covering.\n  Using build tags go test supports build tags out of the box, like the -short flag. While we apply the short mode on the function level, we use the build tags on a file level. This means that there is no way to use build tags to skip one or a few functions. Rather, build tags are used to run (or skip) a special type of test files from our test suite.\nThere are a couple of rules on build tags. As indicated in this Stack Overflow answer:\n build tags are special comments, with the format // +build TAGNAME we have to place the tag on the first line of the file we have to add an empty line after the tag the tag name comment cannot have a dash, but it allows underscores  Following these rules, we can add a tag to our person_test.go file from earlier:\n1 2 3 4 5 6 7 8 9  // +build person_tests  package person import ( \"testing\" ) // Snipped...    (The person_tests tag is a useless when we have only one file in the test suite, but we will add it for experimentational purposes.)\nTo add the build tag to our go test command, we need to run go test -tags=TAG_NAME. To run the files with the person_tests build tag:\n1 2 3 4 5 6 7 8 9 10 11 12 13  $ go test -tags=person_tests -v === RUN TestNewPersonPositiveAge --- PASS: TestNewPersonPositiveAge (0.00s) === RUN TestNewPersonNegativeAge --- PASS: TestNewPersonNegativeAge (0.00s) === RUN TestNewPersonHugeAge --- PASS: TestNewPersonHugeAge (0.00s) === RUN TestOlderFirstOlderThanSecond --- PASS: TestOlderFirstOlderThanSecond (0.00s) === RUN TestOlderSecondOlderThanFirst --- PASS: TestOlderSecondOlderThanFirst (0.00s) PASS ok person\t0.005s   Based on the supplied tag, go test detects the files tagged with person_tests and runs them. If we would supply a tag that does not exist in the package, the output would report that no files are found:\n1 2  $ go test -tags=foo -v ? person\t[no test files]   Notable mentions Covering all the features that go test packs in a single post is a hard undertaking. Here I will mention some other useful features that you should try to use and read more on:\n List tests with -list: to list tests, benchmarks, or examples matching a regular expression passed as the argument. The usage of the -list flags is analogous to the -run flag that we discussed before. When we use this flag go test will not run any tests, benchmarks or examples. Disabling caching with -count: as we discussed before, go test by default caches test results for packages. It then uses them to skip running tests that have are not modified between two runs. Although can improve the performance, there are times when we would like to disable the caching using the -count=1 flag. Get JSON output using -json: if we would like to take the output of go test and process it using a program, having it in a JSON format is better than normal text. This flag will convert the output to JSON, so processing it with a program is less cumbersome. Use more CPU cores using -cpu: this flag will set the GOMAXPROCS variable to the argument that we pass to the flag. It limits the number of operating system threads that can execute user-level Go code simultaneously. Detect race conditions using -race: since it’s very easy to write concurrent code in Go, race conditions are always a risk. Go’s tooling is great in this regard - it has a fully integrated race conditions detector in its toolchain. You can read more about it in its announcement blog post.  Liked this article? You can buy me a coffee. Or simply subscribe to my newsletter and get my fresh posts in your inbox. It's short and sweet, going out monthly to over 1,000 subscribers.  ","wordCount":"3480","inLanguage":"en","datePublished":"2019-07-01T00:00:00Z","dateModified":"2019-07-01T00:00:00Z","author":{"@type":"Person","name":"Ilija"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ieftimov.com/post/testing-in-go-go-test/"},"publisher":{"@type":"Organization","name":"Ilija Eftimov ⚡️","logo":{"@type":"ImageObject","url":"https://ieftimov.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://ieftimov.com/ accesskey=h title="Ilija Eftimov ⚡️ (Alt + H)">Ilija Eftimov ⚡️</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://ieftimov.com/posts title=Archive><span>Archive</span></a></li><li><a href=https://ieftimov.com/about title=About><span>About</span></a></li><li><a href=https://ieftimov.com/newsletter title=Newsletter><span>Newsletter</span></a></li><li><a href=https://forms.gle/orfXK5jh1LRaiFzo8 title="Suggest a topic"><span>Suggest a topic</span></a></li><li><a href=https://www.buymeacoffee.com/ieftimov title="Buy me a ☕"><span>Buy me a ☕</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Testing in Go: go test</h1><div class=post-meta>July 1, 2019&nbsp;·&nbsp;17 min&nbsp;·&nbsp;Ilija</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#running-modes aria-label="Running modes">Running modes</a></li><li><a href=#test-run-control aria-label="Test run control">Test run control</a></li><li><a href=#failing-fast aria-label="Failing Fast">Failing Fast</a></li><li><a href=#coverage aria-label=Coverage>Coverage</a></li><li><a href=#running-modes-1 aria-label="Running modes">Running modes</a><ul><li><a href=#using--short-mode aria-label="Using -short mode">Using <code>-short</code> mode</a></li><li><a href=#using-build-tags aria-label="Using build tags">Using build tags</a></li></ul></li><li><a href=#notable-mentions aria-label="Notable mentions">Notable mentions</a></li></ul></div></details></div><div class=post-content><p>If you&rsquo;re going to remember anything from this article, remember this: <code>go test</code> is a command which automates the execution of test files and functions in
a Go project. The <code>go test</code> command ships with Go itself, so if you have Go
installed there&rsquo;s nothing to check - it&rsquo;s available on your machine.</p><p><code>go test</code> will recompile each package along with any files with names matching
the file pattern <code>*_test.go</code>. These <code>*_test.go</code> files can contain test
functions, benchmark functions, and example functions. Each listed package will
cause the execution of a separate test binary.</p><p><code>go test</code> compiles test files, that declare a package, ending with the suffix
<code>*_test.go</code> as a separate package. It then links them with the main test binary
and runs them.</p><p>While <code>go test</code> seems simple on the surface, it actually has many options and
commands. It allows for control of what test to be run, as in file-specific or
package-specific tests, has flags for skipping tests, reporting test coverage
and other options. Also, it has smart caching mechanisms under the hood, to
avoids rebuilding packages every time we run our tests.</p><p><code>go test</code> is a compact yet a rich tool that every Gopher should have a solid
command of. We will not look at all its features, but at the end of this
article, we will have a good understanding of the workings of the tool.</p><figure class=imagecaption><img class=caption src=/testing-in-go-go-test/jogging.png caption alt="Person running">
<span class=caption-text style="font-size:.75em;display:table;margin:0 auto 1.5em"></span></figure><h2 id=running-modes>Running modes<a hidden class=anchor aria-hidden=true href=#running-modes>#</a></h2><p><code>go test</code> has two running modes. Understanding them is essential to having an
easy time working with the tool:</p><ol><li>Local directory mode, or running without arguments</li><li>Package list mode, or running with arguments</li></ol><p>In the <strong>local directory mode</strong>, <code>go test</code> compiles the package sources and
tests found in the current directory and then runs the resulting test binary.
This mode disables caching. After the package test finishes, <code>go test</code> prints a
summary line showing the test status (&lsquo;ok&rsquo; or &lsquo;FAIL&rsquo;), the package name, and
elapsed time.</p><p>To run your tests in this mode, run <code>go test</code> in your project&rsquo;s root directory.</p><p>In the <strong>package list mode</strong>, <code>go test</code> compiles and tests each of the packages
listed as arguments to the command. If a package test passes, <code>go test</code> prints
only the final &lsquo;ok&rsquo; summary line. If a package test fails, go test prints the
full test output.</p><p>To run your test in this mode, run <code>go test</code> with explicit package arguments.
For example, we can run <code>go test PACKAGE_NAME</code> to test a specific package or
<code>go test ./...</code> to test all packages in a directory tree or <code>go test .</code> to run
all tests in the current directory.</p><p>In our daily work with <code>go test</code>, the difference between the two modes is
caching.</p><p>When we run <code>go test</code> in package list mode it will cache successful package
test results to avoid unnecessary reruns. When it can find the result of a test
in the cache, <code>go test</code> will redisplay the cached result instead of running the
tests again. When this happens, <code>go test</code> will annotate the test results with
<code>(cached)</code> in place of the elapsed time in the summary line.</p><h2 id=test-run-control>Test run control<a hidden class=anchor aria-hidden=true href=#test-run-control>#</a></h2><p>One of the major features of the <code>go test</code> command is the ability to control
what tests files and test functions we can run. As we discussed before, <code>go test</code> has two modes to which we can supply package or file names. Additionally,
we can also selectively run one or more test functions.</p><p>To have an easier time further in this post, we will define a type <code>Person</code>.
It will have two functions: a constructor <code>NewPerson</code> and a function <code>older</code>,
which will take a <code>*Person</code> and return if one <code>*Person</code> is older than another
<code>*Person</code>.</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#d75f00>package</span> person

<span style=color:#d75f00>import</span> <span style=color:#00afaf>&#34;errors&#34;</span>

<span style=color:#0087ff>type</span> Person <span style=color:#0087ff>struct</span> {
	age <span style=color:#af0000>int</span>
}

<span style=color:#0087ff>func</span> <span style=color:#0087ff>NewPerson</span>(age <span style=color:#af0000>int</span>) (*Person, <span style=color:#af0000>error</span>) {
	<span style=color:#5f8700>if</span> age &lt; <span style=color:#00afaf>1</span> {
		<span style=color:#5f8700>return</span> <span style=color:#d75f00>nil</span>, errors.<span style=color:#0087ff>New</span>(<span style=color:#00afaf>&#34;A person is at least 1 years old&#34;</span>)
	}

	<span style=color:#5f8700>return</span> &amp;Person{
		age: age,
	}, <span style=color:#d75f00>nil</span>
}

<span style=color:#0087ff>func</span> (p *Person) <span style=color:#0087ff>older</span>(other *Person) <span style=color:#af0000>bool</span> {
	<span style=color:#5f8700>return</span> p.age &gt; other.age
}</code></pre></td></tr></table></div></div><p>Let&rsquo;s add tests for the constructor and the <code>older</code> function. We want to test
that the constructor will return an error when a negative integer is passed as
the <code>age</code> argument:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#d75f00>package</span> person

<span style=color:#d75f00>import</span> (
	<span style=color:#00afaf>&#34;testing&#34;</span>
)

<span style=color:#0087ff>func</span> <span style=color:#0087ff>TestNewPersonPositiveAge</span>(t *testing.T) {
	_, err := <span style=color:#0087ff>NewPerson</span>(<span style=color:#00afaf>1</span>)
	<span style=color:#5f8700>if</span> err != <span style=color:#d75f00>nil</span> {
		t.<span style=color:#0087ff>Errorf</span>(<span style=color:#00afaf>&#34;Expected person, received %v&#34;</span>, err)
	}
}

<span style=color:#0087ff>func</span> <span style=color:#0087ff>TestNewPersonNegativeAge</span>(t *testing.T) {
	p, err := <span style=color:#0087ff>NewPerson</span>(-<span style=color:#00afaf>1</span>)
	<span style=color:#5f8700>if</span> err == <span style=color:#d75f00>nil</span> {
		t.<span style=color:#0087ff>Errorf</span>(<span style=color:#00afaf>&#34;Expected error, received %v&#34;</span>, p)
	}
}</code></pre></td></tr></table></div></div><p>Let&rsquo;s add two more tests for the <code>older</code> function. We will create two <code>*Person</code>
with different ages and check for the return value of the <code>older</code> function:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#0087ff>func</span> <span style=color:#0087ff>TestOlderFirstOlderThanSecond</span>(t *testing.T) {
	p1, _ := <span style=color:#0087ff>NewPerson</span>(<span style=color:#00afaf>1</span>)
	p2, _ := <span style=color:#0087ff>NewPerson</span>(<span style=color:#00afaf>2</span>)

	<span style=color:#5f8700>if</span> p1.<span style=color:#0087ff>older</span>(p2) {
		t.<span style=color:#0087ff>Errorf</span>(<span style=color:#00afaf>&#34;Expected p1 with age %d to be younger than p2 with age %d&#34;</span>, p1.age, p2.age)
	}
}

<span style=color:#0087ff>func</span> <span style=color:#0087ff>TestOlderSecondOlderThanFirst</span>(t *testing.T) {
	p1, _ := <span style=color:#0087ff>NewPerson</span>(<span style=color:#00afaf>2</span>)
	p2, _ := <span style=color:#0087ff>NewPerson</span>(<span style=color:#00afaf>1</span>)

	<span style=color:#5f8700>if</span> !p1.<span style=color:#0087ff>older</span>(p2) {
		t.<span style=color:#0087ff>Errorf</span>(<span style=color:#00afaf>&#34;Expected p1 with age %d to be older than p2 with age %d&#34;</span>, p1.age, p2.age)
	}
}</code></pre></td></tr></table></div></div><p>(If you find the tests a bit confusing I apologise - tried hard to make them
more readable but it was hard. I guess that says something about the example.)</p><p>The first way to control tests running is by supplying the test files as
arguments to the <code>go test</code> command. For example, if we have a <code>person.go</code> and
<code>person_test.go</code> files, we need to run:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> person.go person_test.go
ok  	command-line-arguments	0.005s</code></pre></td></tr></table></div></div><p>The <code>go test</code> command prints only the final <code>ok</code>, because all the test cases
passed. If we would like to see a more detailed output, we can use the <code>-v</code>
flag:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> person.go person_test.go -v
=== RUN   TestNewPersonPositiveAge
--- PASS: TestNewPersonPositiveAge (0.00s)
=== RUN   TestNewPersonNegativeAge
--- PASS: TestNewPersonNegativeAge (0.00s)
=== RUN   TestOlderFirstOlderThanSecond
--- PASS: TestOlderFirstOlderThanSecond (0.00s)
=== RUN   TestOlderSecondOlderThanFirst
--- PASS: TestOlderSecondOlderThanFirst (0.00s)
PASS
ok  	command-line-arguments	0.005s</code></pre></td></tr></table></div></div><p>The second way to run the test for the <code>person</code> package is to supply its name
to the <code>go test</code> command:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> person
ok  	person	0.004s</code></pre></td></tr></table></div></div><p>This way, the <code>go test</code> locates the package, builds it and runs its tests.
(Adding the <code>-v</code> flag will produce the same output as before.)</p><p>The third way to run tests is by specifying a test function to be run, using
the <code>-run</code> flag. The flag takes an argument, which is a regex that will try to
match against any test functions in the current directory. For example, if we
would like to run the <code>TestNewPersonPositiveAge</code> and <code>TestNewPersonNegativeAge</code>
function, we can do this:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -run TestNewPerson -v
=== RUN   TestNewPersonPositiveAge
--- PASS: TestNewPersonPositiveAge (0.00s)
=== RUN   TestNewPersonNegativeAge
--- PASS: TestNewPersonNegativeAge (0.00s)
PASS
ok  	person	0.004s</code></pre></td></tr></table></div></div><p>If we mistakenly supply a regexp that will not match anything, <code>go test</code> will
inform us about it:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -run TestFoo -v
testing: warning: no tests to run
PASS
ok  	person	0.004s</code></pre></td></tr></table></div></div><h2 id=failing-fast>Failing Fast<a hidden class=anchor aria-hidden=true href=#failing-fast>#</a></h2><p>Often when running tests we want to lower the waiting time and stop at the
first test failure we hit. The default mode is to wait for all tests to finish
before the errors are reported, so depending on the project this can save us
some time.</p><p>To do this, <code>go test</code> has a special flag we can use: <code>-failfast</code>. Fail fast
does what it advertises: it will stop at the first test that fails, exiting the
process that is running the test suite/files. To see it in action, we will
break one of the test functions for the <code>older</code> function that we introduced
earlier:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#4e4e4e>// Removing everything else for brewity...
</span><span style=color:#4e4e4e></span>
<span style=color:#0087ff>func</span> <span style=color:#0087ff>TestOlderFirstOlderThanSecond</span>(t *testing.T) {
	p1, _ := <span style=color:#0087ff>NewPerson</span>(<span style=color:#00afaf>100</span>)
	p2, _ := <span style=color:#0087ff>NewPerson</span>(<span style=color:#00afaf>2</span>)

	<span style=color:#5f8700>if</span> p1.<span style=color:#0087ff>older</span>(p2) {
		t.<span style=color:#0087ff>Errorf</span>(<span style=color:#00afaf>&#34;Expected p1 with age %d to be younger than p2 with age %d&#34;</span>, p1.age, p2.age)
	}
}</code></pre></td></tr></table></div></div><p>We know this test will fail: <code>p1</code> will be older than <code>p2</code>, because they are
<code>100</code> and <code>2</code> years old respectively. If we run <code>go test</code> it will run all the
test functions, regardless if some fail:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -v
=== RUN   TestNewPersonPositiveAge
--- PASS: TestNewPersonPositiveAge (0.00s)
=== RUN   TestNewPersonNegativeAge
--- PASS: TestNewPersonNegativeAge (0.00s)
=== RUN   TestOlderFirstOlderThanSecond
--- FAIL: TestOlderFirstOlderThanSecond (0.00s)
    person_test.go:26: Expected p1 with age <span style=color:#00afaf>100</span> to be younger than p2 with age <span style=color:#0087ff>2</span>
=== RUN   TestOlderSecondOlderThanFirst
--- PASS: TestOlderSecondOlderThanFirst (0.00s)
FAIL
<span style=color:#0087ff>exit</span> status <span style=color:#00afaf>1</span>
FAIL	person	0.004s</code></pre></td></tr></table></div></div><p>Now, let&rsquo;s see the difference if we add the <code>-failfast</code> flag:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -v -failfast
=== RUN   TestNewPersonPositiveAge
--- PASS: TestNewPersonPositiveAge (0.00s)
=== RUN   TestNewPersonNegativeAge
--- PASS: TestNewPersonNegativeAge (0.00s)
=== RUN   TestOlderFirstOlderThanSecond
--- FAIL: TestOlderFirstOlderThanSecond (0.00s)
    person_test.go:26: Expected p1 with age <span style=color:#00afaf>100</span> to be younger than p2 with age <span style=color:#00afaf>2</span>
FAIL
<span style=color:#0087ff>exit</span> status <span style=color:#00afaf>1</span>
FAIL	person	0.004s</code></pre></td></tr></table></div></div><p>By adding the <code>-failfast</code> flag we actually stopped right where we got the first
failure - when running the <code>TestOlderFirstOlderThanSecond</code> test function. This
option is useful when we do some heavier refactorings of our code. If our
refactor breaks some tests, instead of being overwhelmed by all the errors we
can add the <code>-failfast</code> flag and fix errors one by one.</p><p>Next time you do some big refactors give it a shot, it might save you some
sanity as you&rsquo;re fixing the tests.</p><figure class=imagecaption><img class=caption src=/testing-in-go-go-test/pie_chart.png caption alt="Person next to a pie chart">
<span class=caption-text style="font-size:.75em;display:table;margin:0 auto 1.5em"></span></figure><h2 id=coverage>Coverage<a hidden class=anchor aria-hidden=true href=#coverage>#</a></h2><p>Another interesting feature that is packed in <code>go test</code> is test coverage. Taken
from Go&rsquo;s website from the <a href=https://blog.golang.org/cover>blog post on
coverage</a>:</p><blockquote><p>Test coverage is a term that describes how much of a package&rsquo;s code is
exercised by running the package&rsquo;s tests. If executing the test suite causes
80% of the package&rsquo;s source statements to be run, we say that the test
coverage is 80%.</p></blockquote><p>We will not go in detail here on how the coverage tools work. I recommend
referring to the &ldquo;Test coverage for Go&rdquo; section in the aforementioned post to
understand how it actually measures the coverage.</p><p>If we would like to check the test coverage on our <code>Person</code> type and its
functions, we can run <code>go test -cover</code>:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -cover
PASS
coverage: 100.0% of statements
ok  	person	0.004s</code></pre></td></tr></table></div></div><p>This is great - it means that our tests cover all the functionality of our
functions. To see the coverage tool in action, we can add some more
functionality to the <code>NewPerson</code> constructor function. Creating a person that
is 1000 years old doesn&rsquo;t make much sense, especially
<a href=https://en.wikipedia.org/wiki/List_of_the_verified_oldest_people>knowing</a>
that the older person ever recorded was 122 years old. We can extend the
constructor to validate that the newly created <code>Person</code> instance cannot be
older than 130 years:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">25
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#d75f00>package</span> person

<span style=color:#d75f00>import</span> <span style=color:#00afaf>&#34;errors&#34;</span>

<span style=color:#0087ff>type</span> Person <span style=color:#0087ff>struct</span> {
	age <span style=color:#af0000>int</span>
}

<span style=color:#0087ff>func</span> <span style=color:#0087ff>NewPerson</span>(age <span style=color:#af0000>int</span>) (*Person, <span style=color:#af0000>error</span>) {
	<span style=color:#5f8700>if</span> age &lt; <span style=color:#00afaf>1</span> {
		<span style=color:#5f8700>return</span> <span style=color:#d75f00>nil</span>, errors.<span style=color:#0087ff>New</span>(<span style=color:#00afaf>&#34;A person is at least 1 years old&#34;</span>)
	}

	<span style=color:#5f8700>if</span> age &gt;= <span style=color:#00afaf>130</span> {
		<span style=color:#5f8700>return</span> <span style=color:#d75f00>nil</span>, errors.<span style=color:#0087ff>New</span>(<span style=color:#00afaf>&#34;A person cannot be older than 130 years&#34;</span>)
	}

	<span style=color:#5f8700>return</span> &amp;Person{
		age: age,
	}, <span style=color:#d75f00>nil</span>
}

<span style=color:#0087ff>func</span> (p *Person) <span style=color:#0087ff>older</span>(other *Person) <span style=color:#af0000>bool</span> {
	<span style=color:#5f8700>return</span> p.age &gt; other.age
}</code></pre></td></tr></table></div></div><p>If we would run the coverage report again, we will see the following output:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -cover -v
=== RUN   TestNewPersonPositiveAge
--- PASS: TestNewPersonPositiveAge (0.00s)
=== RUN   TestNewPersonNegativeAge
--- PASS: TestNewPersonNegativeAge (0.00s)
=== RUN   TestOlderFirstOlderThanSecond
--- PASS: TestOlderFirstOlderThanSecond (0.00s)
=== RUN   TestOlderSecondOlderThanFirst
--- PASS: TestOlderSecondOlderThanFirst (0.00s)
PASS
coverage: 83.3% of statements
ok  	person	0.004s</code></pre></td></tr></table></div></div><p>Whoops, our coverage dropped from 100% to 83.3%. To see where our problem is,
we can ask <code>go test</code> to create a coverage profile for us, using the
<code>-coverprofile</code> flag:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -coverprofile=prof.out
PASS
coverage: 83.3% of statements
ok  	person	0.004s</code></pre></td></tr></table></div></div><p>This will create a <code>prof.out</code> file, looking like this:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ cat prof.out
mode: <span style=color:#0087ff>set</span>
person/person.go:9.42,10.13 <span style=color:#00afaf>1</span> <span style=color:#00afaf>1</span>
person/person.go:14.2,14.16 <span style=color:#00afaf>1</span> <span style=color:#00afaf>1</span>
person/person.go:18.2,20.3 <span style=color:#00afaf>1</span> <span style=color:#00afaf>1</span>
person/person.go:10.13,12.3 <span style=color:#00afaf>1</span> <span style=color:#00afaf>1</span>
person/person.go:14.16,16.3 <span style=color:#00afaf>1</span> <span style=color:#00afaf>0</span>
person/person.go:23.44,25.2 <span style=color:#00afaf>1</span> <span style=color:#00afaf>1</span></code></pre></td></tr></table></div></div><p>We don&rsquo;t have to understand the output here, because Go has another tool that
we can use with the profile file to visualise the coverage report better: its
name is <code>go tool cover</code>. Using the <code>prof.out</code> profile file we have, we can
generate an HTML page that will visualise what parts of the code are covered by
tests:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go tool cover -html=prof.out</code></pre></td></tr></table></div></div><p>This command pops open our browser with a page looking like this:</p><figure class=imagecaption><img class=caption src=/testing-in-go-go-test/coverage-report.png caption alt>
<span class=caption-text style="font-size:.75em;display:table;margin:0 auto 1.5em"></span></figure><p>Looking at the image above, the red coloured code is the one that is never run.
In other words, the red code is not covered, while the green one is. The grey
code is not tracked, because from the coverage tool perspective it&rsquo;s
boilerplate (read: not needed to be tested).</p><p>From the image, it&rsquo;s clear that our tests never run the new branch where we
handle unreasonably old age as the argument. Let&rsquo;s add another quick test function
that will cover this functionality:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#4e4e4e>// person_test.go
</span><span style=color:#4e4e4e></span><span style=color:#0087ff>func</span> <span style=color:#0087ff>TestNewPersonHugeAge</span>(t *testing.T) {
	p, err := <span style=color:#0087ff>NewPerson</span>(<span style=color:#00afaf>150</span>)
	<span style=color:#5f8700>if</span> err == <span style=color:#d75f00>nil</span> {
		t.<span style=color:#0087ff>Errorf</span>(<span style=color:#00afaf>&#34;Expected error, received %v&#34;</span>, p)
	}
}</code></pre></td></tr></table></div></div><p>After running <code>go test -coverprofile=hundred.out -v</code> we will see the coverage
go back to 100% again:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -coverprofile=hundred.out -v
=== RUN   TestNewPersonPositiveAge
--- PASS: TestNewPersonPositiveAge (0.00s)
=== RUN   TestNewPersonNegativeAge
--- PASS: TestNewPersonNegativeAge (0.00s)
=== RUN   TestNewPersonHugeAge
--- PASS: TestNewPersonHugeAge (0.00s)
=== RUN   TestOlderFirstOlderThanSecond
--- PASS: TestOlderFirstOlderThanSecond (0.00s)
=== RUN   TestOlderSecondOlderThanFirst
--- PASS: TestOlderSecondOlderThanFirst (0.00s)
PASS
coverage: 100.0% of statements
ok  	person	0.004s</code></pre></td></tr></table></div></div><p>Here&rsquo;s the HTML output of the coverage profile:</p><figure class=imagecaption><img class=caption src=/testing-in-go-go-test/coverage-report-100.png caption alt>
<span class=caption-text style="font-size:.75em;display:table;margin:0 auto 1.5em"></span></figure><p>The <code>go test</code> and <code>go tool cover</code> tools packs more combined functionality. I
encourage you to read more about it in <a href=https://blog.golang.org/cover>the official blog
post</a> and to expriment further with the tools.</p><h2 id=running-modes-1>Running modes<a hidden class=anchor aria-hidden=true href=#running-modes-1>#</a></h2><p>Software is built to serve highly mutable business requirements, which results
in applications that grow and evolve over time. Such applications are
(hopefully) well tested, with tests operating on unit, integration and
end-to-end levels.</p><p>A common technique on bigger projects often is to be explicit what type of
tests we want to run. For example, when running <code>go test</code>, do we want to
include running the integration tests of the project, or just the unit tests?
In such cases, there are two useful techniques that come out of the box with
Go: build tags and short mode.</p><h3 id=using--short-mode>Using <code>-short</code> mode<a hidden class=anchor aria-hidden=true href=#using--short-mode>#</a></h3><p>The <code>-short</code> mode for <code>go test</code> allows us to mark any long-running tests to be
skipped in this mode. <code>go test</code> and the <code>testing</code> package support this via the
<code>t.Skip()</code>, the <code>testing.Short()</code> functions and the <code>-short</code> flag.</p><p>We can skip a test function by checking if the short mode is on and invoking
the <code>t.Skip</code> function if that returns <code>true</code>. Let&rsquo;s see this by changing an
earlier example:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#0087ff>func</span> <span style=color:#0087ff>TestOlderFirstOlderThanSecond</span>(t *testing.T) {
	<span style=color:#5f8700>if</span> testing.<span style=color:#0087ff>Short</span>() {
		t.<span style=color:#0087ff>Skip</span>(<span style=color:#00afaf>&#34;Skipping long-running test.&#34;</span>)
	}
	p1, _ := <span style=color:#0087ff>NewPerson</span>(<span style=color:#00afaf>1</span>)
	p2, _ := <span style=color:#0087ff>NewPerson</span>(<span style=color:#00afaf>2</span>)

	<span style=color:#5f8700>if</span> p1.<span style=color:#0087ff>older</span>(p2) {
		t.<span style=color:#0087ff>Errorf</span>(<span style=color:#00afaf>&#34;Expected p1 with age %d to be younger than p2 with age %d&#34;</span>, p1.age, p2.age)
	}
}</code></pre></td></tr></table></div></div><p>If we run the tests normally, using <code>go test -v</code> we should see no change in the
output:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -v
=== RUN   TestNewPersonPositiveAge
--- PASS: TestNewPersonPositiveAge (0.00s)
=== RUN   TestNewPersonNegativeAge
--- PASS: TestNewPersonNegativeAge (0.00s)
=== RUN   TestNewPersonHugeAge
--- PASS: TestNewPersonHugeAge (0.00s)
=== RUN   TestOlderFirstOlderThanSecond
--- PASS: TestOlderFirstOlderThanSecond (0.00s)
=== RUN   TestOlderSecondOlderThanFirst
--- PASS: TestOlderSecondOlderThanFirst (0.00s)
PASS
ok  	person	0.004s</code></pre></td></tr></table></div></div><p>If we would enable the short mode using the <code>-short</code> flag, we should see the
change in the behaviour and output:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -short -v
=== RUN   TestNewPersonPositiveAge
--- PASS: TestNewPersonPositiveAge (0.00s)
=== RUN   TestNewPersonNegativeAge
--- PASS: TestNewPersonNegativeAge (0.00s)
=== RUN   TestNewPersonHugeAge
--- PASS: TestNewPersonHugeAge (0.00s)
=== RUN   TestOlderFirstOlderThanSecond
--- SKIP: TestOlderFirstOlderThanSecond (0.00s)
    person_test.go:30: Skipping long-running test.
=== RUN   TestOlderSecondOlderThanFirst
--- PASS: TestOlderSecondOlderThanFirst (0.00s)
PASS
ok  	person	0.005s</code></pre></td></tr></table></div></div><p>We can see that the output contains one <code>SKIP</code> line, meaning in short mode <code>go test</code> skipped the test function. We can use <code>-short</code> in other ways, besides
skipping a test. For example, mocking networks calls instead of opening a
connection or loading simple fixtures instead of loading them from a database.
The options are many, it all depends on the function that the test is covering.</p><figure class=imagecaption><img class=caption src=/testing-in-go-go-test/building_blocks.png caption alt="Person building a brick wall">
<span class=caption-text style="font-size:.75em;display:table;margin:0 auto 1.5em"></span></figure><h3 id=using-build-tags>Using build tags<a hidden class=anchor aria-hidden=true href=#using-build-tags>#</a></h3><p><code>go test</code> supports build tags out of the box, like the <code>-short</code> flag. While we
apply the short mode on the function level, we use the build tags on a file
level. This means that there is no way to use build tags to skip one or a few
functions. Rather, build tags are used to run (or skip) a special type of test
files from our test suite.</p><p>There are a couple of rules on build tags. As indicated in
<a href=https://stackoverflow.com/a/28007631/601555>this</a> Stack Overflow answer:</p><ul><li>build tags are special comments, with the format <code>// +build TAGNAME</code></li><li>we have to place the tag on the first line of the file</li><li>we have to add an empty line after the tag</li><li>the tag name comment cannot have a dash, but it allows underscores</li></ul><p>Following these rules, we can add a tag to our <code>person_test.go</code> file from
earlier:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#4e4e4e>// +build person_tests
</span><span style=color:#4e4e4e></span>
<span style=color:#d75f00>package</span> person

<span style=color:#d75f00>import</span> (
	<span style=color:#00afaf>&#34;testing&#34;</span>
)

<span style=color:#4e4e4e>// Snipped...
</span></code></pre></td></tr></table></div></div><p>(The <code>person_tests</code> tag is a useless when we have only one file in the test
suite, but we will add it for experimentational purposes.)</p><p>To add the build tag to our <code>go test</code> command, we need to run <code>go test -tags=TAG_NAME</code>. To run the files with the <code>person_tests</code> build tag:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -tags=person_tests -v
=== RUN   TestNewPersonPositiveAge
--- PASS: TestNewPersonPositiveAge (0.00s)
=== RUN   TestNewPersonNegativeAge
--- PASS: TestNewPersonNegativeAge (0.00s)
=== RUN   TestNewPersonHugeAge
--- PASS: TestNewPersonHugeAge (0.00s)
=== RUN   TestOlderFirstOlderThanSecond
--- PASS: TestOlderFirstOlderThanSecond (0.00s)
=== RUN   TestOlderSecondOlderThanFirst
--- PASS: TestOlderSecondOlderThanFirst (0.00s)
PASS
ok  	person	0.005s</code></pre></td></tr></table></div></div><p>Based on the supplied tag, <code>go test</code> detects the files tagged with
<code>person_tests</code> and runs them. If we would supply a tag that does not exist in
the package, the output would report that no files are found:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -tags=foo -v
?   	person	[no <span style=color:#0087ff>test</span> files]</code></pre></td></tr></table></div></div><h2 id=notable-mentions>Notable mentions<a hidden class=anchor aria-hidden=true href=#notable-mentions>#</a></h2><p>Covering all the features that <code>go test</code> packs in a single post is a hard
undertaking. Here I will mention some other useful features that you should try
to use and read more on:</p><ul><li>List tests with <code>-list</code>: to list tests, benchmarks, or examples matching a
regular expression passed as the argument. The usage of the <code>-list</code> flags is
analogous to the <code>-run</code> flag that we discussed before. When we use this flag
<code>go test</code> will not run any tests, benchmarks or examples.</li><li>Disabling caching with <code>-count</code>: as we discussed before, <code>go test</code> by default
caches test results for packages. It then uses them to skip running tests
that have are not modified between two runs. Although can improve the
performance, there are times when we would like to disable the caching using
the <code>-count=1</code> flag.</li><li>Get JSON output using <code>-json</code>: if we would like to take the output of <code>go test</code> and process it using a program, having it in a JSON format is better
than normal text. This flag will convert the output to JSON, so processing it
with a program is less cumbersome.</li><li>Use more CPU cores using <code>-cpu</code>: this flag will set the <code>GOMAXPROCS</code> variable
to the argument that we pass to the flag. It limits the number of operating
system threads that can execute user-level Go code simultaneously.</li><li>Detect race conditions using <code>-race</code>: since it&rsquo;s very easy to write
concurrent code in Go, race conditions are always a risk. Go&rsquo;s tooling is
great in this regard - it has a fully integrated race conditions detector in
its toolchain. You can read more about it in <a href=https://blog.golang.org/race-detector>its announcement blog
post</a>.</li></ul><section class=subscribe><b>Liked this article?</b>
You can <a href=https://www.buymeacoffee.com/ieftimov>buy me a coffee</a>.
Or simply <a href=/newsletter>subscribe to my
newsletter</a> and get my fresh posts in your inbox. It's short and sweet,
going out monthly to over 1,000 subscribers.</section></div><footer class=post-footer><nav class=paginav><a class=prev href=https://ieftimov.com/post/testing-in-go-table-driven-tests/><span class=title>« Prev Page</span><br><span>Testing in Go: Table-Driven Tests</span></a>
<a class=next href=https://ieftimov.com/post/testing-in-go-naming-conventions/><span class=title>Next Page »</span><br><span>Testing in Go: Naming Conventions</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Testing in Go: go test on twitter" href="https://twitter.com/intent/tweet/?text=Testing%20in%20Go%3a%20go%20test&url=https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-go-test%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Testing in Go: go test on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-go-test%2f&title=Testing%20in%20Go%3a%20go%20test&summary=Testing%20in%20Go%3a%20go%20test&source=https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-go-test%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Testing in Go: go test on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-go-test%2f&title=Testing%20in%20Go%3a%20go%20test"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Testing in Go: go test on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-go-test%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Testing in Go: go test on whatsapp" href="https://api.whatsapp.com/send?text=Testing%20in%20Go%3a%20go%20test%20-%20https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-go-test%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Testing in Go: go test on telegram" href="https://telegram.me/share/url?text=Testing%20in%20Go%3a%20go%20test&url=https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-go-test%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>Copyright 2021 © Ilija Eftimov</span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>