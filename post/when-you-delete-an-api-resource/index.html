<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>What happens when you DELETE a resource? | Ilija Eftimov ⚡️</title><meta name=keywords content="HTTP,APIs"><meta name=description content="Have you ever found yourself publishing an API, either an internal or a public one? Have your ever heard from the consumers of those same APIs back? Are they happy about the functionality of your APIs and their design? You already know, there is no perfect design, but API design has to be taken very seriously. Why? Because evolving and changing APIS is hard and time consuming.
Imagine you are on a team in a company, that has set off to design a company-wide API guideline and a blueprint."><meta name=author content="Ilija"><link rel=canonical href=https://ieftimov.com/post/when-you-delete-an-api-resource/><link crossorigin=anonymous href=/assets/css/stylesheet.min.css rel="preload stylesheet" as=style><link rel=icon href=https://ieftimov.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ieftimov.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ieftimov.com/favicon-32x32.png><link rel=apple-touch-icon href=https://ieftimov.com/apple-touch-icon.png><link rel=mask-icon href=https://ieftimov.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><script async defer data-domain=ieftimov.com src=https://plausible.io/js/plausible.js></script><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel=stylesheet><meta property="og:title" content="What happens when you DELETE a resource?"><meta property="og:description" content="Have you ever found yourself publishing an API, either an internal or a public one? Have your ever heard from the consumers of those same APIs back? Are they happy about the functionality of your APIs and their design? You already know, there is no perfect design, but API design has to be taken very seriously. Why? Because evolving and changing APIS is hard and time consuming.
Imagine you are on a team in a company, that has set off to design a company-wide API guideline and a blueprint."><meta property="og:type" content="article"><meta property="og:url" content="https://ieftimov.com/post/when-you-delete-an-api-resource/"><meta property="og:image" content="https://ieftimov.com/cards/when-you-delete-an-api-resource.png"><meta property="article:section" content="posts"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ieftimov.com/cards/when-you-delete-an-api-resource.png"><meta name=twitter:title content="What happens when you DELETE a resource?"><meta name=twitter:description content="Have you ever found yourself publishing an API, either an internal or a public one? Have your ever heard from the consumers of those same APIs back? Are they happy about the functionality of your APIs and their design? You already know, there is no perfect design, but API design has to be taken very seriously. Why? Because evolving and changing APIS is hard and time consuming.
Imagine you are on a team in a company, that has set off to design a company-wide API guideline and a blueprint."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ieftimov.com/posts/"},{"@type":"ListItem","position":2,"name":"What happens when you DELETE a resource?","item":"https://ieftimov.com/post/when-you-delete-an-api-resource/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"What happens when you DELETE a resource?","name":"What happens when you DELETE a resource?","description":"Have you ever found yourself publishing an API, either an internal or a public one? Have your ever heard from the consumers of those same APIs back? Are they happy about the functionality of your APIs and their design? You already know, there is no perfect design, but API design has to be taken very seriously. Why? Because evolving and changing APIS is hard and time consuming.\nImagine you are on a team in a company, that has set off to design a company-wide API guideline and a blueprint.","keywords":["HTTP","APIs"],"articleBody":"Have you ever found yourself publishing an API, either an internal or a public one? Have your ever heard from the consumers of those same APIs back? Are they happy about the functionality of your APIs and their design? You already know, there is no perfect design, but API design has to be taken very seriously. Why? Because evolving and changing APIS is hard and time consuming.\nImagine you are on a team in a company, that has set off to design a company-wide API guideline and a blueprint. As you could imagine, a feat like this one takes time - first you have to put in a draft, then let it settle like a fine French wine, then review it and apply any needed changes. And repeat over, until you have a team wide consensus on the design.\nIn situations like this, I have found interesting how your API should behave when a resource is DELETEd? Of course, aside from the obvious, that the record will be deleted.\nLet’s look at couple of points that might be a good food for thought in these occasions.\nIdempotency We have all heard about idempotency and we have heard that all calls to a REST API should be idempotent, except the POST requests. But, what does this mean?\nCrickets sound onFrom Wikipedia:\n Idempotence is the property of certain operations in mathematics and computer science, that can be applied multiple times without changing the result beyond the initial application.\n Crickets sound offSimply put, a call to an idempotent endpoint with a given set of parmeters, should always have the same effect. For example, if you have a User resource, everytime you call PUT /users/1 should have the same effect on the resource. Also, a GET /users/1 is a safe method (or nullipotent), because it does not have any effect on the state of the resource.\nBut, is DELETE idempotent? According to the HTTP specification DELETE should be idempotent.\n+---------+------+------------+ | Method | Safe | Idempotent | +---------+------+------------+ | CONNECT | no | no | | DELETE | no | yes | | GET | yes | yes | | HEAD | yes | yes | | OPTIONS | yes | yes | | POST | no | no | | PUT | no | yes | | TRACE | yes | yes | +---------+------+------------+ This means that whenever a DELETE request is sent, the state of the system after fulfilling the request will always be the same, although the server might implement non-idempotent effects under the hood.\nSo, knowing that a DELETE request will always be idempotent, what should a response of that request be? Let’s start from the basics, the status code.\nHTTP status codes We usually take HTTP status codes as an ever-present thing slapped onto a HTTP request. Especially if you are a beginner, understanding how useful status codes are and how much context they can provide for free, can be hard.\nAfter executing any HTTP request, the HTTP code that will be returned is always contextual, which means, it should be based on the effect (and hence the result) of the request. Keeping in mind that a DELETE request is idempotent, what would be an appropriate status code?\nLet’s look at some status codes that make sense as a response for a DELETE request:\nHTTP 204 - No content:\n The server has successfully fulfilled the request and that there is no additional content to send in the response payload body.\n HTTP 204 would work - the server has accepted your DELETE request and it has fulfilled it. The server will not return a payload in the response, hence 204 No content.\nHTTP 202 - Accepted:\n The request has been accepted for processing, but the processing has not been completed. The request might or might not eventually be acted upon, as it might be disallowed when processing actually takes place.\n You tell the server to destroy the resource that the URI points to, but since it’s a long procedure (maybe a background job) to delete the resource, it returns a HTTP 202 Accepted. This means that the server basically says “Cool, I understand, I am on it!”. But, it does not mean that the resource is deleted as part of the request/response cycle.\nHTTP 200 OK:\n The request has succeeded.\n The server received your request and responds with 200 OK - which means that it understood your request and deletes the resource described by the URI.\nYou can notice that all of the status codes are closely tied to the response that the API call will return. So, let’s talk about the HTTP status codes in combination with some response payloads.\nSending a meaningful response You send a DELETE and the server complies. It executes the logic related to the endpoint and the HTTP verb and deletes the record that you wanted gone. So, how does it respond back?\nFirst scenario would be - no response body with HTTP 204. Makes sense. But what would this actually mean? Well let’s say you have a Rails API that returns hypermedia controls in the JSON API spec format. When it returns a resource it will also return the URIs of the associated resources. When you delete a record, it will perish from the database - but if you have a dependent: :destroy in your model, it would remove associated records as well. In this occasion, your client would not know if anything else got removed in the same request-response lifecycle.\nAnother option would be a HTTP 200 OK - but as we saw earlier, 200 OK states that you must return a body in the response. In the HTTP spec, we can see the following:\n The 200 (OK) status code indicates that the request has succeeded. The payload sent in a 200 response depends on the request method. For the methods defined by this specification, the intended meaning of the payload can be summarized as:\n PUT, DELETE a representation of the status of the action   This means that, according to the HTTP spec the response body has to be a representation of the status of the action. In other words, it needs to send back the representation of the resource that has been deleted as a result of the request. But, if we do that, we will add an additional load on the endpoint, because it will need to serialize the deleted resource, and as we all know serialization is expensive.\nA third option would be HTTP 204 - Accepted. But as we saw earlier, Accepted as a status code is very contextual on the action under the hood. It can only be returned if the request has been accepted, but the action has not been put into effect yet.\nWhoa, okay, so where now?\nAre we overthinking it? Just like in most of the cases where computer science and engineering is involved - it depends. You could say that it’s easy to keep all of this simple, but often we have to be careful. After all, we don’t want to be lazy and oversimplify our APIs.\nLet’s take a tiny example - an API for a blog CMS. We will look at a resource, namely the /authors resource. This means that, we will have the following endpoints available:\nGET /authors # returns a collection of authors GET /authors/:id # returns an author with the ID of :id POST /authors # create an author PUT /authors/:id # create/update an author DELETE /authors/:id # destroy an author So, we are interested in the behaviour of the last endpoint, DELETE /authors/:id. When a request is succesfully fulfilled on this endpoint, the record which was identified by the :id param is destroyed. Since the request is idempotent, it means that you can freely request to delete a resource multiple times, but the effect on the system will be the same - the resource will not be present.\nIn most of the cases, the REST APIs that we use are level 3. This means that usually we have couple of options on how to respond to this request, HTTP 204, or HTTP 200, which we already discussed at the begining of this article. But, what happens if you are building a level 4 REST API?\nHandling the state in the client If you have a hypermedia API, things can get a little bit more complex. For those of you that don’t know what hypermedia APIs, I recommend reading my previous article about REST APIs - “Sprinkle some HATEOAS on your Rails APIs”. It covers all of Fielding’s REST levels and explains them thoroughly. After you get a grasp of hypermedia APIs, you can come back to this to more easily understand the issue at hand.\nHypermedia clients usually have to be a little bit smarter, due to the fact that the APIs they use are smarter. This means that when we update the state of the hypermedia API’s system, the client should be aware of the state change. In more concrete wording - when we delete a resource, the client must know that the resource does not exist anymore on the server side.\nWhat does that mean for our API? Well, remember the DELETE /authors/:id endpoint? If a request to that endpoint returns an HTTP 204 (which explicitly states that the reponse body is empty), then our clients need to know that the nested resources might be deleted because there might bea cascading delete.\nFor example, if the DELETE /authors/:id request also removes all of the posts that were written by an author, the client might still think that the posts are available. This means that the client will allow a request to GET /authors/:id/posts/, and the API needs to know to respond with an appropriate response and HTTP status. But, will any of the aforementioned statuses cut it in this case? You might think that even HTTP 404 would do it, but is it semantically correct?\nSure, HTTP 404 states that the resource is not found, but in cases like this we actually want to inform the consumer that there was something there before, but not anymore. This means that the best HTTP status code in these cases is HTTP 410:\n HTTP 410 GONE The target resource is no longer available at the origin server and that this condition is likely to be permanent.\n HTTP 410 will inform the consumer and the client that there was something there before, but now it’s gone (hence the status code). This will be semantically much more correct, but it will add implementation implications to the API itself. It means that the API will have to know that a resource has existed in a certain place. This means that records might have to be flagged as deleted, but not actually deleted and so on.\nAs you can see, the complexity that hypermedia APIs add to the client can be big, and both the client and the API have to be very smartly built to allow proper usage and leverage of hypermedia.\nIn closing As we some in our tiny examples, although things can most often look trivial, if we want to have semantically correct APIs, we need to be very careful of every aspect of our API. HTTP statuses, although oftern perceived as trivial, if applied correctly add a lot of power to our APIs and the clients.\nLiked this article? Subscribe to my newsletter and get future articles in your inbox. It's a short and sweet read, going out to +1000 of other engineers.\n    ","wordCount":"1926","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Ilija"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ieftimov.com/post/when-you-delete-an-api-resource/"},"publisher":{"@type":"Organization","name":"Ilija Eftimov ⚡️","logo":{"@type":"ImageObject","url":"https://ieftimov.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://ieftimov.com/ accesskey=h title="Ilija Eftimov ⚡️ (Alt + H)">Ilija Eftimov ⚡️</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://ieftimov.com/ title=About><span>About</span></a></li><li><a href=https://ieftimov.com/posts title=Writing><span>Writing</span></a></li><li><a href=https://ieftimov.com/newsletter title=Newsletter><span>Newsletter</span></a></li><li><a href=https://forms.gle/orfXK5jh1LRaiFzo8 title="Suggest a topic"><span>Suggest a topic</span></a></li><li><a href=https://www.buymeacoffee.com/ieftimov title="Buy me a ☕"><span>Buy me a ☕</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>What happens when you DELETE a resource?</h1><div class=post-meta>October 29, 2016&nbsp;·&nbsp;10 min&nbsp;·&nbsp;Ilija</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#idempotency aria-label=Idempotency>Idempotency</a></li><li><a href=#http-status-codes aria-label="HTTP status codes">HTTP status codes</a></li><li><a href=#sending-a-meaningful-response aria-label="Sending a meaningful response">Sending a meaningful response</a></li><li><a href=#are-we-overthinking-it aria-label="Are we overthinking it?">Are we overthinking it?</a></li><li><a href=#handling-the-state-in-the-client aria-label="Handling the state in the client">Handling the state in the client</a></li><li><a href=#in-closing aria-label="In closing">In closing</a></li></ul></div></details></div><div class=post-content><p>Have you ever found yourself publishing an API, either an internal or a public
one? Have your ever heard from the consumers of those same APIs back? Are they
happy about the functionality of your APIs and their design? You already know,
there is no perfect design, but API design has to be taken very seriously. Why?
Because evolving and changing APIS is <strong>hard and time consuming</strong>.</p><p>Imagine you are on a team in a company, that has set off to design a
company-wide API guideline and a blueprint. As you could imagine, a feat like
this one takes time - first you have to put in a draft, then let it settle like
a fine French wine, then review it and apply any needed changes. And repeat
over, until you have a team wide consensus on the design.</p><p>In situations like this, I have found interesting how your API should behave
when a resource is <code>DELETE</code>d? Of course, aside from the obvious, that the
record will be deleted.</p><p>Let&rsquo;s look at couple of points that might be a good food for thought in these
occasions.</p><h2 id=idempotency>Idempotency<a hidden class=anchor aria-hidden=true href=#idempotency>#</a></h2><p>We have all heard about idempotency and we have heard that all calls to a REST
API should be idempotent, except the <code>POST</code> requests. But, what does this mean?</p><p><em>Crickets sound on</em></p><p>From Wikipedia:</p><blockquote><p>Idempotence is the property of certain operations in mathematics and computer
science, that can be applied multiple times without changing the result beyond
the initial application.</p></blockquote><p><em>Crickets sound off</em></p><p>Simply put, a call to an idempotent endpoint with a given set of parmeters,
should always have the same effect. For example, if you have a <code>User</code> resource,
everytime you call <code>PUT /users/1</code> should have the same effect on the resource.
Also, a <code>GET /users/1</code> is a safe method (or <em>nullipotent</em>), because it does not
have any effect on the state of the resource.</p><p><strong>But, is DELETE idempotent?</strong> According to the
<a href=https://tools.ietf.org/html/rfc7231#section-4.2.2>HTTP specification</a> <code>DELETE</code>
<em>should</em> be idempotent.</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>   +---------+------+------------+
   | Method  | Safe | Idempotent |
   +---------+------+------------+
   | CONNECT | no   | no         |
   | DELETE  | no   | yes        |
   | GET     | yes  | yes        |
   | HEAD    | yes  | yes        |
   | OPTIONS | yes  | yes        |
   | POST    | no   | no         |
   | PUT     | no   | yes        |
   | TRACE   | yes  | yes        |
   +---------+------+------------+</code></pre></div><p>This means that whenever a <code>DELETE</code> request is sent, the state of the system
after fulfilling the request will always be the same, although the server might
implement non-idempotent effects under the hood.</p><p>So, knowing that a <code>DELETE</code> request will always be idempotent, what should a
response of that request be? Let&rsquo;s start from the basics, the status code.</p><h2 id=http-status-codes>HTTP status codes<a hidden class=anchor aria-hidden=true href=#http-status-codes>#</a></h2><p>We usually take HTTP status codes as an ever-present thing slapped onto a HTTP
request. Especially if you are a beginner, understanding how useful status
codes are and how much context they can provide for free, can be hard.</p><p>After executing any HTTP request, the HTTP code that will be returned is always
contextual, which means, it should be based on the effect (and hence the
result) of the request. Keeping in mind that a <code>DELETE</code> request is idempotent,
what would be an appropriate status code?</p><p>Let&rsquo;s look at some status codes that make sense as a response for a <code>DELETE</code>
request:</p><p><a href=https://httpstatuses.com/204>HTTP 204</a> - No content:</p><blockquote><p>The server has successfully fulfilled the request and that there is no
additional content to send in the response payload body.</p></blockquote><p>HTTP 204 would work - the server has accepted your <code>DELETE</code> request and it has
fulfilled it. The server will not return a payload in the response, hence <code>204 No content</code>.</p><p><a href=https://httpstatuses.com/202>HTTP 202</a> - Accepted:</p><blockquote><p>The request has been accepted for processing, but the processing has not been
completed. The request might or might not eventually be acted upon, as it
might be disallowed when processing actually takes place.</p></blockquote><p>You tell the server to destroy the resource that the URI points to, but since
it&rsquo;s a long procedure (maybe a background job) to delete the resource, it
returns a <code>HTTP 202 Accepted</code>. This means that the server basically says &ldquo;Cool,
I understand, I am on it!&rdquo;. But, it does not mean that the resource is deleted
as part of the request/response cycle.</p><p><a href=https://httpstatuses.com/200>HTTP 200</a> OK:</p><blockquote><p>The request has succeeded.</p></blockquote><p>The server received your request and responds with <code>200 OK</code> - which means that
it understood your request and deletes the resource described by the URI.</p><p>You can notice that all of the status codes are closely tied to the response
that the API call will return. So, let&rsquo;s talk about the HTTP status codes in
combination with some response payloads.</p><h2 id=sending-a-meaningful-response>Sending a meaningful response<a hidden class=anchor aria-hidden=true href=#sending-a-meaningful-response>#</a></h2><p>You send a <code>DELETE</code> and the server complies. It executes the logic related to
the endpoint and the HTTP verb and deletes the record that you wanted gone. So,
how does it respond back?</p><p>First scenario would be - no response body with HTTP 204. Makes sense. But what
would this actually mean? Well let&rsquo;s say you have a Rails API that returns
hypermedia controls in the JSON API spec format. When it returns a resource it
will also return the URIs of the associated resources. When you delete a
record, it will perish from the database - but if you have a <code>dependent: :destroy</code> in your model, it would remove associated records as well. In this
occasion, your client would not know if anything else got removed in the same
request-response lifecycle.</p><p>Another option would be a HTTP 200 OK - but as we saw earlier, 200 OK states
that you must return a body in the response. In the HTTP spec, we can see the
following:</p><blockquote><p>The 200 (OK) status code indicates that the request has succeeded. The payload
sent in a 200 response depends on the request method. For the methods defined
by this specification, the intended meaning of the payload can be summarized as:</p><ul><li>PUT, DELETE a representation of the status of the action</li></ul></blockquote><p>This means that, according to the HTTP spec the response body has to be a
representation of the status of the action. In other words, it needs to send
back the representation of the resource that has been deleted as a result of
the request. But, if we do that, we will add an additional load on the
endpoint, because it will need to serialize the deleted resource, and as we all
know serialization is expensive.</p><p>A third option would be HTTP 204 - Accepted. But as we saw earlier, <code>Accepted</code>
as a status code is very contextual on the action under the hood. It can only
be returned if the request has been accepted, but the action has not been put
into effect yet.</p><p>Whoa, okay, so where now?</p><h2 id=are-we-overthinking-it>Are we overthinking it?<a hidden class=anchor aria-hidden=true href=#are-we-overthinking-it>#</a></h2><p>Just like in most of the cases where computer science and engineering is
involved - <strong>it depends</strong>. You could say that it&rsquo;s easy to keep all of this
simple, but often we have to be careful. After all, we don&rsquo;t want to be lazy
and oversimplify our APIs.</p><p>Let&rsquo;s take a tiny example - an API for a blog CMS. We will look at a resource,
namely the <code>/authors</code> resource. This means that, we will have the following
endpoints available:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>GET /authors        # returns a collection of authors
GET /authors/:id    # returns an author with the ID of :id
POST /authors       # create an author
PUT /authors/:id    # create/update an author
DELETE /authors/:id # destroy an author</code></pre></div><p>So, we are interested in the behaviour of the last endpoint, <code>DELETE /authors/:id</code>. When a request is succesfully fulfilled on this endpoint, the
record which was identified by the <code>:id</code> param is destroyed. Since the request
is idempotent, it means that you can freely request to delete a resource
multiple times, but the effect on the system will be the same - the resource
will not be present.</p><p>In most of the cases, the REST APIs that we use are <a href=http://ieftimov.com/sprinkle-some-hateoas-on-rails-apis#level-3>level
3</a>. This
means that usually we have couple of options on how to respond to this request,
HTTP 204, or HTTP 200, which we already discussed at the begining of this
article. But, what happens if you are building a <a href=http://ieftimov.com/sprinkle-some-hateoas-on-rails-apis#level-4>level
4</a> REST API?</p><h2 id=handling-the-state-in-the-client>Handling the state in the client<a hidden class=anchor aria-hidden=true href=#handling-the-state-in-the-client>#</a></h2><p>If you have a hypermedia API, things can get a little bit more complex. For
those of you that don&rsquo;t know what hypermedia APIs, I recommend reading my
previous article about REST APIs - &ldquo;<a href=http://ieftimov.com/sprinkle-some-hateoas-on-rails-apis>Sprinkle some HATEOAS on your Rails
APIs</a>&rdquo;. It covers all
of Fielding&rsquo;s REST levels and explains them thoroughly. After you get a grasp
of hypermedia APIs, you can come back to this to more easily understand the
issue at hand.</p><p>Hypermedia clients usually have to be a little bit smarter, due to the fact
that the APIs they use are smarter. This means that when we update the state of
the hypermedia API&rsquo;s system, the client should be aware of the state change. In
more concrete wording - when we delete a resource, the client must know that
the resource does not exist anymore on the server side.</p><p>What does that mean for our API? Well, remember the <code>DELETE /authors/:id</code>
endpoint? If a request to that endpoint returns an <code>HTTP 204</code> (which explicitly
states that the reponse body is empty), then our clients need to know that the
nested resources <em>might</em> be deleted because there might bea cascading delete.</p><p>For example, if the <code>DELETE /authors/:id</code> request also removes all of the posts
that were written by an author, the client might still think that the posts are
available. This means that the client will allow a request to <code>GET /authors/:id/posts/</code>, and the API needs to know to respond with an appropriate
response and HTTP status. But, will any of the aforementioned statuses cut it
in this case? You might think that even <code>HTTP 404</code> would do it, but is it
semantically correct?</p><p>Sure, <code>HTTP 404</code> states that the resource is not found, but in cases like this
we actually want to inform the consumer that there was something there before,
but not anymore. This means that the best HTTP status code in these cases is
<code>HTTP 410</code>:</p><blockquote><p>HTTP 410 GONE
The target resource is no longer available at the origin server and that this
condition is likely to be permanent.</p></blockquote><p>HTTP 410 will inform the consumer and the client that there was something there
before, but now it&rsquo;s gone (hence the status code). This will be semantically
much more correct, but it will add implementation implications to the API
itself. It means that the API will have to know that a resource has existed in
a certain place. This means that records might have to be flagged as deleted,
but not actually deleted and so on.</p><p>As you can see, the complexity that hypermedia APIs add to the client can be
big, and both the client and the API have to be very smartly built to allow
proper usage and leverage of hypermedia.</p><h2 id=in-closing>In closing<a hidden class=anchor aria-hidden=true href=#in-closing>#</a></h2><p>As we some in our tiny examples, although things can most often look trivial,
if we want to have semantically correct APIs, we need to be very careful of
every aspect of our API. HTTP statuses, although oftern perceived as trivial,
if applied correctly add a lot of power to our APIs and the clients.</p><div id=revue-embed><form action=https://www.getrevue.co/profile/itsilija/add_subscriber method=post id=revue-form name=revue-form target=_blank><p><b>Liked this article?</b>
Subscribe to my newsletter and get future articles in your inbox. It's a
short and sweet read, going out to +1000 of other engineers.</p><div class=revue-form-group><input class=revue-form-field placeholder="Your email address..." type=email name=member[email] id=member_email></div><div class=revue-form-actions><input type=submit value=Subscribe name=member[subscribe] id=member_submit></div></form></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://ieftimov.com/tags/http/>http</a></li><li><a href=https://ieftimov.com/tags/apis/>APIs</a></li></ul><nav class=paginav><a class=prev href=https://ieftimov.com/post/versioning-ruby-grape-apis/><span class=title>« Prev Page</span><br><span>Versioning REST APIs: The Theory and Using Grape in Ruby</span></a>
<a class=next href=https://ieftimov.com/post/sprinkle-some-hateoas-on-rails-apis/><span class=title>Next Page »</span><br><span>Sprinkle some HATEOAS on your Rails APIs</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share What happens when you DELETE a resource? on twitter" href="https://twitter.com/intent/tweet/?text=What%20happens%20when%20you%20DELETE%20a%20resource%3f&url=https%3a%2f%2fieftimov.com%2fpost%2fwhen-you-delete-an-api-resource%2f&hashtags=HTTP%2cAPIs"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share What happens when you DELETE a resource? on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fieftimov.com%2fpost%2fwhen-you-delete-an-api-resource%2f&title=What%20happens%20when%20you%20DELETE%20a%20resource%3f&summary=What%20happens%20when%20you%20DELETE%20a%20resource%3f&source=https%3a%2f%2fieftimov.com%2fpost%2fwhen-you-delete-an-api-resource%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share What happens when you DELETE a resource? on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fieftimov.com%2fpost%2fwhen-you-delete-an-api-resource%2f&title=What%20happens%20when%20you%20DELETE%20a%20resource%3f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share What happens when you DELETE a resource? on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fieftimov.com%2fpost%2fwhen-you-delete-an-api-resource%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share What happens when you DELETE a resource? on whatsapp" href="https://api.whatsapp.com/send?text=What%20happens%20when%20you%20DELETE%20a%20resource%3f%20-%20https%3a%2f%2fieftimov.com%2fpost%2fwhen-you-delete-an-api-resource%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share What happens when you DELETE a resource? on telegram" href="https://telegram.me/share/url?text=What%20happens%20when%20you%20DELETE%20a%20resource%3f&url=https%3a%2f%2fieftimov.com%2fpost%2fwhen-you-delete-an-api-resource%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>Copyright 2021 © Ilija Eftimov</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>