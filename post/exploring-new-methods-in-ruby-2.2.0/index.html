<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Exploring new methods in Ruby 2.2.0 - Ilija Eftimov</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="Exploring new methods in Ruby 2.2.0" />
<meta property="og:description" content="For those late to the Ruby 2.2.0 party like me, aside from the changes (and updates) the core team made under the hood for this version, they introduced couple of new methods to the Enumerable module and to the_ Method, Float, File_ and _String_ classes. Lets take a look at these methods and explore how we can use them in our everyday jobs. Just a heads up, make sure you **use Ruby 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ieftimov.com/post/exploring-new-methods-in-ruby-2.2.0/" />
<meta property="article:published_time" content="2015-04-15T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Exploring new methods in Ruby 2.2.0"/>
<meta name="twitter:description" content="For those late to the Ruby 2.2.0 party like me, aside from the changes (and updates) the core team made under the hood for this version, they introduced couple of new methods to the Enumerable module and to the_ Method, Float, File_ and _String_ classes. Lets take a look at these methods and explore how we can use them in our everyday jobs. Just a heads up, make sure you **use Ruby 2."/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://ieftimov.com/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://ieftimov.com/css/main.css" />
		<link rel="stylesheet" type="text/css" href="https://ieftimov.com/css/overrides.css" />
	

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://ieftimov.com/js/main.js"></script><script src="https://ieftimov.com/js/tooltip.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
		<div class="avatar">
			<a href="https://ieftimov.com/">
				<img src="https://pbs.twimg.com/profile_images/1194757753585225728/JbET17PZ_400x400.jpg" alt="Ilija Eftimov" />
			</a>
		</div>
	
	<h1 class="site-title"><a href="https://ieftimov.com/">Ilija Eftimov</a></h1>
	<div class="site-description"><p>Software engineer, author and open source contributor</p><nav class="nav social">
			<ul class="flat"><li><a href="https://github.com/fteem" title="Github"><i data-feather="github"></i></a></li><li><a href="https://twitter.com/fteem" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://www.linkedin.com/in/ieftimov" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="mailto:blog@ieftimov.com" title="Email"><i data-feather="mail"></i></a></li></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">Home</a>
			</li>
			
			<li>
				<a href="/posts">Archive</a>
			</li>
			
			<li>
				<a href="/about">About</a>
			</li>
			
			<li>
				<a href="https://forms.gle/orfXK5jh1LRaiFzo8">Suggest a topic</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">15</span>
							<span class="rest">Apr 2015</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Exploring new methods in Ruby 2.2.0</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>For those late to the Ruby 2.2.0 party like me, aside from the changes (and
updates) the core team made under the hood for this version, they introduced
couple of new methods to the <em>Enumerable</em> module and to the_ Method, Float,
File_ and _String_ classes. Lets take a look at these methods and explore how
we can use them in our everyday jobs. Just a heads up, make sure you **use Ruby
2.2.0** when working on the examples.</p>
<h3 id="enumerables-slice-after">Enumerable's #slice_after</h3>
<p><strong>Enumerable#slice_after</strong> is used to chunk an array. When chunks are created,
it creates an enumerator for the chunked elements. The end of every chunk is
defined by a pattern or a block. This means that, if the pattern returns true
for an element, the element that matches the pattern is the end of the chunk.
This applies for the block as well - if the block returns true for an element -
that element is the end of the chunk. How can we use this? Say you have some an
array of page numbers and you want to group them by three. Also, the group
should show the first page and last page of the group, with a dash in between.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">pages <span style="font-weight:bold">=</span> <span style="color:#999">Array</span>(<span style="color:#099">1</span><span style="font-weight:bold"></span><span style="font-weight:bold">..</span><span style="color:#099">12</span><span style="font-weight:bold"></span>)
<span style="color:#998;font-style:italic"># =&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]</span>

enum <span style="font-weight:bold">=</span> pages<span style="font-weight:bold">.</span>slice_after{<span style="font-weight:bold">|</span>n<span style="font-weight:bold">|</span> n <span style="font-weight:bold">%</span> <span style="color:#099">3</span> <span style="font-weight:bold"></span><span style="font-weight:bold">==</span> <span style="color:#099">0</span> <span style="font-weight:bold"></span>}

enum<span style="font-weight:bold">.</span>to_a
<span style="color:#998;font-style:italic"># =&gt; [[1, 2, 3], [4, 5, 6], [7, 8, 9], [10, 11, 12]]</span>

enum<span style="font-weight:bold">.</span>map {<span style="font-weight:bold">|</span>chunk<span style="font-weight:bold">|</span> <span style="color:#b84">&#34;</span><span style="color:#b84">#{</span>chunk<span style="font-weight:bold">[</span><span style="color:#099">0</span><span style="font-weight:bold"></span><span style="font-weight:bold">]</span><span style="color:#b84">}</span><span style="color:#b84"> - </span><span style="color:#b84">#{</span>chunk<span style="font-weight:bold">[</span><span style="color:#099">2</span><span style="font-weight:bold"></span><span style="font-weight:bold">]</span><span style="color:#b84">}</span><span style="color:#b84">&#34;</span> }
<span style="color:#998;font-style:italic"># =&gt; [&#34;1 - 3&#34;, &#34;4 - 6&#34;, &#34;7 - 9&#34;, &#34;10 - 12&#34;]</span></code></pre></div>
<p>You can see that we use slice_after to slice the array after every third
number. This returns an enumerator, that we can use to loop over it and do
something with the chunked elements. In this case, we concatenate the first and
the last element with a dash in between them, and we compose a new array of the
grouped page numbers by using <strong>Enumerable#map</strong>. You can read more about
the slice_after method in the
<a href="http://ruby-doc.org/core-2.2.0/Enumerable.html#method-i-slice_after">official Ruby docs</a>.</p>
<h3 id="enumerables-slice-when">Enumerable's #slice_when</h3>
<p><strong>slice_when</strong> works very similarly to <strong>slice_after</strong>. The difference is that
it only accepts a block as an argument, and it will create a chunk when that
block returns true. Also, the block accepts two arguments, representing two
adjacent elements of the array. How can we use this? Lets say we have an array
of numbers and we want to detect all decreasing subsequences in the array.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#998;font-style:italic"># Generates an array of 20 random numbers from 1 to 10K</span>
arr <span style="font-weight:bold">=</span> (<span style="color:#099">1</span><span style="font-weight:bold"></span><span style="font-weight:bold">..</span><span style="color:#099">10000</span><span style="font-weight:bold"></span>)<span style="font-weight:bold">.</span>to_a<span style="font-weight:bold">.</span>sample <span style="color:#099">20</span>
<span style="font-weight:bold"></span><span style="color:#998;font-style:italic"># =&gt; [9000, 4068, 3339, 234, 2861, 2436, 1853, 397, 701, 7072, 6306, 6976, 5736, 4942, 7332, 4941, 6171, 2178, 248, 8473]</span>

arr<span style="font-weight:bold">.</span>slice_when {<span style="font-weight:bold">|</span>left, right<span style="font-weight:bold">|</span> left <span style="font-weight:bold">&lt;</span> right }<span style="font-weight:bold">.</span>to_a
<span style="color:#998;font-style:italic"># =&gt; [[9000, 4068, 3339, 234], [2861, 2436, 1853, 397], [701], [7072, 6306], [6976, 5736, 4942], [7332, 4941], [6171, 2178, 248], [8473]]</span></code></pre></div>
<p>As you can see, the <strong>slice_when</strong> method block takes two arguments, the number
&ldquo;on the left&rdquo; and the number &ldquo;on the right&rdquo;. I find it easier to think about it
that way, but I think it is more correct to use <em>previous</em> and <em>next</em> when
naming the block arguments. In the example, the code in the block just looks
for a pair of adjacent elements in the array where the first one is smaller
than the second one. When the condition returns true a chunk is created. You
can read more about this method in the
<a href="http://ruby-doc.org/core-2.2.0/Enumerable.html#method-i-slice_when">official Ruby docs.</a></p>
<h3 id="floats-next-float-and-prev-float">Float's #next_float and #prev_float</h3>
<p>These are pretty much self explanatory. When you call any of these methods
on a floating point number, you get the next/previous in line.</p>
<p>Keep in mind that if you call </p>
<p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#999">Float</span><span style="font-weight:bold">::</span><span style="color:#008080">MAX</span><span style="font-weight:bold">.</span>next_float</code></pre></div>
you will get back <em>Infinity</em>. For those that haven't seen <em>Float::MAX</em> before,
it's the largest floating point number that Ruby can interpret (it's value is 1.7976931348623157e+308).
Also, if you call</p>
<p><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">(<span style="font-weight:bold">-</span><span style="color:#999">Float</span><span style="font-weight:bold">::</span><span style="color:#008080">MAX</span>)<span style="font-weight:bold">.</span>prev_float</code></pre></div>
you will get back <em>-Infinity</em>. You can read more about these methods in the
official docs for
<a href="http://ruby-doc.org/core-2.2.0/Float.html#method-i-next_float">next_float</a> and
<a href="http://ruby-doc.org/core-2.2.0/Float.html#method-i-prev_float">prev_float</a>.</p>
<h3 id="files-birthtime-and-birthtime">File's .birthtime and #birthtime</h3>
<p>Also, very self explanatory. It returns the time and date when the file was
created.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#998;font-style:italic"># You can use the class method with the path of the file</span>
<span style="color:#008080">File</span><span style="font-weight:bold">.</span>birthtime(<span style="color:#b84">&#34;</span><span style="color:#b84">/Applications/TextEdit.app</span><span style="color:#b84">&#34;</span>)
<span style="color:#998;font-style:italic"># =&gt; 2014-09-10 00:05:30 +0200</span>

<span style="color:#998;font-style:italic"># Or, open the file...</span>
f <span style="font-weight:bold">=</span> <span style="color:#008080">File</span><span style="font-weight:bold">.</span>open(<span style="color:#b84">&#34;</span><span style="color:#b84">/Applications/TextEdit.app</span><span style="color:#b84">&#34;</span>)
<span style="color:#998;font-style:italic"># .. and call #birthtime.</span>
f<span style="font-weight:bold">.</span>birthtime
<span style="color:#998;font-style:italic"># =&gt; 2014-09-10 00:05:30 +0200</span>

<span style="color:#998;font-style:italic"># You can also use the class method with a File object.</span>
<span style="color:#008080">File</span><span style="font-weight:bold">.</span>birthtime(f)
<span style="color:#998;font-style:italic"># =&gt; 2014-09-10 00:05:30 +0200</span></code></pre></div>
<p>You can read more about this in the
<a href="http://ruby-doc.org/core-2.2.0/File.html#method-c-birthtime">official docs</a>
for the File class. <strong>Important</strong>: this does not work on GNU/Linux, because (at
the moment of writing this) Linux has no API where Ruby would read that data
from. Also, it seems that <strong>only Ext4</strong> filesystem is keeping this data, but as
said, it doesn't expose it. You can read more about this on
<a href="https://lkml.org/lkml/2010/7/22/249">this LKML mailing list thread</a>.</p>
<h3 id="strings-unicode-normalize-unicode-normalize--unicode-normalized">String's #unicode_normalize, #unicode_normalize! &amp; #unicode_normalized?</h3>
<p>**#unicode_normalize **normalizes the string. The predicate checks if the
string is  normalized.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#998;font-style:italic"># The Unicode code for the umlaut sign is \u0308</span>
bad <span style="font-weight:bold">=</span> <span style="color:#b84">&#34;</span><span style="color:#b84">making u with an umlaut in Unicode is done with: u</span><span style="color:#b84">\</span><span style="color:#b84">u0308</span><span style="color:#b84">&#34;</span>
<span style="color:#998;font-style:italic"># =&gt; &#34;making u with an umlaut in Unicode is done with: ü&#34;</span>

bad<span style="font-weight:bold">.</span>unicode_normalized?
<span style="color:#998;font-style:italic"># =&gt; false</span>

bad<span style="font-weight:bold">.</span>unicode_normalize!
<span style="color:#998;font-style:italic"># =&gt; &#34;making u with an umlaut in Unicode is done with: ü&#34;</span>

bad<span style="font-weight:bold">.</span>unicode_normalized?
<span style="color:#998;font-style:italic"># =&gt; true</span></code></pre></div>
<h3 id="methodsuper-method">Method#super_method</h3>
<p>This method returns a Method of superclass, which would be called if <em>super</em> is
used.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Parent</span>
  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">name</span>
    <span style="color:#999">puts</span> <span style="color:#b84">&#34;</span><span style="color:#b84">I&#39;m the parent!</span><span style="color:#b84">&#34;</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span>

<span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Child</span> <span style="font-weight:bold">&lt;</span> <span style="color:#008080">Parent</span>
  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">name</span>
    <span style="color:#999">puts</span> <span style="color:#b84">&#34;</span><span style="color:#b84">I&#39;m the child!</span><span style="color:#b84">&#34;</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span>

parent <span style="font-weight:bold">=</span> <span style="color:#008080">Parent</span><span style="font-weight:bold">.</span>new
parent<span style="font-weight:bold">.</span>name
<span style="color:#998;font-style:italic"># I&#39;m the parent!</span>

child <span style="font-weight:bold">=</span> <span style="color:#008080">Child</span><span style="font-weight:bold">.</span>new
child<span style="font-weight:bold">.</span>name
<span style="color:#998;font-style:italic"># I&#39;m the child!</span>

<span style="color:#998;font-style:italic"># We need to access the Method object, not the result of method...</span>
<span style="color:#998;font-style:italic"># So, this will not work because the method returns nil, not itself:</span>

child<span style="font-weight:bold">.</span>name<span style="font-weight:bold">.</span>super_method
<span style="color:#998;font-style:italic"># NoMethodError: undefined method `super_method&#39; for nil:NilClass</span>

child<span style="font-weight:bold">.</span>name<span style="font-weight:bold">.</span>class
<span style="color:#998;font-style:italic"># =&gt; NilClass</span>

<span style="color:#998;font-style:italic"># But if we access the Method object...</span>
child<span style="font-weight:bold">.</span>public_method(<span style="color:#b84">:name</span>)
<span style="color:#998;font-style:italic"># =&gt; #&lt;Method: Child#name&gt;</span>
<span style="color:#998;font-style:italic"># ... we can call the super method of the #name method</span>

child<span style="font-weight:bold">.</span>public_method(<span style="color:#b84">:name</span>)<span style="font-weight:bold">.</span>super_method
<span style="color:#998;font-style:italic"># =&gt; #&lt;Method: Parent#name&gt;</span>
child<span style="font-weight:bold">.</span>public_method(<span style="color:#b84">:name</span>)<span style="font-weight:bold">.</span>super_method<span style="font-weight:bold">.</span>call
<span style="color:#998;font-style:italic"># I&#39;m the parent!</span></code></pre></div>
<h3 id="outro">Outro</h3>
<p>These are some nice methods that can make our lives easier. I hope this blog
post helped you understand (and maybe discover) these new methods that were
added to Ruby 2.2.0. What do you think about these new methods? Where can you
put them in use? Please, feel free to drop a comment - I would love to read
your opinion on this topic.</p>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="/tags/additions">additions</a></li>
							
							<li><a href="/tags/methods">methods</a></li>
							
						</ul>
					
				
			</div><div id="disqus_thread"></div>
<script type="text/javascript">
	(function () {
		
		
		if (window.location.hostname == "localhost")
			return;

		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		var disqus_shortname = 'eftimov';
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
		Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> Copyright © 2014 - 2019 Ilija Eftimov |  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-11264459-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
