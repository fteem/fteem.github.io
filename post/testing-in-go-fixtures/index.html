<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Testing in Go: Fixtures | Ilija Eftimov ⚡️</title><meta name=keywords content><meta name=description content="When I was researching the topic of test fixtures, I couldn&rsquo;t find much about their beginnings. My first search was about the name of the person who coined &ldquo;test fixtures&rdquo;. Unfortunately, that was not a fruitful edeavour. The next logical step was to look for etymology of the phrase &ldquo;test fixtures&rdquo;, but the only search result that made sense was a Wikipedia page on the topic.
Image taken from Undraw.  Judging by the Wiki page, it&rsquo;s clear that test fixutures as a concept has been heavily popularized by Ruby on Rails."><meta name=author content="Ilija"><link rel=canonical href=https://ieftimov.com/post/testing-in-go-fixtures/><link href=/assets/css/stylesheet.min.css rel="preload stylesheet" as=style><link rel=icon href=https://ieftimov.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ieftimov.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ieftimov.com/favicon-32x32.png><link rel=apple-touch-icon href=https://ieftimov.com/apple-touch-icon.png><link rel=mask-icon href=https://ieftimov.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.81.0"><script async defer data-domain=ieftimov.com src=https://plausible.io/js/plausible.js></script><meta property="og:title" content="Testing in Go: Fixtures"><meta property="og:description" content="When I was researching the topic of test fixtures, I couldn&rsquo;t find much about their beginnings. My first search was about the name of the person who coined &ldquo;test fixtures&rdquo;. Unfortunately, that was not a fruitful edeavour. The next logical step was to look for etymology of the phrase &ldquo;test fixtures&rdquo;, but the only search result that made sense was a Wikipedia page on the topic.
Image taken from Undraw.  Judging by the Wiki page, it&rsquo;s clear that test fixutures as a concept has been heavily popularized by Ruby on Rails."><meta property="og:type" content="article"><meta property="og:url" content="https://ieftimov.com/post/testing-in-go-fixtures/"><meta property="og:image" content="https://ieftimov.com/cards/testing-in-go-fixtures.png"><meta property="article:published_time" content="2019-09-16T00:00:00+00:00"><meta property="article:modified_time" content="2019-09-16T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ieftimov.com/cards/testing-in-go-fixtures.png"><meta name=twitter:title content="Testing in Go: Fixtures"><meta name=twitter:description content="When I was researching the topic of test fixtures, I couldn&rsquo;t find much about their beginnings. My first search was about the name of the person who coined &ldquo;test fixtures&rdquo;. Unfortunately, that was not a fruitful edeavour. The next logical step was to look for etymology of the phrase &ldquo;test fixtures&rdquo;, but the only search result that made sense was a Wikipedia page on the topic.
Image taken from Undraw.  Judging by the Wiki page, it&rsquo;s clear that test fixutures as a concept has been heavily popularized by Ruby on Rails."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ieftimov.com/posts/"},{"@type":"ListItem","position":2,"name":"Testing in Go: Fixtures","item":"https://ieftimov.com/post/testing-in-go-fixtures/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Testing in Go: Fixtures","name":"Testing in Go: Fixtures","description":"When I was researching the topic of test fixtures, I couldn\u0026amp;rsquo;t find much about their beginnings. My first search was about the name of the person who coined \u0026amp;ldquo;test …","keywords":[],"articleBody":"When I was researching the topic of test fixtures, I couldn’t find much about their beginnings. My first search was about the name of the person who coined “test fixtures”. Unfortunately, that was not a fruitful edeavour. The next logical step was to look for etymology of the phrase “test fixtures”, but the only search result that made sense was a Wikipedia page on the topic.\nImage taken from Undraw.  Judging by the Wiki page, it’s clear that test fixutures as a concept has been heavily popularized by Ruby on Rails. Likely though, folks that have been in the industry for a longer time will say that the idea of test fixutres is older than Rails itself. What I feel is more important in this discussion is putting the historical facts aside and who/what is to blame to the popularization of the concept. Instead, we should focus on understanding the motivation behind it and how we can improve its implementations.\nTest fixtures contribute to setting up the system for the testing process by providing it with all the necessary data for initialization. This is done to satisfy any preconditions there may be for the code under test. For example, code that we want to test might require some configuration before it can be executed or tested. This means that every time we have to test such code, we would have to recreate these preconditions to run the code.\nMore annoyingly, if the configuration of the tested code would change, we would have to update the structure of the configuration everywhere where we test that particular code.\nTo avoid such scenarios, we use fixtures. Fixtures allow us to reliably and repeatably create the state that our code relies on, without worrying about the details. If the required state for the code under test would change, we need only to tweak a fixture, instead of scouring all of our tests for the code that needs to be changed.\nI know, I know. My introduction made you dizzy from all the praise of fixtures. Let’s stop the sales pitch here and move on to see how simple fixtures can be and how you can master them as another tool in your testing toolbelt.\nImage taken from Undraw.  Making a simple gradebook As always, talking about code without having code to talk about is not great. Let’s introduce an example representing a gradebook that will be populated from a CSV file, using a builder function. After, we will create a lookup method per column and add some tests for both functions.\n1 2 3 4 5 6 7  type Record struct { student string subject string grade string } type Gradebook []Record    The Record type will have three attributes: student, subject and grade, all three of type string. The Gradebook type is just a slice of Records, nothing more.\nNext, let’s create a builder function for a Gradebook. We want the function to be simple - receive a path to a CSV file as argument and return a Gradebook with all of the records parsed from the CSV.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  func NewGradebook(csvFile io.Reader) (Gradebook, error) { var gradebook Gradebook reader := csv.NewReader(csvFile) for { line, err := reader.Read() if err == io.EOF { break } if err != nil { return gradebook, err } if len(line) 3 { return gradebook, fmt.Errorf(\"Invalid file structure\") } gradebook = append(gradebook, Record{ student: line[0], subject: line[1], grade: line[2], }) } return gradebook, nil }    Although a bit bloated, the function actually doesn’t do much. It receives an io.Reader as argument (which is the file reader), wraps it in a CSV reader and reads it line by line. For each line it reads, it will create a new Record struct and append it to the collection of Records, gradebook. After parsing the whole file it will exit the loop and return the gradebook.\nOf course, in true Go fashion, in every step of the reading and parsing the file we gracefully handle the errors. If in any scenario there’s an error, the function will return the error along with the empty gradebook.\nThe last piece of the puzzle is the function which will find all records in the gradebook for a particular student:\n1 2 3 4 5 6 7 8 9  func (gb *Gradebook) FindByStudent(student string) []Record { var records []Record for _, record := range *gb { if student == record.student { records = append(records, record) } } return records }    The FindByStudent function takes the student name as argument. Then, it will loop through all the records of the Gradebook and will collect all of the records where the name of the student matches. Lastly, it will return the records found for the particular student name.\nTo manually test the code, let’s create a small CSV file, called grades.csv:\nJane,Chemistry,A John,Biology,A Jane,Algebra,B Jane,Biology,A John,Algebra,B John,Chemistry,C In the main function of the file we will parse it and then get all of Jane’s grades:\n1 2 3 4 5 6 7 8  func main() { csvFile, err := os.Open(\"grades.csv\") if err != nil { fmt.Println(fmt.Errorf(\"error opening file: %v\", err)) } grades, err := NewGradebook(csvFile) fmt.Printf(\"%+v\\n\", grades.FindByStudent(\"Jane\")) }    The output of the function will be:\n1 2  $ go run grades.go [{student:Jane subject:Chemistry grade:A} {student:Jane subject:Algebra grade:B} {student:Jane subject:Biology grade:A}]   From the output it is clear what are Jane’s grades in the gradebook we have created. Having these two types and two functions is good enough to explain how we can use fixtures in the testing we’re about to do.\nTesting the builder function Whenever we need to test a piece of code, we have to identify what are its key components. In other words, we have to understand what are the important steps that that code takes to accomplish its mission. For example, to test the NewGradebook function an overly simplified breakdown of its doings would look like:\n Read through each of the lines of the CSV When reading through each line, create a new struct from the data Put the new struct in the collection of structs Return the collection of structs  Now, there’s no need to test if opening a file and parsing it works - we trust Go to take care of that. There are two things we are interested at: will our function handle invalid CSV files gracefully, and will it create a Gradebook that what we expect from a valid file?\nTo test the error handling, we will introduce a test function:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  func TestNewGradebook_ErrorHandling(t *testing.T) { cases := []struct { fixture string returnErr bool name string }{ { fixture: \"testdata/grades/empty.csv\", returnErr: false, name: \"EmptyFile\", }, { fixture: \"testdata/grades/invalid.csv\", returnErr: true, name: \"InvalidFile\", }, { fixture: \"testdata/grades/valid.csv\", returnErr: false, name: \"ValidFile\", }, } for _, tc := range cases { t.Run(tc.name, func(t *testing.T) { _, err := NewGradebook(tc.fixture) returnedErr := err != nil if returnedErr != tc.returnErr { t.Fatalf(\"Expected returnErr: %v, got: %v\", tc.returnErr, returnedErr) } }) } }    To run these test cases, we will need three accompanying CSV files, in the root of our project: empty.csv, invalid.csv and valid.csv. An empty CSV, an invalid CSV and a valid CSV file, respectively.\nEach of these files are actually fixtures - files that go together with the test suite of this project, enabling us to assume the state of the system that we run our tests on. Now, the content of these files should be obvious from the file names. The invalid.csv will contain just text, not in a CSV format though. The empty.csv will be just an empty file, while the valid.csv file will be a real CSV that our function can parse and use. Lastly, the nonexisting.csv actually will not be a file – we want our tests to fail when this path is passed to the NewGradebook function. And this is the first thing we need to remember about fixtures: we can (and should) create as many fixture files as it makes sense, but not more than that.\nFixtures should always be placed in a directory (in our example testdata) in the root of our project. In fact, we should always place our fixtures in the testdata directory at the root of our project because go test will ignore that path when building our packages. Quoting the ouput of go help test:\n The go tool will ignore a directory named “testdata”, making it available to hold ancillary data needed by the tests.\n Placing it in the root of the directory works great because when we run go test, for each package in the directory tree, the test binary will be executed with its working directory set to the source directory of the package under test. (Read more about it in Dave Cheney’s article on the topic.)\nIn the example above, we used two nested directories: testdata and grades. This is because we want to logically group our fixtures and leave the room for other kind of fixtures within the same project, if need be. Software is built to grow, so why not set some sane defaults from the start.\nImage taken from Undraw.  Testing the FindByStudent function The functionality of the FindByStudent function is a linear search though a Gradebook type (which is a slice of Records). It compares the student name from the argument and the name of each of the records in the Gradebook. When a match is found, the matching record is added to the collection records.\nTesting this function is can be based on couple of state assumptions. The first one is that to test FindByStudent we have to have a Gradebook available. The Gradebook can be in three states: empty, without a matching Record and with a Record that matches the student name from the argument. If we would flip this on its head, it would mean that to test the function we will need three different Gradebooks: one empty, one without a matching Record, and one with a matching Record.\nTo be able to create such Gradebooks we can take two different approaches: define the Gradebooks directly in the test, or use a fixture file. Using the first approach might be more preferred by some, but for the purpose of seeing how we can use fixtures we will use the second approach. While we already have the fixture files from the previous test, we can use them in the test of the FindByStudent function:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51  func TestFindByStudent(t *testing.T) { cases := []struct { fixture string student string want Gradebook name string }{ { fixture: \"fixtures/grades/empty.csv\", student: \"Jane\", want: Gradebook{}, name: \"EmptyFixture\", }, { fixture: \"fixtures/grades/valid.csv\", student: \"Jane\", want: Gradebook{ Record{ student: \"Jane\", subject: \"Chemistry\", grade: \"A\", }, Record{ student: \"Jane\", subject: \"Algebra\", grade: \"A\", }, }, name: \"ValidFixtures\", }, } for _, tc := range cases { t.Run(tc.name, func(t *testing.T) { gradebook, err := NewGradebook(tc.fixture) if err != nil { t.Fatalf(\"Cannot create gradebook: %v\", err) } got := gradebook.FindByStudent(tc.student) for idx, gotGrade := range got { wantedGrade := tc.want[idx] if gotGrade != wantedGrade { t.Errorf(\"Expected: %v, got: %v\", wantedGrade, gotGrade) } } }) } }    In this test function we have defined two test cases: the first one uses the empty.csv fixture, while the other uses valid.csv fixture. By looking at the test cases it is clear what we expect to get from each one. When working with the empty CSV we expect to get an empty gradebook - no grades, no gradebook. But, when working with the valid.csv we expect to get a Gradebook that will have all of the grades for the student specified in that particular test case, in this case Jane.\nThe test function does not have any magic. It merely builds a Gradebook using the NewGradebook function and the fixture file. Then, we invoke the FindByStudent function on the Gradebook and we make srue that all of the grades that we got are the ones we expected.\nIf we run the test, we’ll get an output looking like this:\n1 2 3 4 5 6 7 8 9  $ go test -v -run=TestFindByStudent === RUN TestFindByStudent === RUN TestFindByStudent/EmptyFixture === RUN TestFindByStudent/ValidFixture --- PASS: TestFindByStudent (0.00s) --- PASS: TestFindByStudent/EmptyFixture (0.00s) --- PASS: TestFindByStudent/ValidFixture (0.00s) PASS ok _/Users/Ilija/Documents/fixtures\t0.004s   The tests pass - building the Gradebooks with the fixtures worked well, so we could range over the test cases and test our expectations.\nImage taken from Undraw.  Tidying up our tests Looking at both test functions that we wrote, at the beginning of the t.Run blocks we can notice that we have to create a new Gradebook by using the NewGradebook builder function. In essence, this is the test setup in these two test functions - we have to have an instance of the Gradebook type to run our tests.\nWhen we use fixtures the failure to use a fixture can mean that the tests cannot be run - they depend on the fixture files being available and usable. In case where the fixture renders to be unusable, we have to stop the execution of the tests futher and bail out with an error.\nFor such reasons it is a quick win to extract a test helper that can be used in the test setup. By doing that, we all of the error handling for loading the fixture and test setup can be extracted outside of the tests functions. Let’s create a small function that will do just that:\n1 2 3 4 5 6 7 8  func buildGradebook(t *testing.T, path string) *Gradebook { gradebook, err := NewGradebook(path) if err != nil { t.Fatalf(\"Cannot create Gradebook: %v\", err) } return \u0026gradebook }    The buildGradebook is simply a wrapper around the call to NewGradebook, with one key difference: if a Gradebook cannot be produced using NewGradebook it will actually mark the as failed. This is done using t.Fatalf, where instead of returning an empty Gradebook we immediately make the test fail. In other words: being unable to create a Gradebook is an unrecoverable error. A nice sideffect of this is that the caller function of buildGradebook does not need to handle the error that might be returned from NewGradebook - that will all be handled by buildGradebook.\nIf we revisit our TestFindByStudent function now, it will not have changed much. Still, it will contain the improvements coming from the buildGradebook function:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46  func TestFindByStudent(t *testing.T) { cases := []struct { fixture string student string want Gradebook name string }{ { fixture: \"fixtures/grades/empty.csv\", student: \"Jane\", want: Gradebook{}, name: \"EmptyFixture\", }, { fixture: \"fixtures/grades/valid.csv\", student: \"Jane\", want: Gradebook{ Record{ student: \"Jane\", subject: \"Chemistry\", grade: \"A\", }, Record{ student: \"Jane\", subject: \"Algebra\", grade: \"A\", }, }, name: \"ValidFixture\", }, } for _, tc := range cases { t.Run(tc.name, func(t *testing.T) { gradebook := buildGradebook(t, tc.fixture) got := gradebook.FindByStudent(tc.student) for idx, gotGrade := range got { wantedGrade := tc.want[idx] if gotGrade != wantedGrade { t.Errorf(\"Expected: %v, got: %v\", wantedGrade, gotGrade) } } }) } }    If we would remove any of the fixture files, we will see how the test will be marked as failed due to the t.Fatal invocation:\n1 2 3 4 5 6 7 8 9 10 11 12  $ rm testdata/grades/valid.csv # We remove the fixture $ go test ./... -count=1 -v -run=TestFindByStudent === RUN TestFindByStudent === RUN TestFindByStudent/ValidFixture === RUN TestFindByStudent/EmptyFixture --- FAIL: TestFindByStudent (0.00s) --- FAIL: TestFindByStudent/ValidFixture (0.00s) grades_test.go:8: Cannot create Gradebook: open testdata/grades/valid.csv: no such file or directory --- PASS: TestFindByStudent/EmptyFixture (0.00s) FAIL FAIL\t_/Users/Ilija/Documents/fixtures\t0.004s   By having another function that takes care of building the Gradebook we’re able to offload the complexity of the missing fixtures outside of the tests themselves. While these concepts are simple, they’re powerful as they lead to cleaner tests and functions that are local to the test and easy to maintain.\nEDIT October 8, 2019: As Andreas Schröpfer suggested in the comments, it’s more idiomatic Go when the function receives a io.Reader instead of a file path. I have updated the example code and the article to reflect that. Thanks Andreas!\nLiked this article? Subscribe to my newsletter and get my fresh posts in your inbox. It's short and sweet, going out monthly to over 1,000 subscribers.  ","wordCount":"2841","inLanguage":"en","datePublished":"2019-09-16T00:00:00Z","dateModified":"2019-09-16T00:00:00Z","author":{"@type":"Person","name":"Ilija"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ieftimov.com/post/testing-in-go-fixtures/"},"publisher":{"@type":"Organization","name":"Ilija Eftimov ⚡️","logo":{"@type":"ImageObject","url":"https://ieftimov.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://ieftimov.com/ accesskey=h title="Ilija Eftimov ⚡️ (Alt + H)">Ilija Eftimov ⚡️</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://ieftimov.com/posts title=Archive><span>Archive</span></a></li><li><a href=https://ieftimov.com/about title=About><span>About</span></a></li><li><a href=https://ieftimov.com/newsletter title=Newsletter><span>Newsletter</span></a></li><li><a href=https://forms.gle/orfXK5jh1LRaiFzo8 title="Suggest a topic"><span>Suggest a topic</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Testing in Go: Fixtures</h1><div class=post-meta>September 16, 2019&nbsp;·&nbsp;14 min&nbsp;·&nbsp;Ilija</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#making-a-simple-gradebook aria-label="Making a simple gradebook">Making a simple gradebook</a></li><li><a href=#testing-the-builder-function aria-label="Testing the builder function">Testing the builder function</a></li><li><a href=#testing-the-findbystudent-function aria-label="Testing the FindByStudent function">Testing the <code>FindByStudent</code> function</a></li><li><a href=#tidying-up-our-tests aria-label="Tidying up our tests">Tidying up our tests</a></li></ul></div></details></div><div class=post-content><p>When I was researching the topic of test fixtures, I couldn&rsquo;t find much about
their beginnings. My first search was about the name of the person who coined
&ldquo;test fixtures&rdquo;. Unfortunately, that was not a fruitful edeavour. The next
logical step was to look for etymology of the phrase &ldquo;test fixtures&rdquo;, but the
only search result that made sense was a <a href=https://en.wikipedia.org/wiki/Test_fixture>Wikipedia
page</a> on the topic.</p><figure class=imagecaption><img class=caption src=/testing-in-go-fixtures/sculpting.png title="Image taken from Undraw." alt="Person sculpting">
<span class=caption-text>Image taken from <a href=https://undraw.co/>Undraw</a>.</span></figure><p>Judging by the Wiki page, it&rsquo;s clear that test fixutures as a concept has been
heavily popularized by Ruby on Rails. Likely though, folks that have been in
the industry for a longer time will say that the idea of test fixutres is older
than Rails itself. What I feel is more important in this discussion is putting
the historical facts aside and who/what is to blame to the popularization of
the concept. Instead, we should focus on understanding the motivation behind it
and how we can improve its implementations.</p><p>Test fixtures contribute to setting up the system for the testing process by
providing it with all the necessary data for initialization. This is done to
satisfy any preconditions there may be for the code under test. For example,
code that we want to test might require some configuration before it can be
executed or tested. This means that every time we have to test such code, we
would have to recreate these preconditions to run the code.</p><p>More annoyingly, if the configuration of the tested code would change, we would
have to update the structure of the configuration everywhere where we test that
particular code.</p><p>To avoid such scenarios, we use fixtures. Fixtures allow us to <em>reliably</em> and
<em>repeatably</em> create the state that our code relies on, without worrying about
the details. If the required state for the code under test would change, we
need only to tweak a fixture, instead of scouring all of our tests for the code
that needs to be changed.</p><p>I know, I know. My introduction made you dizzy from all the praise of fixtures.
Let&rsquo;s stop the sales pitch here and move on to see how simple fixtures can be
and how you can master them as another tool in your testing toolbelt.</p><figure class=imagecaption><img class=caption src=/testing-in-go-fixtures/progress_tracking.png title="Image taken from Undraw." alt="Image taken from Undraw.">
<span class=caption-text>Image taken from <a href=https://undraw.co/>Undraw</a>.</span></figure><h2 id=making-a-simple-gradebook>Making a simple gradebook<a hidden class=anchor aria-hidden=true href=#making-a-simple-gradebook>#</a></h2><p>As always, talking about code without having code to talk about is not great.
Let&rsquo;s introduce an example representing a gradebook that will be populated from
a CSV file, using a builder function. After, we will create a lookup method per
column and add some tests for both functions.</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#0087ff>type</span> Record <span style=color:#0087ff>struct</span> {
	student <span style=color:#af0000>string</span>
	subject <span style=color:#af0000>string</span>
	grade   <span style=color:#af0000>string</span>
}

<span style=color:#0087ff>type</span> Gradebook []Record
</code></pre></td></tr></table></div></div><p>The <code>Record</code> type will have three attributes: <code>student</code>, <code>subject</code> and <code>grade</code>,
all three of type <code>string</code>. The <code>Gradebook</code> type is just a slice of <code>Record</code>s,
nothing more.</p><p>Next, let&rsquo;s create a builder function for a <code>Gradebook</code>. We want the function
to be simple - receive a path to a CSV file as argument and return a
<code>Gradebook</code> with all of the records parsed from the CSV.</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">28
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#0087ff>func</span> <span style=color:#0087ff>NewGradebook</span>(csvFile io.Reader) (Gradebook, <span style=color:#af0000>error</span>) {
	<span style=color:#0087ff>var</span> gradebook Gradebook
	reader := csv.<span style=color:#0087ff>NewReader</span>(csvFile)

	<span style=color:#5f8700>for</span> {
		line, err := reader.<span style=color:#0087ff>Read</span>()

		<span style=color:#5f8700>if</span> err == io.EOF {
			<span style=color:#5f8700>break</span>
		}

		<span style=color:#5f8700>if</span> err != <span style=color:#d75f00>nil</span> {
			<span style=color:#5f8700>return</span> gradebook, err
		}

		<span style=color:#5f8700>if</span> <span style=color:#0087ff>len</span>(line) &lt; <span style=color:#00afaf>3</span> {
			<span style=color:#5f8700>return</span> gradebook, fmt.<span style=color:#0087ff>Errorf</span>(<span style=color:#00afaf>&#34;Invalid file structure&#34;</span>)
		}

		gradebook = <span style=color:#0087ff>append</span>(gradebook, Record{
			student: line[<span style=color:#00afaf>0</span>],
			subject: line[<span style=color:#00afaf>1</span>],
			grade:   line[<span style=color:#00afaf>2</span>],
		})
	}

	<span style=color:#5f8700>return</span> gradebook, <span style=color:#d75f00>nil</span>
}
</code></pre></td></tr></table></div></div><p>Although a bit bloated, the function actually doesn&rsquo;t do much. It receives an
<code>io.Reader</code> as argument (which is the file reader), wraps it in a CSV reader
and reads it line by line. For each line it reads, it will create a new
<code>Record</code> struct and <code>append</code> it to the collection of <code>Record</code>s, <code>gradebook</code>.
After parsing the whole file it will exit the loop and return the gradebook.</p><p>Of course, in true Go fashion, in every step of the reading and parsing the
file we gracefully handle the errors. If in any scenario there&rsquo;s an error, the
function will return the error along with the empty <code>gradebook</code>.</p><p>The last piece of the puzzle is the function which will find all records in the
gradebook for a particular student:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#0087ff>func</span> (gb *Gradebook) <span style=color:#0087ff>FindByStudent</span>(student <span style=color:#af0000>string</span>) []Record {
	<span style=color:#0087ff>var</span> records []Record
	<span style=color:#5f8700>for</span> _, record := <span style=color:#5f8700>range</span> *gb {
		<span style=color:#5f8700>if</span> student == record.student {
			records = <span style=color:#0087ff>append</span>(records, record)
		}
	}
	<span style=color:#5f8700>return</span> records
}
</code></pre></td></tr></table></div></div><p>The <code>FindByStudent</code> function takes the <code>student</code> name as argument. Then, it
will loop through all the records of the <code>Gradebook</code> and will collect all of
the records where the name of the student matches. Lastly, it will return the
records found for the particular <code>student</code> name.</p><p>To manually test the code, let&rsquo;s create a small CSV file, called <code>grades.csv</code>:</p><pre><code class=language-csv data-lang=csv>Jane,Chemistry,A
John,Biology,A
Jane,Algebra,B
Jane,Biology,A
John,Algebra,B
John,Chemistry,C</code></pre><p>In the <code>main</code> function of the file we will parse it and then get all of Jane&rsquo;s
grades:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#0087ff>func</span> <span style=color:#0087ff>main</span>() {
	csvFile, err := os.<span style=color:#0087ff>Open</span>(<span style=color:#00afaf>&#34;grades.csv&#34;</span>)
	<span style=color:#5f8700>if</span> err != <span style=color:#d75f00>nil</span> {
		fmt.<span style=color:#0087ff>Println</span>(fmt.<span style=color:#0087ff>Errorf</span>(<span style=color:#00afaf>&#34;error opening file: %v&#34;</span>, err))
	}
	grades, err := <span style=color:#0087ff>NewGradebook</span>(csvFile)
	fmt.<span style=color:#0087ff>Printf</span>(<span style=color:#00afaf>&#34;%+v\n&#34;</span>, grades.<span style=color:#0087ff>FindByStudent</span>(<span style=color:#00afaf>&#34;Jane&#34;</span>))
}
</code></pre></td></tr></table></div></div><p>The output of the function will be:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go run grades.go
[{student:Jane subject:Chemistry grade:A} {student:Jane subject:Algebra grade:B} {student:Jane subject:Biology grade:A}]</code></pre></td></tr></table></div></div><p>From the output it is clear what are Jane&rsquo;s grades in the gradebook we have
created. Having these two types and two functions is good enough to explain how
we can use fixtures in the testing we&rsquo;re about to do.</p><h2 id=testing-the-builder-function>Testing the builder function<a hidden class=anchor aria-hidden=true href=#testing-the-builder-function>#</a></h2><p>Whenever we need to test a piece of code, we have to identify what are its key
components. In other words, we have to understand what are the important steps
that that code takes to accomplish its mission. For example, to test the
<code>NewGradebook</code> function an overly simplified breakdown of its doings would look
like:</p><ol><li>Read through each of the lines of the CSV</li><li>When reading through each line, create a new struct from the data</li><li>Put the new struct in the collection of structs</li><li>Return the collection of structs</li></ol><p>Now, there&rsquo;s no need to test if opening a file and parsing it works - we trust
Go to take care of that. There are two things we are interested at: will our
function handle invalid CSV files gracefully, and will it create a <code>Gradebook</code>
that what we expect from a valid file?</p><p>To test the error handling, we will introduce a test function:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">34
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#0087ff>func</span> <span style=color:#0087ff>TestNewGradebook_ErrorHandling</span>(t *testing.T) {
	cases := []<span style=color:#0087ff>struct</span> {
		fixture   <span style=color:#af0000>string</span>
		returnErr <span style=color:#af0000>bool</span>
		name      <span style=color:#af0000>string</span>
	}{
		{
			fixture:   <span style=color:#00afaf>&#34;testdata/grades/empty.csv&#34;</span>,
			returnErr: <span style=color:#d75f00>false</span>,
			name:      <span style=color:#00afaf>&#34;EmptyFile&#34;</span>,
		},
		{
			fixture:   <span style=color:#00afaf>&#34;testdata/grades/invalid.csv&#34;</span>,
			returnErr: <span style=color:#d75f00>true</span>,
			name:      <span style=color:#00afaf>&#34;InvalidFile&#34;</span>,
		},
		{
			fixture:   <span style=color:#00afaf>&#34;testdata/grades/valid.csv&#34;</span>,
			returnErr: <span style=color:#d75f00>false</span>,
			name:      <span style=color:#00afaf>&#34;ValidFile&#34;</span>,
		},
	}

	<span style=color:#5f8700>for</span> _, tc := <span style=color:#5f8700>range</span> cases {
		t.<span style=color:#0087ff>Run</span>(tc.name, <span style=color:#0087ff>func</span>(t *testing.T) {
			_, err := <span style=color:#0087ff>NewGradebook</span>(tc.fixture)
			returnedErr := err != <span style=color:#d75f00>nil</span>

			<span style=color:#5f8700>if</span> returnedErr != tc.returnErr {
				t.<span style=color:#0087ff>Fatalf</span>(<span style=color:#00afaf>&#34;Expected returnErr: %v, got: %v&#34;</span>, tc.returnErr, returnedErr)
			}
		})
	}
}
</code></pre></td></tr></table></div></div><p>To run these test cases, we will need three accompanying CSV files, in the root
of our project: <code>empty.csv</code>, <code>invalid.csv</code> and <code>valid.csv</code>. An empty CSV, an
invalid CSV and a valid CSV file, respectively.</p><p>Each of these files are actually fixtures - files that go together with the
test suite of this project, enabling us to assume the state of the system that
we run our tests on. Now, the content of these files should be obvious from the
file names. The <code>invalid.csv</code> will contain just text, not in a CSV format
though. The <code>empty.csv</code> will be just an empty file, while the <code>valid.csv</code> file
will be a real CSV that our function can parse and use. Lastly, the
<code>nonexisting.csv</code> actually will not be a file – we want our tests to fail when
this path is passed to the <code>NewGradebook</code> function. And this is the first thing
we need to remember about fixtures: we can (and should) create as many fixture
files as it makes sense, but not more than that.</p><p>Fixtures should always be placed in a directory (in our example <code>testdata</code>) in
the root of our project. In fact, we should always place our fixtures in the
<code>testdata</code> directory at the root of our project because <code>go test</code> will ignore
that path when building our packages. Quoting the ouput of <code>go help test</code>:</p><blockquote><p>The go tool will ignore a directory named &ldquo;testdata&rdquo;, making it available
to hold ancillary data needed by the tests.</p></blockquote><p>Placing it in the root of the directory works great because when we run <code>go test</code>, for each package in the directory tree, the test binary will be executed
with its working directory set to the source directory of the package under
test. (Read more about it in <a href=https://dave.cheney.net/2016/05/10/test-fixtures-in-go>Dave Cheney&rsquo;s
article</a> on the topic.)</p><p>In the example above, we used two nested directories: <code>testdata</code> and <code>grades</code>.
This is because we want to logically group our fixtures and leave the room for
other kind of fixtures within the same project, if need be. Software is built
to grow, so why not set some sane defaults from the start.</p><figure class=imagecaption><img class=caption src=/testing-in-go-fixtures/exams.png title="Image taken from Undraw." alt="Students in desks doing exams">
<span class=caption-text>Image taken from <a href=https://undraw.co/>Undraw</a>.</span></figure><h2 id=testing-the-findbystudent-function>Testing the <code>FindByStudent</code> function<a hidden class=anchor aria-hidden=true href=#testing-the-findbystudent-function>#</a></h2><p>The functionality of the <code>FindByStudent</code> function is a linear search though a
<code>Gradebook</code> type (which is a slice of <code>Record</code>s). It compares the student name
from the argument and the name of each of the records in the <code>Gradebook</code>. When
a match is found, the matching record is added to the collection <code>records</code>.</p><p>Testing this function is can be based on couple of state assumptions. The first
one is that to test <code>FindByStudent</code> we have to have a <code>Gradebook</code> available.
The <code>Gradebook</code> can be in three states: empty, without a matching <code>Record</code> and
with a <code>Record</code> that matches the student name from the argument. If we would
flip this on its head, it would mean that to test the function we will need
three different <code>Gradebooks</code>: one empty, one without a matching <code>Record</code>, and
one with a matching <code>Record</code>.</p><p>To be able to create such <code>Gradebook</code>s we can take two different approaches:
define the <code>Gradebook</code>s directly in the test, or use a fixture file. Using the
first approach might be more preferred by some, but for the purpose of seeing
how we can use fixtures we will use the second approach. While we already have
the fixture files from the previous test, we can use them in the test of the
<code>FindByStudent</code> function:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">51
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#0087ff>func</span> <span style=color:#0087ff>TestFindByStudent</span>(t *testing.T) {
	cases := []<span style=color:#0087ff>struct</span> {
		fixture <span style=color:#af0000>string</span>
		student <span style=color:#af0000>string</span>
		want    Gradebook
		name    <span style=color:#af0000>string</span>
	}{
		{
			fixture: <span style=color:#00afaf>&#34;fixtures/grades/empty.csv&#34;</span>,
			student: <span style=color:#00afaf>&#34;Jane&#34;</span>,
			want:    Gradebook{},
			name:    <span style=color:#00afaf>&#34;EmptyFixture&#34;</span>,
		},
		{
			fixture: <span style=color:#00afaf>&#34;fixtures/grades/valid.csv&#34;</span>,
			student: <span style=color:#00afaf>&#34;Jane&#34;</span>,
			want: Gradebook{
				Record{
					student: <span style=color:#00afaf>&#34;Jane&#34;</span>,
					subject: <span style=color:#00afaf>&#34;Chemistry&#34;</span>,
					grade:   <span style=color:#00afaf>&#34;A&#34;</span>,
				},
				Record{
					student: <span style=color:#00afaf>&#34;Jane&#34;</span>,
					subject: <span style=color:#00afaf>&#34;Algebra&#34;</span>,
					grade:   <span style=color:#00afaf>&#34;A&#34;</span>,
				},
			},
                        name: <span style=color:#00afaf>&#34;ValidFixtures&#34;</span>,
		},
	}

	<span style=color:#5f8700>for</span> _, tc := <span style=color:#5f8700>range</span> cases {
		t.<span style=color:#0087ff>Run</span>(tc.name, <span style=color:#0087ff>func</span>(t *testing.T) {
			gradebook, err := <span style=color:#0087ff>NewGradebook</span>(tc.fixture)
			<span style=color:#5f8700>if</span> err != <span style=color:#d75f00>nil</span> {
				t.<span style=color:#0087ff>Fatalf</span>(<span style=color:#00afaf>&#34;Cannot create gradebook: %v&#34;</span>, err)
			}

			got := gradebook.<span style=color:#0087ff>FindByStudent</span>(tc.student)
			<span style=color:#5f8700>for</span> idx, gotGrade := <span style=color:#5f8700>range</span> got {
				wantedGrade := tc.want[idx]
				<span style=color:#5f8700>if</span> gotGrade != wantedGrade {
					t.<span style=color:#0087ff>Errorf</span>(<span style=color:#00afaf>&#34;Expected: %v, got: %v&#34;</span>, wantedGrade, gotGrade)
				}
			}

		})
	}

}
</code></pre></td></tr></table></div></div><p>In this test function we have defined two test cases: the first one uses the
<code>empty.csv</code> fixture, while the other uses <code>valid.csv</code> fixture. By looking at
the test cases it is clear what we expect to get from each one. When working
with the empty CSV we expect to get an empty gradebook - no grades, no gradebook.
But, when working with the <code>valid.csv</code> we expect to get a <code>Gradebook</code> that will
have all of the grades for the student specified in that particular test case,
in this case <code>Jane</code>.</p><p>The test function does not have any magic. It merely builds a <code>Gradebook</code> using
the <code>NewGradebook</code> function and the fixture file. Then, we invoke the
<code>FindByStudent</code> function on the <code>Gradebook</code> and we make srue that all of the
grades that we got are the ones we expected.</p><p>If we run the test, we&rsquo;ll get an output looking like this:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go <span style=color:#0087ff>test</span> -v -run=<span style=color:#0087ff>TestFindByStudent</span>
=== RUN   <span style=color:#0087ff>TestFindByStudent</span>
=== RUN   TestFindByStudent/EmptyFixture
=== RUN   TestFindByStudent/ValidFixture
--- PASS: TestFindByStudent (0.00s)
    --- PASS: TestFindByStudent/EmptyFixture (0.00s)
    --- PASS: TestFindByStudent/ValidFixture (0.00s)
PASS
ok  	_/Users/Ilija/Documents/fixtures	0.004s</code></pre></td></tr></table></div></div><p>The tests pass - building the <code>Gradebook</code>s with the fixtures worked well, so we
could <code>range</code> over the test cases and test our expectations.</p><figure class=imagecaption><img class=caption src=/testing-in-go-fixtures/clean_up.png title="Image taken from Undraw." alt="Person cleaning huge monitor">
<span class=caption-text>Image taken from <a href=https://undraw.co/>Undraw</a>.</span></figure><h2 id=tidying-up-our-tests>Tidying up our tests<a hidden class=anchor aria-hidden=true href=#tidying-up-our-tests>#</a></h2><p>Looking at both test functions that we wrote, at the beginning of the <code>t.Run</code>
blocks we can notice that we have to create a new <code>Gradebook</code> by using the
<code>NewGradebook</code> builder function. In essence, this is the test setup in these
two test functions - we have to have an instance of the <code>Gradebook</code> type to run
our tests.</p><p>When we use fixtures the failure to use a fixture can mean that the tests
cannot be run - they depend on the fixture files being available and usable. In
case where the fixture renders to be unusable, we have to stop the execution of
the tests futher and bail out with an error.</p><p>For such reasons it is a quick win to extract a test helper that can be used in
the test setup. By doing that, we all of the error handling for loading the
fixture and test setup can be extracted outside of the tests functions. Let&rsquo;s
create a small function that will do just that:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#0087ff>func</span> <span style=color:#0087ff>buildGradebook</span>(t *testing.T, path <span style=color:#af0000>string</span>) *Gradebook {
	gradebook, err := <span style=color:#0087ff>NewGradebook</span>(path)
	<span style=color:#5f8700>if</span> err != <span style=color:#d75f00>nil</span> {
		t.<span style=color:#0087ff>Fatalf</span>(<span style=color:#00afaf>&#34;Cannot create Gradebook: %v&#34;</span>, err)
	}

	<span style=color:#5f8700>return</span> &amp;gradebook
}
</code></pre></td></tr></table></div></div><p>The <code>buildGradebook</code> is simply a wrapper around the call to <code>NewGradebook</code>,
with one key difference: if a <code>Gradebook</code> cannot be produced using
<code>NewGradebook</code> it will actually mark the as failed. This is done using
<code>t.Fatalf</code>, where instead of returning an empty <code>Gradebook</code> we immediately make
the test fail. In other words: being unable to create a <code>Gradebook</code> is an
unrecoverable error. A nice sideffect of this is that the caller function of
<code>buildGradebook</code> does not need to handle the error that might be returned from
<code>NewGradebook</code> - that will all be handled by <code>buildGradebook</code>.</p><p>If we revisit our <code>TestFindByStudent</code> function now, it will not have changed
much. Still, it will contain the improvements coming from the <code>buildGradebook</code>
function:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">46
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#0087ff>func</span> <span style=color:#0087ff>TestFindByStudent</span>(t *testing.T) {
	cases := []<span style=color:#0087ff>struct</span> {
		fixture <span style=color:#af0000>string</span>
		student <span style=color:#af0000>string</span>
		want    Gradebook
		name    <span style=color:#af0000>string</span>
	}{
		{
			fixture: <span style=color:#00afaf>&#34;fixtures/grades/empty.csv&#34;</span>,
			student: <span style=color:#00afaf>&#34;Jane&#34;</span>,
			want:    Gradebook{},
			name:    <span style=color:#00afaf>&#34;EmptyFixture&#34;</span>,
		},
		{ fixture: <span style=color:#00afaf>&#34;fixtures/grades/valid.csv&#34;</span>,
			student: <span style=color:#00afaf>&#34;Jane&#34;</span>,
			want: Gradebook{
				Record{
					student: <span style=color:#00afaf>&#34;Jane&#34;</span>,
					subject: <span style=color:#00afaf>&#34;Chemistry&#34;</span>,
					grade:   <span style=color:#00afaf>&#34;A&#34;</span>,
				},
				Record{
					student: <span style=color:#00afaf>&#34;Jane&#34;</span>,
					subject: <span style=color:#00afaf>&#34;Algebra&#34;</span>,
					grade:   <span style=color:#00afaf>&#34;A&#34;</span>,
				},
			},
			name: <span style=color:#00afaf>&#34;ValidFixture&#34;</span>,
		},
	}

	<span style=color:#5f8700>for</span> _, tc := <span style=color:#5f8700>range</span> cases {
		t.<span style=color:#0087ff>Run</span>(tc.name, <span style=color:#0087ff>func</span>(t *testing.T) {
			gradebook := <span style=color:#0087ff>buildGradebook</span>(t, tc.fixture)

			got := gradebook.<span style=color:#0087ff>FindByStudent</span>(tc.student)
			<span style=color:#5f8700>for</span> idx, gotGrade := <span style=color:#5f8700>range</span> got {
				wantedGrade := tc.want[idx]
				<span style=color:#5f8700>if</span> gotGrade != wantedGrade {
					t.<span style=color:#0087ff>Errorf</span>(<span style=color:#00afaf>&#34;Expected: %v, got: %v&#34;</span>, wantedGrade, gotGrade)
				}
			}

		})
	}
}
</code></pre></td></tr></table></div></div><p>If we would remove any of the fixture files, we will see how the test will be
marked as failed due to the <code>t.Fatal</code> invocation:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ rm testdata/grades/valid.csv <span style=color:#4e4e4e># We remove the fixture</span>

$ go <span style=color:#0087ff>test</span> ./... -count=<span style=color:#00afaf>1</span> -v -run=<span style=color:#0087ff>TestFindByStudent</span>
=== RUN   <span style=color:#0087ff>TestFindByStudent</span>
=== RUN   TestFindByStudent/ValidFixture
=== RUN   TestFindByStudent/EmptyFixture
--- FAIL: TestFindByStudent (0.00s)
    --- FAIL: TestFindByStudent/ValidFixture (0.00s)
        grades_test.go:8: Cannot create Gradebook: open testdata/grades/valid.csv: no such file or directory
    --- PASS: TestFindByStudent/EmptyFixture (0.00s)
FAIL
FAIL	_/Users/Ilija/Documents/fixtures	0.004s</code></pre></td></tr></table></div></div><p>By having another function that takes care of building the <code>Gradebook</code> we&rsquo;re
able to offload the complexity of the missing fixtures outside of the tests
themselves. While these concepts are simple, they&rsquo;re powerful as they lead to
cleaner tests and functions that are local to the test and easy to maintain.</p><p><strong>EDIT October 8, 2019</strong>: As <a href=https://github.com/lyckade>Andreas Schröpfer</a>
suggested in the comments, it&rsquo;s more idiomatic Go when the function receives a
<code>io.Reader</code> instead of a file path. I have updated the example code and the
article to reflect that. Thanks Andreas!</p><section class=subscribe><b>Liked this article?</b> <a href=/newsletter>Subscribe to my
newsletter</a> and get my fresh posts in your inbox. It's short and sweet,
going out monthly to over 1,000 subscribers.</section></div><footer class=post-footer><nav class=paginav><a class=prev href=https://ieftimov.com/post/simple-golang-database-seeding-abstraction-gorm/><span class=title>« Prev Page</span><br><span>Simple Golang database seeding abstraction for Gorm</span></a>
<a class=next href=https://ieftimov.com/post/testing-in-go-subtests/><span class=title>Next Page »</span><br><span>Testing in Go: Subtests</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Testing in Go: Fixtures on twitter" href="https://twitter.com/intent/tweet/?text=Testing%20in%20Go%3a%20Fixtures&url=https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-fixtures%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Testing in Go: Fixtures on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-fixtures%2f&title=Testing%20in%20Go%3a%20Fixtures&summary=Testing%20in%20Go%3a%20Fixtures&source=https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-fixtures%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Testing in Go: Fixtures on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-fixtures%2f&title=Testing%20in%20Go%3a%20Fixtures"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Testing in Go: Fixtures on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-fixtures%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Testing in Go: Fixtures on whatsapp" href="https://api.whatsapp.com/send?text=Testing%20in%20Go%3a%20Fixtures%20-%20https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-fixtures%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Testing in Go: Fixtures on telegram" href="https://telegram.me/share/url?text=Testing%20in%20Go%3a%20Fixtures&url=https%3a%2f%2fieftimov.com%2fpost%2ftesting-in-go-fixtures%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>Copyright 2021 © Ilija Eftimov</span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>