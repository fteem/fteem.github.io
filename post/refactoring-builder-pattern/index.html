<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Refactoring in Ruby: The right place for a Builder? | Ilija Eftimov ⚡️</title><meta name=keywords content="builder,pattern"><meta name=description content="Recently I started tackling refactoring in Ruby with my blog posts. It seems that it&rsquo;s one of the most popular topics that people would like to read about, so here I am with another installment of refactoring in Ruby. This time, we will see if it&rsquo;s the right time and place for a Builder&mldr; whatever that means.
Just a bit of backstory In my last post on refactoring in Ruby, I covered how to detect and refactor the long parameters code smell."><meta name=author content="Ilija"><link rel=canonical href=https://ieftimov.com/post/refactoring-builder-pattern/><link href=/assets/css/stylesheet.min.css rel="preload stylesheet" as=style><link rel=icon href=https://ieftimov.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ieftimov.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ieftimov.com/favicon-32x32.png><link rel=apple-touch-icon href=https://ieftimov.com/apple-touch-icon.png><link rel=mask-icon href=https://ieftimov.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.81.0"><script async defer data-domain=ieftimov.com src=https://plausible.io/js/plausible.js></script><meta property="og:title" content="Refactoring in Ruby: The right place for a Builder?"><meta property="og:description" content="Recently I started tackling refactoring in Ruby with my blog posts. It seems that it&rsquo;s one of the most popular topics that people would like to read about, so here I am with another installment of refactoring in Ruby. This time, we will see if it&rsquo;s the right time and place for a Builder&mldr; whatever that means.
Just a bit of backstory In my last post on refactoring in Ruby, I covered how to detect and refactor the long parameters code smell."><meta property="og:type" content="article"><meta property="og:url" content="https://ieftimov.com/post/refactoring-builder-pattern/"><meta property="article:published_time" content="2016-01-13T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Refactoring in Ruby: The right place for a Builder?"><meta name=twitter:description content="Recently I started tackling refactoring in Ruby with my blog posts. It seems that it&rsquo;s one of the most popular topics that people would like to read about, so here I am with another installment of refactoring in Ruby. This time, we will see if it&rsquo;s the right time and place for a Builder&mldr; whatever that means.
Just a bit of backstory In my last post on refactoring in Ruby, I covered how to detect and refactor the long parameters code smell."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ieftimov.com/posts/"},{"@type":"ListItem","position":2,"name":"Refactoring in Ruby: The right place for a Builder?","item":"https://ieftimov.com/post/refactoring-builder-pattern/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Refactoring in Ruby: The right place for a Builder?","name":"Refactoring in Ruby: The right place for a Builder?","description":"Recently I started tackling refactoring in Ruby with my blog posts. It seems that it\u0026amp;rsquo;s one of the most popular topics that people would like to read about, so here I am with …","keywords":["builder","pattern"],"articleBody":"Recently I started tackling refactoring in Ruby with my blog posts. It seems that it’s one of the most popular topics that people would like to read about, so here I am with another installment of refactoring in Ruby. This time, we will see if it’s the right time and place for a Builder… whatever that means.\nJust a bit of backstory In my last post on refactoring in Ruby, I covered how to detect and refactor the long parameters code smell. It stirred up quite a discussion in the comments, but also, on my Skype chat. So, a colleague of mine, who I respect a lot, mentioned that eliminating the long parameters lists can be done via the builder pattern. I won’t go into too much detail of how the discussion went, but I’ll tell you that we had a bit of a disagreement.\nEventually we shared some thoughts and got on the same page. So, in this blog post I would like to show you what is the Builder Pattern and what’s a good place to use it.\nThe basics First, the basics - what is the Builder Pattern? The builder pattern is an object creation design pattern. This means that the code produced when following this pattern will create objects of certain class(es).\nNow, the key thing to the Builder Pattern, which differentiates it from the Factory pattern, is it’s purpose. The Builder pattern is used to apply any sort of configuration on object creation.\nThis pattern also allows finer control over the object creation. Via the builder’s interface we create an uniformed way of object creation, instead of dealing with complex flows of creating an object (which often can be a composite).\nLong parameters lists Now, back to that topic on the long parameters lists code smell. Does it make sense to apply the Builder pattern to this type of a code smell? Well, it seems like it does, but only to a special type of methods - constructors!\nIf you know just a bit of OOP, you know that constructors are the methods which are invoked when an object is being created. Now, if a constructor has a long list of parameters, that usually means that it is doing quite a bit of configuration of the object itself.\nTake a look at this example:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  class Touchscreen # Some nice things a touch screen can do... end class CPU # Power... unlimited power! #StarWars end class RAM # Yeah! end class Smartphone attr_accessor :model, :screen, :cpu, :ram, :memory, :os def initialize(model = nil, screen = nil, cpu = nil, ram = nil, memory = nil, os = nil) @model = model @screen = screen @cpu = cpu @ram = ram @memory = memory @os = os end end   This is quite simlpe, but it implies that you will need to create objects from the CPU and Touchscreen classes, before you create a Smartphone object. It means that you need some configuration done before you can create an actual Smartphone.\nAs you can see, a big parameters lists can lead to confusion. If in the source code of the application you will only create Smartphone objects couple of times, then refactoring this is an overkill. But, if the class with the long parameters list in the constructor is used often, then streamlining the object creation will be an immediate win.\nBefore applying the Builder Pattern here, we need to detect some patterns in our code. By code, I mean production code and tests. If you often find yourself forgetting to create a CPU object before assigning it to a Smartphone, then a builder can help with all of that. Basically, a builder should have utility methods that will make the configuration of these objects easier.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  class SmartphoneBuilder def initialize @smartphone = Smartphone.new end def set_model(model) @smartphone.model = model end def add_processor(speed) @smartphone.cpu = CPU.new(speed) end def add_touchscreen(size) @smartphone.screen = Touchscreen.new(size) end def add_ram(amount) @smartphone.ram = RAM.new(amount) end def add_memory(amount) @smartphone.memory = amount end def set_os(os) @smartphone.os = os end def smartphone obj = @smartphone.dup @smartphone = Smartphone.new return obj end end   Having these methods in our SmartphoneBuilder class will improve the object creation flow. Take this dummy code for a comparison.\nBefore:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  class Order attr_accessor :products def initialize @products = [] end end class OrderTest Minitest::Test def test_contains_multiple_products order = Order.new 5.times do order.products Smartphone.new(\"Apple iPhone 6S\", 4.7, 1.84, 2048, 16384, :ios) end assert_equal 5, order.products.length # Sanity check assert_equal \"Apple iPhone 6S\", order.products.last.model end end   Just writing the line\n1  order.products Smartphone.new(\"Apple iPhone 6S\", 4.7, 1.84, 2048, 16384, :ios)   takes effort, because it’s nearly impossible to remember the order of the parameters. Meta-note: When I was writing the example, I had to copy-paste the initializer arguments and fill them up one-by-one, so I don’t mix them up.\nNow, writing the same test with the builder:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  class OrderTest Minitest::Test def test_contains_multiple_products order = Order.new smartphone_builder = SmartphoneBuilder.new 5.times do smartphone_builder.set_model(\"Apple iPhone 6S\") smartphone_builder.add_touchscreen(4.7) smartphone_builder.add_processor(1.84) smartphone_builder.add_ram(2048) smartphone_builder.add_memory(16384) smartphone_builder.set_os(:ios) order.products end assert_equal 5, order.products.length # Sanity check assert_equal \"Apple iPhone 6S\", order.products.last.model end end   As you can see, although the example is quite contrived, introducing the builder pattern comes in handy. Sure, the second code example might be more verbose, but on the other hand it’s super clear and very hard to get confused by it. There are a ton of other situations where one could use the builder pattern, but in this case it plays nicely when eliminating this code smell.\nEdited, 16th of January, 2016:\nAdditionally, thanks to couple of readers and colleagues, who I thank a ton for weighing in, a very interesting and approach to builders is using a building block. The usage would look like:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  class OrderTest Minitest::Test def test_contains_multiple_products order = Order.new 5.times do smartphone = SmartphoneBuilder.build do |builder| builder.set_model(\"Apple iPhone 6S\") builder.add_touchscreen(4.7) builder.add_processor(1.84) builder.add_ram(2048) builder.add_memory(16384) builder.set_os(:ios) end order.products end assert_equal 5, order.products.length # Sanity check assert_equal \"Apple iPhone 6S\", order.products.last.model end end   As you can see, this looks super nice, which is half the reason I agreed to add this to the post after it was published. The other half is usefulness, obviously. The implementation of the block-style builder:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41  class SmartphoneBuilder def self.build builder = new yield(builder) builder.smartphone end def initialize @smartphone = Smartphone.new end def set_model(model) @smartphone.model = model end def add_processor(speed) @smartphone.cpu = CPU.new(speed) end def add_touchscreen(size) @smartphone.screen = Touchscreen.new(size) end def add_ram(amount) @smartphone.ram = RAM.new(amount) end def add_memory(amount) @smartphone.memory = amount end def set_os(os) @smartphone.os = os end def smartphone obj = @smartphone.dup @smartphone = Smartphone.new return obj end end   By implementing the SmartphoneBuilder.build method, we expose the additional block-style variant of the builder, so the user can choose between the good-looking block building or the not-so-good-looking non-block-style version.\n(Over) Validation Earlier we agreed that as an object creational patten, the Builder comes into play when there’s some configuration heavy lifting when creating objects. Well, another place where a Builder might fit in nicely is validation-on-creation.\nThere have been plenty of cases where we want to make sure that the data that is passed in on object creation is valid. Like, a smartphone without a touchscreen is not really a smartphone, is it? Well, at least for now.\nAnyway, the Builder Pattern comes nicely into play when we want to deal with validation. Since the data is pushed into the object in it’s constructor, the most logical place to do the validation is there, in the constructor:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  class Smartphone attr_accessor :model, :screen, :processor, :ram, :memory def initialize(model, screen_size, processor_freq, ram, memory, os) raise \"Smartphone model required\" if model.empty? raise \"Screen size required\" if screen_size.empty? raise \"Processor Frequency required\" if processor_freq.empty? raise \"RAM required\" if ram.empty? raise \"Memory required\" if memory.empty? raise \"OS required\" if os.empty? @model = model @screen = Touchscreen.new(screen_size) @cpu = CPU.new(processor_freq) @ram = ram @memory = memory @os = os end end   Sure, this bloats the initializer, so we could extract the validation into a separate method:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  class Smartphone attr_accessor :model, :screen, :processor, :ram, :memory def initialize(model, screen_size, processor_freq, ram, memory, os) validate_parameters!(model, screen_size, processor_freq, ram, memory, os) @model = model @screen = Touchscreen.new(screen_size) @cpu = CPU.new(processor_freq) @ram = ram @memory = memory @os = os end private def validate_parameters!(*p) model, screen_size, processor_freq, ram, memory, os = *p raise \"Smartphone model required\" if model.nil? raise \"Screen size required\" if screen_size.nil? raise \"Processor Frequency required\" if processor_freq.nil? raise \"RAM required\" if ram.nil? raise \"Memory required\" if memory.nil? raise \"OS required\" if os.nil? end end   But, what would happen if we need to validate the CPU frequency? There isn’t really a CPU with a working frequency of 0 GHz, right? Or, maybe, validating the Operating System?\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  class Smartphone VALID_OS = [:ios, :android, :windows, :blackberry, :firefox, :tizen, :ubuntu] attr_accessor :model, :screen, :processor, :ram, :memory def initialize(model, screen_size, processor_freq, ram, memory, os) validate_parameters!(model, screen_size, processor_freq, ram, memory, os) validate_os!(os) @model = model @screen = Touchscreen.new(screen_size) @cpu = CPU.new(processor_freq) @ram = ram @memory = memory @os = os end private def validate_parameters!(*p) model, screen_size, processor_freq, ram, memory, os = *p raise \"Smartphone model required\" if model.nil? raise \"Screen size required\" if screen_size.nil? raise \"Processor Frequency required\" if processor_freq.nil? raise \"RAM required\" if ram.nil? raise \"Memory required\" if memory.nil? raise \"OS required\" if os.nil? end def validate_os!(os) unless VALID_OS.include?(os) raise \"Invalid Operating System: #{os}\" end end end   This adds additional weight on the Smartphone class. One option to reduce the complexity in the class would be to move this logic to a validator class. But, since all of this logic is related to the configuration of a Smartphone object on creation, moving the logic to the SmarphoneBuilder will ensure that the objects are always safely configurated.\nLet’s refactor the Smartphone class and move the validation logic to the SmartphoneBuilder:\n1 2 3 4 5 6 7 8 9 10 11 12  class Smartphone attr_accessor :model, :screen, :processor, :ram, :memory def initialize(model, screen_size, processor_freq, ram, memory, os) @model = model @screen = Touchscreen.new(screen_size) @cpu = CPU.new(processor_freq) @ram = ram @memory = memory @os = os end end   First, we remove all of the validaton logic from the Smartphone class. The next step is to find the perfect spot for the logic in the SmartphoneBuilder class:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54  class SmartphoneBuilder VALID_OS = [:ios, :android, :windows, :blackberry, :firefox, :tizen, :ubuntu] attr_reader :smartphone def initialize @smartphone = Smartphone.new end def add_memory(gbs) validate_presence!(\"Memory\", gbs) @smartphone.memory = gbs end def add_ram(gbs) validate_presence!(\"RAM\", gbs) @smartphone.ram = gbs end def add_screen(screen_size) validate_presence!(\"Screen size\", screen_size) @smartphone.screen = Touchscreen.new(screen_size) end def set_model(model) validate_presence!(\"Model\", model) @smartphone.model = model end def add_processor(cpu_freq) validate_presence!(\"Processor Speed\", cpu_freq) @smartphone.cpu = CPU.new(cpu_freq) end def set_os(os) validate_presence!(\"Operating System\", os) validate_os!(os) @smartphone.os = os end def smartphone @smartphone end private def validate_presence!(attr_name, attr_value) raise \"#{attr_name}is required.\" if attr_value.nil? end def validate_os!(os) unless VALID_OS.include?(os) raise \"Invalid Operating System: #{os}\" end end end   As you can see, whenever we set any property on the builder, it validates the configuration and raises an error if the configuration is broken. In this way, the Builder Pattern gives us the security that we will always get valid and sane objects out of it. Let’s say, we want to make sure that the phone memory must be between 1GB and 64GBs, by adding additional validation:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61  class SmartphoneBuilder VALID_OS = [:ios, :android, :windows, :blackberry, :firefox, :tizen, :ubuntu] attr_reader :smartphone def initialize @smartphone = Smartphone.new end def add_memory(gbs) validate_presence!(\"Memory\", gbs) validate_memory!(gbs) @smartphone.memory = gbs end def add_ram(gbs) validate_presence!(\"RAM\", gbs) @smartphone.ram = gbs end def add_screen(screen_size) validate_presence!(\"Screen size\", screen_size) @smartphone.screen = Touchscreen.new(screen_size) end def set_model(model) validate_presence!(\"Model\", model) @smartphone.model = model end def add_processor(cpu_freq) validate_presence!(\"Processor Speed\", cpu_freq) @smartphone.cpu = CPU.new(cpu_freq) end def set_os(os) validate_presence!(\"Operating System\", os) validate_os!(os) @smartphone.os = os end def smartphone @smartphone end private def validate_memory!(gigabytes) unless gigabytes.between?(1, 64) raise \"The memory must be between 1GB and 64GBs\" end end def validate_presence!(attr_name, attr_value) raise \"#{attr_name}is required.\" if attr_value.nil? end def validate_os!(os) unless VALID_OS.include?(os) raise \"Invalid Operating System: #{os}\" end end end   As you can see, adding more validation rules in the builder allows us to always get valid objects, forever and ever.\nOutro In this post we’ve covered, in my opinion, two of most popular cases where a builder pattern can come in handy.\nAs a general rule, when you think of applying this pattern, look for places in your code where confusion appears. Also, a good smell is a lot of configuration overhead. In these places, you might find this pattern useful.\nI am sure you might find other situations where you can apply this pattern. I would love to learn of new places where this pattern can be used, so please share your experience with me in the comments section below.\nThanks for reading!\nLiked this article? Subscribe to my newsletter and get my fresh posts in your inbox. It's short and sweet, going out monthly to over 1,000 subscribers.  ","wordCount":"2478","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Ilija"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ieftimov.com/post/refactoring-builder-pattern/"},"publisher":{"@type":"Organization","name":"Ilija Eftimov ⚡️","logo":{"@type":"ImageObject","url":"https://ieftimov.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://ieftimov.com/ accesskey=h title="Ilija Eftimov ⚡️ (Alt + H)">Ilija Eftimov ⚡️</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://ieftimov.com/posts title=Archive><span>Archive</span></a></li><li><a href=https://ieftimov.com/about title=About><span>About</span></a></li><li><a href=https://ieftimov.com/newsletter title=Newsletter><span>Newsletter</span></a></li><li><a href=https://forms.gle/orfXK5jh1LRaiFzo8 title="Suggest a topic"><span>Suggest a topic</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Refactoring in Ruby: The right place for a Builder?</h1><div class=post-meta>January 13, 2016&nbsp;·&nbsp;12 min&nbsp;·&nbsp;Ilija</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#just-a-bit-of-backstory aria-label="Just a bit of backstory">Just a bit of backstory</a></li><li><a href=#the-basics aria-label="The basics">The basics</a></li><li><a href=#long-parameters-lists aria-label="Long parameters lists">Long parameters lists</a></li><li><a href=#over-validation aria-label="(Over) Validation">(Over) Validation</a></li><li><a href=#outro aria-label=Outro>Outro</a></li></ul></div></details></div><div class=post-content><p>Recently I started tackling refactoring in Ruby with my blog posts. It seems
that it&rsquo;s one of the most popular topics that people would like to read about,
so here I am with another installment of refactoring in Ruby. This time, we
will see if it&rsquo;s the right time and place for a Builder&mldr; whatever that means.</p><h2 id=just-a-bit-of-backstory>Just a bit of backstory<a hidden class=anchor aria-hidden=true href=#just-a-bit-of-backstory>#</a></h2><p>In my last post on refactoring in Ruby, I covered how to detect and refactor
the <a href=/refactoring-smelly-parameters-lists>long parameters</a> code smell. It
stirred up quite a discussion in the comments, but also, on my Skype chat. So,
a colleague of mine, who I respect a lot, mentioned that eliminating the long
parameters lists can be done via the builder pattern. I won&rsquo;t go into too much
detail of how the discussion went, but I&rsquo;ll tell you that we had a bit of a
disagreement.</p><p>Eventually we shared some thoughts and got on the same page. So, in this blog
post I would like to show you what is the Builder Pattern and what&rsquo;s a good
place to use it.</p><h2 id=the-basics>The basics<a hidden class=anchor aria-hidden=true href=#the-basics>#</a></h2><p>First, the basics - what is the Builder Pattern? The builder pattern is an
object creation design pattern. This means that the code produced when
following this pattern will create objects of certain class(es).</p><p>Now, the key thing to the Builder Pattern, which differentiates it from the
Factory pattern, is it&rsquo;s purpose. The Builder pattern is used to apply any sort
of <strong>configuration on object creation</strong>.</p><p>This pattern also allows finer control over the object creation. Via the
builder&rsquo;s interface we create an uniformed way of object creation, instead of
dealing with complex flows of creating an object (which often can be a
composite).</p><h2 id=long-parameters-lists>Long parameters lists<a hidden class=anchor aria-hidden=true href=#long-parameters-lists>#</a></h2><p>Now, back to that topic on the long parameters lists code smell. Does it make
sense to apply the Builder pattern to this type of a code smell? Well, it seems
like it does, but only to a special type of methods - constructors!</p><p>If you know just a bit of OOP, you know that constructors are the methods which
are invoked when an object is being created. Now, if a constructor has a long
list of parameters, that usually means that it is doing quite a bit of
configuration of the object itself.</p><p>Take a look at this example:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#5f8700>class</span> <span style=color:#0087ff>Touchscreen</span>
  <span style=color:#4e4e4e># Some nice things a touch screen can do...</span>
<span style=color:#5f8700>end</span>

<span style=color:#5f8700>class</span> <span style=color:#0087ff>CPU</span>
  <span style=color:#4e4e4e># Power... unlimited power! #StarWars</span>
<span style=color:#5f8700>end</span>

<span style=color:#5f8700>class</span> <span style=color:#0087ff>RAM</span>
  <span style=color:#4e4e4e># Yeah!</span>
<span style=color:#5f8700>end</span>

<span style=color:#5f8700>class</span> <span style=color:#0087ff>Smartphone</span>
  <span style=color:#5f8700>attr_accessor</span> <span style=color:#00afaf>:model</span>, <span style=color:#00afaf>:screen</span>, <span style=color:#00afaf>:cpu</span>, <span style=color:#00afaf>:ram</span>, <span style=color:#00afaf>:memory</span>, <span style=color:#00afaf>:os</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>initialize</span>(model = <span style=color:#5f8700>nil</span>, screen = <span style=color:#5f8700>nil</span>, cpu = <span style=color:#5f8700>nil</span>, ram = <span style=color:#5f8700>nil</span>, memory = <span style=color:#5f8700>nil</span>, os = <span style=color:#5f8700>nil</span>)
    @model  = model
    @screen = screen
    @cpu    = cpu
    @ram    = ram
    @memory = memory
    @os     = os
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>This is quite simlpe, but it implies that you will need to create objects from
the <code>CPU</code> and <code>Touchscreen</code> classes, before you create a <code>Smartphone</code> object.
It means that you need some configuration done before you can create an actual
<code>Smartphone</code>.</p><p>As you can see, a big parameters lists can lead to confusion. If in the source
code of the application you will only create <code>Smartphone</code> objects couple of
times, then refactoring this is an overkill. But, if the class with the long
parameters list in the constructor is used often, then streamlining the object
creation will be an immediate win.</p><p>Before applying the Builder Pattern here, we need to detect some patterns in our
code. By code, I mean production code <strong>and</strong> tests. If you often find yourself
forgetting to create a <code>CPU</code> object before assigning it to a <code>Smartphone</code>, then
a builder can help with all of that. Basically, a builder should have utility
methods that will make the configuration of these objects easier.</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">35
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#5f8700>class</span> <span style=color:#0087ff>SmartphoneBuilder</span>
  <span style=color:#5f8700>def</span> <span style=color:#0087ff>initialize</span>
    @smartphone = <span style=color:#d75f00>Smartphone</span>.new
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>set_model</span>(model)
    @smartphone.model = model
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_processor</span>(speed)
    @smartphone.cpu = <span style=color:#d75f00>CPU</span>.new(speed)
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_touchscreen</span>(size)
    @smartphone.screen = <span style=color:#d75f00>Touchscreen</span>.new(size)
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_ram</span>(amount)
    @smartphone.ram = <span style=color:#d75f00>RAM</span>.new(amount)
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_memory</span>(amount)
    @smartphone.memory = amount
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>set_os</span>(os)
    @smartphone.os = os
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>smartphone</span>
    obj = @smartphone.dup
    @smartphone = <span style=color:#d75f00>Smartphone</span>.new
    <span style=color:#5f8700>return</span> obj
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>Having these methods in our <code>SmartphoneBuilder</code> class will improve the object
creation flow. Take this dummy code for a comparison.</p><p>Before:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#5f8700>class</span> <span style=color:#0087ff>Order</span>
  <span style=color:#5f8700>attr_accessor</span> <span style=color:#00afaf>:products</span>
  <span style=color:#5f8700>def</span> <span style=color:#0087ff>initialize</span>
    @products = []
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span>

<span style=color:#5f8700>class</span> <span style=color:#0087ff>OrderTest</span> &lt; <span style=color:#d75f00>Minitest</span>::<span style=color:#d75f00>Test</span>
  <span style=color:#5f8700>def</span> <span style=color:#0087ff>test_contains_multiple_products</span>
    order = <span style=color:#d75f00>Order</span>.new
    <span style=color:#00afaf>5</span>.times <span style=color:#5f8700>do</span>
      order.products &lt;&lt; <span style=color:#d75f00>Smartphone</span>.new(<span style=color:#00afaf>&#34;Apple iPhone 6S&#34;</span>, <span style=color:#00afaf>4</span>.<span style=color:#00afaf>7</span>, <span style=color:#00afaf>1</span>.<span style=color:#00afaf>84</span>, <span style=color:#00afaf>2048</span>, <span style=color:#00afaf>16384</span>, <span style=color:#00afaf>:ios</span>)
    <span style=color:#5f8700>end</span>
    assert_equal <span style=color:#00afaf>5</span>, order.products.length
    <span style=color:#4e4e4e># Sanity check</span>
    assert_equal <span style=color:#00afaf>&#34;Apple iPhone 6S&#34;</span>, order.products.last.model
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>Just writing the line</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>order.products &lt;&lt; <span style=color:#d75f00>Smartphone</span>.new(<span style=color:#00afaf>&#34;Apple iPhone 6S&#34;</span>, <span style=color:#00afaf>4</span>.<span style=color:#00afaf>7</span>, <span style=color:#00afaf>1</span>.<span style=color:#00afaf>84</span>, <span style=color:#00afaf>2048</span>, <span style=color:#00afaf>16384</span>, <span style=color:#00afaf>:ios</span>)</code></pre></td></tr></table></div></div><p>takes effort, because it&rsquo;s nearly impossible to remember the order of the
parameters. Meta-note: When I was writing the example, I had to copy-paste the initializer
arguments and fill them up one-by-one, so I don&rsquo;t mix them up.</p><p>Now, writing the same test with the builder:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#5f8700>class</span> <span style=color:#0087ff>OrderTest</span> &lt; <span style=color:#d75f00>Minitest</span>::<span style=color:#d75f00>Test</span>
  <span style=color:#5f8700>def</span> <span style=color:#0087ff>test_contains_multiple_products</span>
    order = <span style=color:#d75f00>Order</span>.new
    smartphone_builder = <span style=color:#d75f00>SmartphoneBuilder</span>.new
    <span style=color:#00afaf>5</span>.times <span style=color:#5f8700>do</span>
      smartphone_builder.set_model(<span style=color:#00afaf>&#34;Apple iPhone 6S&#34;</span>)
      smartphone_builder.add_touchscreen(<span style=color:#00afaf>4</span>.<span style=color:#00afaf>7</span>)
      smartphone_builder.add_processor(<span style=color:#00afaf>1</span>.<span style=color:#00afaf>84</span>)
      smartphone_builder.add_ram(<span style=color:#00afaf>2048</span>)
      smartphone_builder.add_memory(<span style=color:#00afaf>16384</span>)
      smartphone_builder.set_os(<span style=color:#00afaf>:ios</span>)
      order.products &lt;&lt; smartphone_builder.smartphone
    <span style=color:#5f8700>end</span>
    assert_equal <span style=color:#00afaf>5</span>, order.products.length
    <span style=color:#4e4e4e># Sanity check</span>
    assert_equal <span style=color:#00afaf>&#34;Apple iPhone 6S&#34;</span>, order.products.last.model
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>As you can see, although the example is quite contrived, introducing the builder
pattern comes in handy. Sure, the second code example might be more verbose, but
on the other hand it&rsquo;s super clear and very hard to get confused by it. There
are a ton of other situations where one could use the builder pattern, but in
this case it plays nicely when eliminating this code smell.</p><p><strong>Edited</strong>, 16th of January, 2016:</p><p>Additionally, thanks to couple of readers and colleagues, who I <strong>thank a ton</strong>
for weighing in, a very interesting and approach to builders is using a building
block. The usage would look like:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#5f8700>class</span> <span style=color:#0087ff>OrderTest</span> &lt; <span style=color:#d75f00>Minitest</span>::<span style=color:#d75f00>Test</span>
  <span style=color:#5f8700>def</span> <span style=color:#0087ff>test_contains_multiple_products</span>
    order = <span style=color:#d75f00>Order</span>.new
    <span style=color:#00afaf>5</span>.times <span style=color:#5f8700>do</span>
      smartphone = <span style=color:#d75f00>SmartphoneBuilder</span>.build <span style=color:#5f8700>do</span> |builder|
        builder.set_model(<span style=color:#00afaf>&#34;Apple iPhone 6S&#34;</span>)
        builder.add_touchscreen(<span style=color:#00afaf>4</span>.<span style=color:#00afaf>7</span>)
        builder.add_processor(<span style=color:#00afaf>1</span>.<span style=color:#00afaf>84</span>)
        builder.add_ram(<span style=color:#00afaf>2048</span>)
        builder.add_memory(<span style=color:#00afaf>16384</span>)
        builder.set_os(<span style=color:#00afaf>:ios</span>)
      <span style=color:#5f8700>end</span>
      order.products &lt;&lt; smartphone
    <span style=color:#5f8700>end</span>
    assert_equal <span style=color:#00afaf>5</span>, order.products.length
    <span style=color:#4e4e4e># Sanity check</span>
    assert_equal <span style=color:#00afaf>&#34;Apple iPhone 6S&#34;</span>, order.products.last.model
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>As you can see, this looks super nice, which is half the reason I agreed to add
this to the post after it was published. The other half is usefulness, obviously.
The implementation of the block-style builder:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">41
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#5f8700>class</span> <span style=color:#0087ff>SmartphoneBuilder</span>
  <span style=color:#5f8700>def</span> <span style=color:#0087ff>self</span>.<span style=color:#0087ff>build</span>
    builder = <span style=color:#5f8700>new</span>
    <span style=color:#5f8700>yield</span>(builder)
    builder.smartphone
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>initialize</span>
    @smartphone = <span style=color:#d75f00>Smartphone</span>.new
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>set_model</span>(model)
    @smartphone.model = model
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_processor</span>(speed)
    @smartphone.cpu = <span style=color:#d75f00>CPU</span>.new(speed)
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_touchscreen</span>(size)
    @smartphone.screen = <span style=color:#d75f00>Touchscreen</span>.new(size)
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_ram</span>(amount)
    @smartphone.ram = <span style=color:#d75f00>RAM</span>.new(amount)
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_memory</span>(amount)
    @smartphone.memory = amount
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>set_os</span>(os)
    @smartphone.os = os
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>smartphone</span>
    obj = @smartphone.dup
    @smartphone = <span style=color:#d75f00>Smartphone</span>.new
    <span style=color:#5f8700>return</span> obj
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>By implementing the <code>SmartphoneBuilder.build</code> method, we expose the additional
block-style variant of the builder, so the user can choose between the
good-looking block building or the not-so-good-looking non-block-style version.</p><h2 id=over-validation>(Over) Validation<a hidden class=anchor aria-hidden=true href=#over-validation>#</a></h2><p>Earlier we agreed that as an object creational patten, the Builder comes into
play when there&rsquo;s some configuration heavy lifting when creating objects. Well,
another place where a Builder might fit in nicely is validation-on-creation.</p><p>There have been plenty of cases where we want to make sure that the data
that is passed in on object creation is valid. Like, a smartphone without a
touchscreen is not really a smartphone, is it? Well, at least for now.</p><p>Anyway, the Builder Pattern comes nicely into play when we want to deal with
validation. Since the data is pushed into the object in it&rsquo;s constructor, the
most logical place to do the validation is there, in the constructor:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#5f8700>class</span> <span style=color:#0087ff>Smartphone</span>
  <span style=color:#5f8700>attr_accessor</span> <span style=color:#00afaf>:model</span>, <span style=color:#00afaf>:screen</span>, <span style=color:#00afaf>:processor</span>, <span style=color:#00afaf>:ram</span>, <span style=color:#00afaf>:memory</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>initialize</span>(model, screen_size, processor_freq, ram, memory, os)
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Smartphone model required&#34;</span> <span style=color:#5f8700>if</span> model.empty?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Screen size required&#34;</span> <span style=color:#5f8700>if</span> screen_size.empty?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Processor Frequency required&#34;</span> <span style=color:#5f8700>if</span> processor_freq.empty?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;RAM required&#34;</span> <span style=color:#5f8700>if</span> ram.empty?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Memory required&#34;</span> <span style=color:#5f8700>if</span> memory.empty?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;OS required&#34;</span> <span style=color:#5f8700>if</span> os.empty?

    @model  = model
    @screen = <span style=color:#d75f00>Touchscreen</span>.new(screen_size)
    @cpu    = <span style=color:#d75f00>CPU</span>.new(processor_freq)
    @ram    = ram
    @memory = memory
    @os     = os
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>Sure, this bloats the initializer, so we could extract the validation into a
separate method:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">25
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#5f8700>class</span> <span style=color:#0087ff>Smartphone</span>
  <span style=color:#5f8700>attr_accessor</span> <span style=color:#00afaf>:model</span>, <span style=color:#00afaf>:screen</span>, <span style=color:#00afaf>:processor</span>, <span style=color:#00afaf>:ram</span>, <span style=color:#00afaf>:memory</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>initialize</span>(model, screen_size, processor_freq, ram, memory, os)
    validate_parameters!(model, screen_size, processor_freq, ram, memory, os)

    @model  = model
    @screen = <span style=color:#d75f00>Touchscreen</span>.new(screen_size)
    @cpu    = <span style=color:#d75f00>CPU</span>.new(processor_freq)
    @ram    = ram
    @memory = memory
    @os     = os
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>private</span>
  <span style=color:#5f8700>def</span> <span style=color:#0087ff>validate_parameters!</span>(*<span style=color:#0087ff>p</span>)
    model, screen_size, processor_freq, ram, memory, os = *<span style=color:#0087ff>p</span>
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Smartphone model required&#34;</span> <span style=color:#5f8700>if</span> model.nil?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Screen size required&#34;</span> <span style=color:#5f8700>if</span> screen_size.nil?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Processor Frequency required&#34;</span> <span style=color:#5f8700>if</span> processor_freq.nil?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;RAM required&#34;</span> <span style=color:#5f8700>if</span> ram.nil?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Memory required&#34;</span> <span style=color:#5f8700>if</span> memory.nil?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;OS required&#34;</span> <span style=color:#5f8700>if</span> os.nil?
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>But, what would happen if we need to validate the CPU frequency? There isn&rsquo;t
really a CPU with a working frequency of 0 GHz, right? Or, maybe, validating
the Operating System?</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">33
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#5f8700>class</span> <span style=color:#0087ff>Smartphone</span>
  <span style=color:#d75f00>VALID_OS</span> = [<span style=color:#00afaf>:ios</span>, <span style=color:#00afaf>:android</span>, <span style=color:#00afaf>:windows</span>, <span style=color:#00afaf>:blackberry</span>, <span style=color:#00afaf>:firefox</span>, <span style=color:#00afaf>:tizen</span>, <span style=color:#00afaf>:ubuntu</span>]
  <span style=color:#5f8700>attr_accessor</span> <span style=color:#00afaf>:model</span>, <span style=color:#00afaf>:screen</span>, <span style=color:#00afaf>:processor</span>, <span style=color:#00afaf>:ram</span>, <span style=color:#00afaf>:memory</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>initialize</span>(model, screen_size, processor_freq, ram, memory, os)
    validate_parameters!(model, screen_size, processor_freq, ram, memory, os)
    validate_os!(os)

    @model  = model
    @screen = <span style=color:#d75f00>Touchscreen</span>.new(screen_size)
    @cpu    = <span style=color:#d75f00>CPU</span>.new(processor_freq)
    @ram    = ram
    @memory = memory
    @os     = os
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>private</span>
  <span style=color:#5f8700>def</span> <span style=color:#0087ff>validate_parameters!</span>(*<span style=color:#0087ff>p</span>)
    model, screen_size, processor_freq, ram, memory, os = *<span style=color:#0087ff>p</span>
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Smartphone model required&#34;</span> <span style=color:#5f8700>if</span> model.nil?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Screen size required&#34;</span> <span style=color:#5f8700>if</span> screen_size.nil?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Processor Frequency required&#34;</span> <span style=color:#5f8700>if</span> processor_freq.nil?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;RAM required&#34;</span> <span style=color:#5f8700>if</span> ram.nil?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Memory required&#34;</span> <span style=color:#5f8700>if</span> memory.nil?
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;OS required&#34;</span> <span style=color:#5f8700>if</span> os.nil?
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>validate_os!</span>(os)
    <span style=color:#5f8700>unless</span> <span style=color:#d75f00>VALID_OS</span>.include?(os)
      <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Invalid Operating System: </span><span style=color:#00afaf>#{</span>os<span style=color:#00afaf>}</span><span style=color:#00afaf>&#34;</span>
    <span style=color:#5f8700>end</span>
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>This adds additional weight on the <code>Smartphone</code> class. One option to reduce the
complexity in the class would be to move this logic to a validator class. But,
since all of this logic is related to the configuration of a <code>Smartphone</code> object
on creation, moving the logic to the <code>SmarphoneBuilder</code> will ensure that <strong>the
objects are always safely configurated</strong>.</p><p>Let&rsquo;s refactor the <code>Smartphone</code> class and move the validation logic to the
<code>SmartphoneBuilder</code>:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#5f8700>class</span> <span style=color:#0087ff>Smartphone</span>
  <span style=color:#5f8700>attr_accessor</span> <span style=color:#00afaf>:model</span>, <span style=color:#00afaf>:screen</span>, <span style=color:#00afaf>:processor</span>, <span style=color:#00afaf>:ram</span>, <span style=color:#00afaf>:memory</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>initialize</span>(model, screen_size, processor_freq, ram, memory, os)
    @model  = model
    @screen = <span style=color:#d75f00>Touchscreen</span>.new(screen_size)
    @cpu    = <span style=color:#d75f00>CPU</span>.new(processor_freq)
    @ram    = ram
    @memory = memory
    @os     = os
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>First, we remove all of the validaton logic from the <code>Smartphone</code> class. The next
step is to find the perfect spot for the logic in the <code>SmartphoneBuilder</code> class:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">54
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#5f8700>class</span> <span style=color:#0087ff>SmartphoneBuilder</span>
  <span style=color:#d75f00>VALID_OS</span> = [<span style=color:#00afaf>:ios</span>, <span style=color:#00afaf>:android</span>, <span style=color:#00afaf>:windows</span>, <span style=color:#00afaf>:blackberry</span>, <span style=color:#00afaf>:firefox</span>, <span style=color:#00afaf>:tizen</span>, <span style=color:#00afaf>:ubuntu</span>]
  <span style=color:#5f8700>attr_reader</span> <span style=color:#00afaf>:smartphone</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>initialize</span>
    @smartphone = <span style=color:#d75f00>Smartphone</span>.new
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_memory</span>(gbs)
    validate_presence!(<span style=color:#00afaf>&#34;Memory&#34;</span>, gbs)
    @smartphone.memory = gbs
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_ram</span>(gbs)
    validate_presence!(<span style=color:#00afaf>&#34;RAM&#34;</span>, gbs)
    @smartphone.ram = gbs
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_screen</span>(screen_size)
    validate_presence!(<span style=color:#00afaf>&#34;Screen size&#34;</span>, screen_size)
    @smartphone.screen = <span style=color:#d75f00>Touchscreen</span>.new(screen_size)
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>set_model</span>(model)
    validate_presence!(<span style=color:#00afaf>&#34;Model&#34;</span>, model)
    @smartphone.model = model
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_processor</span>(cpu_freq)
    validate_presence!(<span style=color:#00afaf>&#34;Processor Speed&#34;</span>, cpu_freq)
    @smartphone.cpu = <span style=color:#d75f00>CPU</span>.new(cpu_freq)
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>set_os</span>(os)
    validate_presence!(<span style=color:#00afaf>&#34;Operating System&#34;</span>, os)
    validate_os!(os)
    @smartphone.os = os
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>smartphone</span>
    @smartphone
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>private</span>
  <span style=color:#5f8700>def</span> <span style=color:#0087ff>validate_presence!</span>(attr_name, attr_value)
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;</span><span style=color:#00afaf>#{</span>attr_name<span style=color:#00afaf>}</span><span style=color:#00afaf> is required.&#34;</span> <span style=color:#5f8700>if</span> attr_value.nil?
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>validate_os!</span>(os)
    <span style=color:#5f8700>unless</span> <span style=color:#d75f00>VALID_OS</span>.include?(os)
      <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Invalid Operating System: </span><span style=color:#00afaf>#{</span>os<span style=color:#00afaf>}</span><span style=color:#00afaf>&#34;</span>
    <span style=color:#5f8700>end</span>
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>As you can see, whenever we set any property on the builder, it validates the
configuration and <code>raise</code>s an error if the configuration is broken. In this
way, the Builder Pattern gives us the security that we will always get valid and
sane objects out of it. Let&rsquo;s say, we want to make sure that the phone memory
must be between 1GB and 64GBs, by adding additional validation:</p><div class=highlight><div style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#454545">61
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#5f8700>class</span> <span style=color:#0087ff>SmartphoneBuilder</span>
  <span style=color:#d75f00>VALID_OS</span> = [<span style=color:#00afaf>:ios</span>, <span style=color:#00afaf>:android</span>, <span style=color:#00afaf>:windows</span>, <span style=color:#00afaf>:blackberry</span>, <span style=color:#00afaf>:firefox</span>, <span style=color:#00afaf>:tizen</span>, <span style=color:#00afaf>:ubuntu</span>]
  <span style=color:#5f8700>attr_reader</span> <span style=color:#00afaf>:smartphone</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>initialize</span>
    @smartphone = <span style=color:#d75f00>Smartphone</span>.new
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_memory</span>(gbs)
    validate_presence!(<span style=color:#00afaf>&#34;Memory&#34;</span>, gbs)
    validate_memory!(gbs)
    @smartphone.memory = gbs
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_ram</span>(gbs)
    validate_presence!(<span style=color:#00afaf>&#34;RAM&#34;</span>, gbs)
    @smartphone.ram = gbs
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_screen</span>(screen_size)
    validate_presence!(<span style=color:#00afaf>&#34;Screen size&#34;</span>, screen_size)
    @smartphone.screen = <span style=color:#d75f00>Touchscreen</span>.new(screen_size)
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>set_model</span>(model)
    validate_presence!(<span style=color:#00afaf>&#34;Model&#34;</span>, model)
    @smartphone.model = model
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>add_processor</span>(cpu_freq)
    validate_presence!(<span style=color:#00afaf>&#34;Processor Speed&#34;</span>, cpu_freq)
    @smartphone.cpu = <span style=color:#d75f00>CPU</span>.new(cpu_freq)
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>set_os</span>(os)
    validate_presence!(<span style=color:#00afaf>&#34;Operating System&#34;</span>, os)
    validate_os!(os)
    @smartphone.os = os
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>smartphone</span>
    @smartphone
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>private</span>
  <span style=color:#5f8700>def</span> <span style=color:#0087ff>validate_memory!</span>(gigabytes)
    <span style=color:#5f8700>unless</span> gigabytes.between?(<span style=color:#00afaf>1</span>, <span style=color:#00afaf>64</span>)
      <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;The memory must be between 1GB and 64GBs&#34;</span>
    <span style=color:#5f8700>end</span>
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>validate_presence!</span>(attr_name, attr_value)
    <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;</span><span style=color:#00afaf>#{</span>attr_name<span style=color:#00afaf>}</span><span style=color:#00afaf> is required.&#34;</span> <span style=color:#5f8700>if</span> attr_value.nil?
  <span style=color:#5f8700>end</span>

  <span style=color:#5f8700>def</span> <span style=color:#0087ff>validate_os!</span>(os)
    <span style=color:#5f8700>unless</span> <span style=color:#d75f00>VALID_OS</span>.include?(os)
      <span style=color:#5f8700>raise</span> <span style=color:#00afaf>&#34;Invalid Operating System: </span><span style=color:#00afaf>#{</span>os<span style=color:#00afaf>}</span><span style=color:#00afaf>&#34;</span>
    <span style=color:#5f8700>end</span>
  <span style=color:#5f8700>end</span>
<span style=color:#5f8700>end</span></code></pre></td></tr></table></div></div><p>As you can see, adding more validation rules in the builder allows us to always
get valid objects, forever and ever.</p><h2 id=outro>Outro<a hidden class=anchor aria-hidden=true href=#outro>#</a></h2><p>In this post we&rsquo;ve covered, in my opinion, two of most popular cases where a
builder pattern can come in handy.</p><p>As a general rule, when you think of applying this pattern, look for places in
your code where confusion appears. Also, a good smell is a lot of configuration
overhead. In these places, you might find this pattern useful.</p><p>I am sure you might find other situations where you can apply this pattern. I
would love to learn of new places where this pattern can be used, so please
share your experience with me in the comments section below.</p><p>Thanks for reading!</p><section class=subscribe><b>Liked this article?</b> <a href=/newsletter>Subscribe to my
newsletter</a> and get my fresh posts in your inbox. It's short and sweet,
going out monthly to over 1,000 subscribers.</section></div><footer class=post-footer><ul class=post-tags><li><a href=https://ieftimov.com/tags/builder/>builder</a></li><li><a href=https://ieftimov.com/tags/pattern/>pattern</a></li></ul><nav class=paginav><a class=prev href=https://ieftimov.com/post/reactive-programing-rxruby/><span class=title>« Prev Page</span><br><span>Understanding Reactive Programming with RxRuby</span></a>
<a class=next href=https://ieftimov.com/post/running-rails-app-deis/><span class=title>Next Page »</span><br><span>Running a Rails Application on Deis</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Refactoring in Ruby: The right place for a Builder? on twitter" href="https://twitter.com/intent/tweet/?text=Refactoring%20in%20Ruby%3a%20The%20right%20place%20for%20a%20Builder%3f&url=https%3a%2f%2fieftimov.com%2fpost%2frefactoring-builder-pattern%2f&hashtags=builder%2cpattern"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Refactoring in Ruby: The right place for a Builder? on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fieftimov.com%2fpost%2frefactoring-builder-pattern%2f&title=Refactoring%20in%20Ruby%3a%20The%20right%20place%20for%20a%20Builder%3f&summary=Refactoring%20in%20Ruby%3a%20The%20right%20place%20for%20a%20Builder%3f&source=https%3a%2f%2fieftimov.com%2fpost%2frefactoring-builder-pattern%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Refactoring in Ruby: The right place for a Builder? on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fieftimov.com%2fpost%2frefactoring-builder-pattern%2f&title=Refactoring%20in%20Ruby%3a%20The%20right%20place%20for%20a%20Builder%3f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Refactoring in Ruby: The right place for a Builder? on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fieftimov.com%2fpost%2frefactoring-builder-pattern%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Refactoring in Ruby: The right place for a Builder? on whatsapp" href="https://api.whatsapp.com/send?text=Refactoring%20in%20Ruby%3a%20The%20right%20place%20for%20a%20Builder%3f%20-%20https%3a%2f%2fieftimov.com%2fpost%2frefactoring-builder-pattern%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Refactoring in Ruby: The right place for a Builder? on telegram" href="https://telegram.me/share/url?text=Refactoring%20in%20Ruby%3a%20The%20right%20place%20for%20a%20Builder%3f&url=https%3a%2f%2fieftimov.com%2fpost%2frefactoring-builder-pattern%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>Copyright 2021 © Ilija Eftimov</span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>