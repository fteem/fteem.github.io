<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Learn Your Tools: Selective Git Additions - Ilija Eftimov</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="Learn Your Tools: Selective Git Additions" />
<meta property="og:description" content="In my career, if I ever get asked to interview someone, I would always start the interview with version control. Maybe it&#39;s a bit of an exaggeration, but to me, understanding version control and having a good grasp of programming logic is more important than just knowing the syntax and the stdlib of a programming language.
But, for whatever reason, whether it&#39;s laziness or simply conformism, we often learn a tool until a certain point that works for us and we stop." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ieftimov.com/post/learn-your-tools-selective-git-additions/" />
<meta property="og:image" content="https://ieftimov.com/cards/learn-your-tools-selective-git-additions.png" />
<meta property="article:published_time" content="2016-04-17T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://ieftimov.com/cards/learn-your-tools-selective-git-additions.png"/>

<meta name="twitter:title" content="Learn Your Tools: Selective Git Additions"/>
<meta name="twitter:description" content="In my career, if I ever get asked to interview someone, I would always start the interview with version control. Maybe it&#39;s a bit of an exaggeration, but to me, understanding version control and having a good grasp of programming logic is more important than just knowing the syntax and the stdlib of a programming language.
But, for whatever reason, whether it&#39;s laziness or simply conformism, we often learn a tool until a certain point that works for us and we stop."/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://ieftimov.comcss/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://ieftimov.comcss/main.css" />
		<link rel="stylesheet" type="text/css" href="https://ieftimov.comcss/overrides.css" />
	

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://ieftimov.comjs/main.js"></script><script src="https://ieftimov.comjs/tooltip.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
		<div class="avatar">
			<a href="https://ieftimov.com">
				<img src="https://pbs.twimg.com/profile_images/1194757753585225728/JbET17PZ_400x400.jpg" alt="Ilija Eftimov" />
			</a>
		</div>
	
	<h1 class="site-title"><a href="https://ieftimov.com">Ilija Eftimov</a></h1>
	<div class="site-description"><p>Software engineer, author and open source contributor</p><nav class="nav social">
			<ul class="flat"><li><a href="https://github.com/fteem" title="Github"><i data-feather="github"></i></a></li><li><a href="https://twitter.com/fteem" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://www.linkedin.com/in/ieftimov" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="mailto:blog@ieftimov.com" title="Email"><i data-feather="mail"></i></a></li></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">Home</a>
			</li>
			
			<li>
				<a href="/posts">Archive</a>
			</li>
			
			<li>
				<a href="/about">About</a>
			</li>
			
			<li>
				<a href="https://forms.gle/orfXK5jh1LRaiFzo8">Suggest a topic</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">17</span>
							<span class="rest">Apr 2016</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Learn Your Tools: Selective Git Additions</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>In my career, if I ever get asked to interview someone, I would always start the
interview with version control. Maybe it's a bit of an exaggeration, but to me,
understanding version control and having a good grasp of programming logic is
more important than just knowing the syntax and the stdlib of a programming
language.</p>
<p>But, for whatever reason, whether it's laziness or simply conformism, we often
learn a tool until a certain point that works for us and we stop. We are happy
with what we know at that point and we rarely open the documentation to see how
we can improve our skills. In this blog post let's tackle a Git command that we
all know and use - <code>git add</code>.</p>
<h2 id="git-add"><code>git add</code></h2>
<p>This is for the ones that do not know (or just don't remember) what <code>git add</code>
does. From the documentation, available at your nearest terminal by executing
<code>man git-add</code>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">This command updates the index using the current content found in the working tree, to prepare the content staged for the next commit. It typically adds the current content of
existing paths as a whole, but with some options it can also be used to add content with only part of the changes made to the working tree files applied, or remove paths that
do not exist in the working tree anymore.</code></pre></div>
<p>What this says is that when you run <code>git add</code> on a path, it &ldquo;prepares&rdquo; this path
to be commited in the next commit. You can read the rest of the documentation on
<code>git add</code> online or in your terminal.</p>
<p>So, an example, right? Well, this is pretty easy. Let's create a new repo using
the <code>git init</code> command. Create a new directory, called <code>patching</code>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir patching <span style="font-weight:bold">&amp;&amp;</span> <span style="color:#999">cd</span> patching</code></pre></div>
<p>After that, you can run the <code>git init</code> command which will initialize a new blank
Git repo:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">➜  patching git init
Initialized empty Git repository in ~/projects/patching/.git/</code></pre></div>
<p>Great, now we have a new repo that we can play with. Let's create a plain text
(<code>touch text_file</code>) file whose contents will be the first paragraph of the
&ldquo;lorem ipsum&rdquo; dummy text:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor 
incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis 
nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. 
Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu 
fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in 
culpa qui officia deserunt mollit anim id est laborum.</code></pre></div>
<p>Let's check our repo now, by executing <code>git status</code>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">➜  patching git:<span style="font-weight:bold">(</span>master<span style="font-weight:bold">)</span> ✗ git status
On branch master

Initial commit

Untracked files:
  <span style="font-weight:bold">(</span>use <span style="color:#b84">&#34;git add &lt;file&gt;...&#34;</span> to include in what will be committed<span style="font-weight:bold">)</span>

	text_file

nothing added to commit but untracked files present <span style="font-weight:bold">(</span>use <span style="color:#b84">&#34;git add&#34;</span> to track<span style="font-weight:bold">)</span></code></pre></div>
<p>As you can see, we have the <code>text_file</code> file as an untracked file. Let's use
<code>git add</code> to track it and commit it after:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">➜  patching git:(master) ✗ git add text_file
➜  patching git:(master) ✗ git commit -m &#39;new text file&#39;
[master (root-commit) fdebf0b] new text file
 1 file changed, 1 insertion(+)
 create mode 100644 text_file</code></pre></div>
<p>Great, that's the usual flow of using <code>git add</code> and <code>git commit</code> in combination.
But, as I am sure you know, Git is quite more powerfull than this. Let's see
how we can be selective about our the changes to our files with the help of
<code>git add</code>.</p>
<h2 id="patching">Patching</h2>
<p>Let's introduce couple of changes to our <code>text_file</code>. We are going to make all
leters upcased on the second line, all leters lowercased on the fourth line.
Also, we are going to delete the last line of the file. When we do a <code>git diff</code>
on the file, we should get something like this:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"><span style="color:#999">diff --git a/text_file b/text_file
</span><span style="color:#999"></span><span style="color:#999">index 7b95d6b..0585259 100644
</span><span style="color:#999"></span><span style="color:#000;background-color:#fdd">--- a/text_file
</span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+++ b/text_file
</span><span style="color:#000;background-color:#dfd"></span><span style="color:#aaa">@@ -1,6 +1,5 @@
</span><span style="color:#aaa"></span> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
<span style="color:#000;background-color:#fdd">-incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis
</span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+INCIDIDUNT UT LABORE ET DOLORE MAGNA ALIQUA. UT ENIM AD MINIM VENIAM, QUIS
</span><span style="color:#000;background-color:#dfd"></span> nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
<span style="color:#000;background-color:#fdd">-Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
</span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
</span><span style="color:#000;background-color:#dfd"></span> fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
<span style="color:#000;background-color:#fdd">-culpa qui officia deserunt mollit anim id est laborum.
</span></code></pre></div>
<p>Great! Now, take this for example. As a part of our next commit, we would like
to only commit the deletion of the last line, but not the other edits of our
file. Basically, our commit should have only the changes (deletions) on the last
line of the file, but nothing else.</p>
<p>How would you do this? One option is to revert all the changes to the file, and
then just remove the last line. Sure, that's one way. But what if the file had
very complex changes that were hard to revert and redo again?</p>
<p>Git has this beautiful flag on the <code>git add</code> command - <code>-p</code> or <code>--patch</code>. Let's
check it's documentation:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">-p, --patch
    Interactively choose hunks of patch between the index and the work tree and add them to the index. This gives the user a chance to review the difference before adding
    modified contents to the index.</code></pre></div>
<p>If we run <code>git add -p</code>, this command will take us over all of the changes that
occured in the files that are tracked in the repo and ask us for an action.
Let's give it a shot:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">➜  patching git:(master) ✗ git add -p

<span style="color:#999">diff --git a/text_file b/text_file
</span><span style="color:#999"></span><span style="color:#999">index 7b95d6b..0585259 100644
</span><span style="color:#999"></span><span style="color:#000;background-color:#fdd">--- a/text_file
</span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+++ b/text_file
</span><span style="color:#000;background-color:#dfd"></span><span style="color:#aaa">@@ -1,6 +1,5 @@
</span><span style="color:#aaa"></span> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
<span style="color:#000;background-color:#fdd">-incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis
</span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+INCIDIDUNT UT LABORE ET DOLORE MAGNA ALIQUA. UT ENIM AD MINIM VENIAM, QUIS
</span><span style="color:#000;background-color:#dfd"></span> nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
<span style="color:#000;background-color:#fdd">-Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
</span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
</span><span style="color:#000;background-color:#dfd"></span> fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
<span style="color:#000;background-color:#fdd">-culpa qui officia deserunt mollit anim id est laborum.
</span><span style="color:#000;background-color:#fdd"></span>Stage this hunk [y,n,q,a,d,/,s,e,?]?
</code></pre></div>
<p>Let's analyse the output quickly. It is composed of two things - the diff and the
prompt by Git. The diff represents all of the changes that happened to the file.
The interesting part here is the prompt by Git. Instead of supplying any of the
options, let's enter a question mark and press return:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Stage this hunk [y,n,q,a,d,/,s,e,?]? ?
y - stage this hunk
n - do not stage this hunk
q - quit; do not stage this hunk or any of the remaining ones
a - stage this hunk and all later hunks in the file
d - do not stage this hunk or any of the later hunks in the file
g - select a hunk to go to
/ - search for a hunk matching the given regex
j - leave this hunk undecided, see next undecided hunk
J - leave this hunk undecided, see next hunk
k - leave this hunk undecided, see previous undecided hunk
K - leave this hunk undecided, see previous hunk
s - split the current hunk into smaller hunks
e - manually edit the current hunk
? - print help</code></pre></div>
<p>As you can see, Git will show us all of the available options for this prompt
with their respective descriptions. We could go at length about all of these
options and how they are useful, but for the purpose of this tutorial we will
stick to our original usecase.</p>
<p>Since now Git threats all of the changes as a single hunk, we need to separate
changes into different hunks. We can do that by supplying the <code>s</code> argument,
which will do that for us:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">Stage this hunk [y,n,q,a,d,/,s,e,?]? s
Split into 3 hunks.
<span style="color:#aaa">@@ -1,3 +1,3 @@
</span><span style="color:#aaa"></span> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
<span style="color:#000;background-color:#fdd">-incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis
</span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+INCIDIDUNT UT LABORE ET DOLORE MAGNA ALIQUA. UT ENIM AD MINIM VENIAM, QUIS
</span><span style="color:#000;background-color:#dfd"></span> nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
</code></pre></div>
<p>As you can notice, after supplying the <code>s</code> argument, Git informed us that the
changes were split into three hunks. Now, we can go over each of the changes and
add them selectively. All we have to do now is to enter <code>y</code> for the changes we
need (the first and the last change), and enter <code>n</code> for the second change:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">Stage this hunk [y,n,q,a,d,/,s,e,?]? s
Split into 3 hunks.
<span style="color:#aaa">@@ -1,3 +1,3 @@
</span><span style="color:#aaa"></span> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
<span style="color:#000;background-color:#fdd">-incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis
</span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+INCIDIDUNT UT LABORE ET DOLORE MAGNA ALIQUA. UT ENIM AD MINIM VENIAM, QUIS
</span><span style="color:#000;background-color:#dfd"></span> nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
Stage this hunk [y,n,q,a,d,/,j,J,g,e,?]? y
<span style="color:#aaa">@@ -3,3 +3,3 @@
</span><span style="color:#aaa"></span> nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
<span style="color:#000;background-color:#fdd">-Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
</span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
</span><span style="color:#000;background-color:#dfd"></span> fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
Stage this hunk [y,n,q,a,d,/,K,j,J,g,e,?]? n
<span style="color:#aaa">@@ -5,2 +5 @@
</span><span style="color:#aaa"></span> fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
<span style="color:#000;background-color:#fdd">-culpa qui officia deserunt mollit anim id est laborum.
</span><span style="color:#000;background-color:#fdd"></span>Stage this hunk [y,n,q,a,d,/,K,g,e,?]? y
</code></pre></div>
<p>Now, if we execute <code>git status</code>, we will see the following output:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">➜  patching git:(master) ✗ git status
On branch master
Changes to be committed:
  (use &#34;git reset HEAD &lt;file&gt;...&#34; to unstage)

	modified:   text_file

Changes not staged for commit:
  (use &#34;git add &lt;file&gt;...&#34; to update what will be committed)
  (use &#34;git checkout -- &lt;file&gt;...&#34; to discard changes in working directory)

	modified:   text_file
</code></pre></div>
<p>As expected, Git staged some of our changes that we said that we want. We can
see them by executing <code>git diff --cached</code>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"><span style="color:#999">diff --git a/text_file b/text_file
</span><span style="color:#999"></span><span style="color:#999">index 7b95d6b..233552e 100644
</span><span style="color:#999"></span><span style="color:#000;background-color:#fdd">--- a/text_file
</span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+++ b/text_file
</span><span style="color:#000;background-color:#dfd"></span><span style="color:#aaa">@@ -1,6 +1,5 @@
</span><span style="color:#aaa"></span> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
<span style="color:#000;background-color:#fdd">-incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis
</span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+INCIDIDUNT UT LABORE ET DOLORE MAGNA ALIQUA. UT ENIM AD MINIM VENIAM, QUIS
</span><span style="color:#000;background-color:#dfd"></span> nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
 Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
 fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
<span style="color:#000;background-color:#fdd">-culpa qui officia deserunt mollit anim id est laborum.
</span></code></pre></div>
<p>There we go - only the first and the last change of the file were added to our
staging area. Now we can freely go and commit these stagges, while the second
change is still unstaged in our repo.</p>
<h2 id="the-power-is-yet-to-be-unleashed">The power is yet to be unleashed</h2>
<p>The blog post started as a bit of a rant of how we don't learn our tools. Sure,
we are all guilty of it, including me. This is the main reason that got me to
write this post.</p>
<p>We have so much power at our fingertips that we need to utilize. And the only way
that we can do it is by RTFM and a lot of practice. Or, the other way. If you
are doing a lot of practice (i.e. a lot of work), always think about how you can
improve your speed and execution. If you knew how powerful are some of the tools
that you are using, your speed and effectiveness would increase exponentionally.</p>
<p>If we only took the time to read the documentation&hellip;</p>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="/tags/additions">additions</a></li>
							
						</ul>
					
				
			</div><div id="disqus_thread"></div>
<script type="text/javascript">
	(function () {
		
		
		if (window.location.hostname == "localhost")
			return;

		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		var disqus_shortname = 'eftimov';
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
		Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> Copyright © 2014 - 2019 Ilija Eftimov |  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-11264459-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
