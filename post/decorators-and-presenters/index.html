<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>A bit about decorators and presenters - Ilija Eftimov</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="A bit about decorators and presenters">
<meta itemprop="description" content="Object-oriented programming and design is (or, was?) a revolutionary way of thinking and designing programs. It introduced classes, objects, inheritance, polymorphism and many other ways to think about programming. As an addition, some very smart folks identified some pitfalls and patterns that occur in object-oriented programming and put them in books. That&#39;s how we got a list of general code smells, design patterns and refactoring patterns that we can use in our everyday work.">
<meta itemprop="datePublished" content="2016-05-20T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2016-05-20T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1056">
<meta itemprop="image" content="https://ieftimov.com/cards/decorators-and-presenters.png">



<meta itemprop="keywords" content="decorators,presenters," /><meta property="og:title" content="A bit about decorators and presenters" />
<meta property="og:description" content="Object-oriented programming and design is (or, was?) a revolutionary way of thinking and designing programs. It introduced classes, objects, inheritance, polymorphism and many other ways to think about programming. As an addition, some very smart folks identified some pitfalls and patterns that occur in object-oriented programming and put them in books. That&#39;s how we got a list of general code smells, design patterns and refactoring patterns that we can use in our everyday work." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ieftimov.com/post/decorators-and-presenters/" />
<meta property="og:image" content="https://ieftimov.com/cards/decorators-and-presenters.png" />
<meta property="article:published_time" content="2016-05-20T00:00:00+00:00" />
<meta property="article:modified_time" content="2016-05-20T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://ieftimov.com/cards/decorators-and-presenters.png"/>

<meta name="twitter:title" content="A bit about decorators and presenters"/>
<meta name="twitter:description" content="Object-oriented programming and design is (or, was?) a revolutionary way of thinking and designing programs. It introduced classes, objects, inheritance, polymorphism and many other ways to think about programming. As an addition, some very smart folks identified some pitfalls and patterns that occur in object-oriented programming and put them in books. That&#39;s how we got a list of general code smells, design patterns and refactoring patterns that we can use in our everyday work."/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://ieftimov.com/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://ieftimov.com/css/main.css" />
		<link rel="stylesheet" type="text/css" href="https://ieftimov.com/css/overrides.css" />
	

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://ieftimov.com/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://ieftimov.com/js/main.js"></script><script src="https://ieftimov.com/js/tooltip.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
		<div class="avatar">
			<a href="https://ieftimov.com/">
				<img src="/avatar.png" alt="Ilija Eftimov" />
			</a>
		</div>
	
	<h1 class="site-title"><a href="https://ieftimov.com/">Ilija Eftimov</a></h1>
	<div class="site-description"><p>Thoughts on simple software engineering</p><nav class="nav social">
			<ul class="flat"><li><a href="https://github.com/fteem" title="Github"><i data-feather="github"></i></a></li><li><a href="https://twitter.com/itsilija" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://www.linkedin.com/in/ieftimov" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="mailto:blog@ieftimov.com" title="Email"><i data-feather="mail"></i></a></li><li><a href="https://t.me/ieftimovcom" title="Telegram Channel"><i data-feather="send"></i></a></li><li><a href="/index.xml" title="RSS"><i data-feather="rss"></i></a></li></ul>
		</nav><span class="scheme-toggle"><a href="#" id="scheme-toggle"></a></div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/categories/testing-in-go">Testing in Go</a>
			</li>
			
			<li>
				<a href="/posts">Archive</a>
			</li>
			
			<li>
				<a href="/about">About</a>
			</li>
			
			<li>
				<a href="https://forms.gle/orfXK5jh1LRaiFzo8">Suggest a topic</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">20</span>
							<span class="rest">May 2016</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">A bit about decorators and presenters</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>Object-oriented programming and design is (or, was?) a revolutionary way of
thinking and designing programs. It introduced classes, objects, inheritance,
polymorphism and many other ways to think about programming. As an addition,
some very smart folks identified some pitfalls and patterns that occur in
object-oriented programming and put them in books. That's how we got a list of
general code smells, design patterns and refactoring patterns that we can use
in our everyday work.</p>
<p>But, is it that simple? Unfortunately, some of the patterns look very similar
on the surface, and have subtle differences. Also, the craft lies in
<strong>applying</strong> these patterns, over learning them by heart. In the past, I've
been always confused between the decorator pattern and the presenter pattern.
And if you are (or used to be) confused by these, believe me - it's normal.
Even the naming is so similar, I would be surprised if someone new on the block
is not confused.  Let's go over some examples and see what makes the similar,
but different.</p>
<h2 id="decorators">Decorators</h2>
<p>If you think about these patterns in a hierarchical way, the decorator pattern
would live on the top of the hierarchy. This means that, a presenter is <em>kind
of</em> subpattern of the decorator pattern. The decorator is a general purpose
pattern, whose role is to attach additional responsibilities to an object
dynamically.  While &ldquo;dynamically attach additional responsibilities&rdquo; might
sounds fancy, feel free to think about it as &ldquo;adding functionalities on the
fly, when needed&rdquo;. Also, the decorator pattern as a side-effect, provides a
flexible alternative to subclassing.</p>
<h3 id="decorating-over-subclassing">Decorating over subclassing</h3>
<p>Very often, when we have some hierarchy of classes, we use subclassing
(inheritance) to add some specific functionality to our subclass, while sharing
the inherited functionality from the superclass. In cases like this, the
decorator pattern gives us the flexibility to apply a decorator (or more
decorators) to a class, instead of creating a class hierarchy, to get
additional (or more specific) functionality on the class.</p>
<p>Also, the downside of subclassing is that it's static, which means it's applied
to a whole class. On the other hand, a decorator can be applied on runtime,
meaning it will decorate the object <em>when needed</em>.</p>
<h3 id="example">Example</h3>
<p>Let's see a small example of what a decorator might look like. Ruby makes
defining decorators so flexible and easy, which makes it hard to choose which
way to do it.</p>
<p>Our base class will be a <code>CoffeeMachine</code>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">CoffeeMachine</span>
  <span style="font-weight:bold">attr_reader</span> <span style="color:#b84">:price</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">initialize</span>(price)
    @price <span style="font-weight:bold">=</span> price
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>Now, some coffee machines have a milk steamer attached. To make a
<code>SteamedMilkCoffeeMachineDecorator</code> decorator, you can go couple of ways. The
first one would be to make it a PORO:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">SteamedMilkCoffeeMachineDecorator</span>
  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">initialize</span>(obj)
    @obj <span style="font-weight:bold">=</span> obj
  <span style="font-weight:bold">end</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">price</span>
    @obj<span style="font-weight:bold">.</span>price <span style="font-weight:bold">+</span> <span style="color:#099">300</span>
  <span style="font-weight:bold"></span><span style="font-weight:bold">end</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">can_steam_milk?</span>
    <span style="font-weight:bold">true</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>Basically, when the object is decorated, it will override the <code>price</code> method on
the <code>CoffeeMachine</code> object, and it will also decorate a method
<code>can_steam_milk?</code>. The downside of using this approach is that we will need to
add some <code>method_missing</code> magic, because we want all of the methods that are
not present on the decorator to be delegated to the decorated object.</p>
<p>Or, we can use Ruby's
<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/delegate/rdoc/SimpleDelegator.html">SimpleDelegator</a>
:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">SteamedMilkCoffeeMachineDecorator</span> <span style="font-weight:bold">&lt;</span> <span style="color:#008080">SimpleDelegator</span>
  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">price</span>
    <span style="font-weight:bold">super</span> <span style="font-weight:bold">+</span> <span style="color:#099">300</span>
  <span style="font-weight:bold"></span><span style="font-weight:bold">end</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">can_steam_milk?</span>
    <span style="font-weight:bold">true</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>This decorator will have the same functionality as the PORO decorator above,
with the addition of delegating the methods, that are unknown to the decorator,
to the wrapped object.</p>
<p>Using the decorator is plain simple:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">coffee_machine <span style="font-weight:bold">=</span> <span style="color:#008080">CoffeeMachine</span><span style="font-weight:bold">.</span>new(<span style="color:#099">500</span><span style="font-weight:bold"></span>)
with_steamer <span style="font-weight:bold">=</span> <span style="color:#008080">SteamedMilkCoffeeMachineDecorator</span><span style="font-weight:bold">.</span>new(coffee_machine)

coffee_machine<span style="font-weight:bold">.</span>price
<span style="color:#998;font-style:italic">#=&gt; 500</span>

with_steamer<span style="font-weight:bold">.</span>can_steam_milk?
<span style="color:#998;font-style:italic">#=&gt; true</span>

with_steamer<span style="font-weight:bold">.</span>price
<span style="color:#998;font-style:italic">#=&gt; 800</span></code></pre></div>
<p>If you would like to see a nice summary of decorator implementations, I would
recommend you read
<a href="https://robots.thoughtbot.com/evaluating-alternative-decorator-implementations-in">Evaluating Alternative Decorator Implementations In Ruby</a>
by Dan Croak.</p>
<h2 id="the-presenter-pattern">The Presenter pattern</h2>
<p>Now that we have a good grasp of the decorator pattern, let's see what it is,
and where the presenter pattern shines. As we mentioned in the beginning of
this article, the presenter is a &ldquo;subpattern&rdquo; of the decorator. The main
difference between them is how close they live to the view. Presenters live
very close to the view layer, while decorators being very broad, can live near
the business logic of your application.</p>
<p>Within a Rails application, presenters can be seen in various shapes. Most
often, presenters are used to keep logic out of the views:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Apartment</span>
  <span style="font-weight:bold">attr_reader</span> <span style="color:#b84">:area</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">initialize</span>(<span style="color:#b84">sq_meters</span>: sq_meters)
    @area <span style="font-weight:bold">=</span> sq_meters
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span>

<span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">ApartmentPresenter</span> <span style="font-weight:bold">&lt;</span> <span style="color:#008080">Decorator</span>
  decorates <span style="color:#b84">:apartment</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">size</span>
    <span style="font-weight:bold">if</span> area <span style="font-weight:bold">&lt;</span> <span style="color:#099">30</span>
      <span style="font-weight:bold"></span><span style="color:#b84">&#34;</span><span style="color:#b84">Small</span><span style="color:#b84">&#34;</span>
    <span style="font-weight:bold">elsif</span> area <span style="font-weight:bold">&lt;</span> <span style="color:#099">50</span>
      <span style="font-weight:bold"></span><span style="color:#b84">&#34;</span><span style="color:#b84">Cozy</span><span style="color:#b84">&#34;</span>
    <span style="font-weight:bold">elsif</span> area <span style="font-weight:bold">&lt;</span> <span style="color:#099">80</span>
      <span style="font-weight:bold"></span><span style="color:#b84">&#34;</span><span style="color:#b84">Big</span><span style="color:#b84">&#34;</span>
    <span style="font-weight:bold">else</span>
      <span style="color:#b84">&#34;</span><span style="color:#b84">Huge</span><span style="color:#b84">&#34;</span>
    <span style="font-weight:bold">end</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>As you can tell, this example uses the very popular
<a href="https://github.com/drapergem/draper">draper</a> gem that enables easy creation of
presenters. We can use our newly created presenter as:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">apartment <span style="font-weight:bold">=</span> <span style="color:#008080">ApartmentPresenter</span><span style="font-weight:bold">.</span>new(<span style="color:#008080">Apartment</span><span style="font-weight:bold">.</span>new(<span style="color:#b84">sq_meters</span>: <span style="color:#099">75</span><span style="font-weight:bold"></span>))
apartment<span style="font-weight:bold">.</span>area <span style="color:#998;font-style:italic">#=&gt; 75</span>
apartment<span style="font-weight:bold">.</span>size <span style="color:#998;font-style:italic">#=&gt; &#34;Big&#34;</span></code></pre></div>
<p>With presenters like this, you can always simplify your views. Whatever the
type of logic that you usually would put into helper methods, you can use
presenters for it. Presenters are more object-oriented way to achieve the same
goal.</p>
<h2 id="wrapping-up">Wrapping up</h2>
<p>If you think just a bit more broadly about decorators, you can see that
basically decorators are the open/closed principle (the O, from the SOLID
principles) put into practice. The open/closed principle states that a class
should be open for extension, but closed for modification, which if applied in
our context, easily paints the picture of how decorators extend classes.</p>
<p>As it usually goes, when something is easy to create, abusing it even easier.
Gems like Draper allow us to create decorators without any hassle, so it's
pretty easy to create fat decorators or to use them in weird ways. Also,
another thing to keep in mind is that although decorators help with applying
SOLID principles to your code, the decorators themselves need to oblige to
these principle at the same time.</p>
<p>Nevertheless, learning about the decorator pattern is a very useful addition to
your design patterns toolbelt. Although at time using it in the proper manner
can require some additional thinking (and maybe even prototyping), it can
improve the flexibility of your design.</p>
<h2 id="additional-reading">Additional reading</h2>
<p>These are some links that I would recommend you if you would like to learn more
about the decorator pattern:</p>
<ul>
<li><a href="http://mikepackdev.com/blog_posts/31-exhibit-vs-presenter">Exhibit vs Presenter</a> by Mike Pack</li>
<li><a href="https://sourcemaking.com/design_patterns/decorator">Decorator Design Pattern</a> at SourceMaking</li>
<li><a href="http://craftingruby.com/posts/2015/12/09/rails-antipattern-fat-decorator.html">Rails Anti-Pattern: Fat Decorator</a> by Jeroen Weeink</li>
<li><a href="https://github.com/drapergem/draper">Draper</a> gem</li>
<li><code>SimpleDelegator</code> <a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/delegate/rdoc/SimpleDelegator.html">documentation</a></li>
</ul>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="/tags/decorators">decorators</a></li>
							
							<li><a href="/tags/presenters">presenters</a></li>
							
						</ul>
					
				
			</div><div id="disqus_thread"></div>
<script type="text/javascript">
	(function () {
		
		
		if (window.location.hostname == "localhost")
			return;

		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		var disqus_shortname = 'eftimov';
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the </a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2016  Copyright Â© Ilija Eftimov |  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-11264459-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
