<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Test Doubles: in theory, in Minitest and in RSpec - Ilija Eftimov</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="Test Doubles: in theory, in Minitest and in RSpec">
<meta itemprop="description" content="Those of us that do Test Driven Development have heard about doubles, mocks, stubs, fakes and spies multiple times. Unfortunately there is a ton of confusion about all these words and their meaning. Let&#39;s see what each an every one of these really mean, where we should use them and how the popular testing frameworks for Ruby implement these.
Test Doubles So, first things first. One of the biggest misconceptions is that doubles are types of objects that are used in testing.">

<meta itemprop="wordCount" content="2391">



<meta itemprop="keywords" content="minitest,rspec,tdd,double,mock,stub,fake,dummy," /><meta property="og:title" content="Test Doubles: in theory, in Minitest and in RSpec" />
<meta property="og:description" content="Those of us that do Test Driven Development have heard about doubles, mocks, stubs, fakes and spies multiple times. Unfortunately there is a ton of confusion about all these words and their meaning. Let&#39;s see what each an every one of these really mean, where we should use them and how the popular testing frameworks for Ruby implement these.
Test Doubles So, first things first. One of the biggest misconceptions is that doubles are types of objects that are used in testing." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ieftimov.com/post/test-doubles-theory-minitest-rspec/" />
<meta property="article:published_time" content="2015-08-05T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Test Doubles: in theory, in Minitest and in RSpec"/>
<meta name="twitter:description" content="Those of us that do Test Driven Development have heard about doubles, mocks, stubs, fakes and spies multiple times. Unfortunately there is a ton of confusion about all these words and their meaning. Let&#39;s see what each an every one of these really mean, where we should use them and how the popular testing frameworks for Ruby implement these.
Test Doubles So, first things first. One of the biggest misconceptions is that doubles are types of objects that are used in testing."/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://ieftimov.com/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://ieftimov.com/css/main.css" />
		<link rel="stylesheet" type="text/css" href="https://ieftimov.com/css/overrides.css" />
	

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://ieftimov.com/js/main.js"></script><script src="https://ieftimov.com/js/tooltip.js"></script><script src="https://ieftimov.com/js/tooltip.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
		<div class="avatar">
			<a href="https://ieftimov.com/">
				<img src="/avatar.png" alt="Ilija Eftimov" />
			</a>
		</div>
	
	<h1 class="site-title"><a href="https://ieftimov.com/">Ilija Eftimov</a></h1>
	<div class="site-description"><p>A human, interested in building products and software.</p><nav class="nav social">
			<ul class="flat"><li><a href="https://github.com/fteem" title="Github"><i data-feather="github"></i></a></li><li><a href="https://twitter.com/fteem" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://www.linkedin.com/in/ieftimov" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="mailto:blog@ieftimov.com" title="Email"><i data-feather="mail"></i></a></li></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/categories/testing-in-go">Testing in Go</a>
			</li>
			
			<li>
				<a href="/posts">Archive</a>
			</li>
			
			<li>
				<a href="/about">About</a>
			</li>
			
			<li>
				<a href="https://forms.gle/orfXK5jh1LRaiFzo8">Suggest a topic</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">05</span>
							<span class="rest">Aug 2015</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Test Doubles: in theory, in Minitest and in RSpec</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>Those of us that do <strong>T</strong>est <strong>D</strong>riven <strong>D</strong>evelopment have heard about
doubles, mocks, stubs, fakes and spies multiple times. Unfortunately there is
<strong>a ton</strong> of confusion about all these words and their meaning. Let's see what
each an every one of these really mean, where we should use them and how the
popular testing frameworks for Ruby implement these.</p>
<h2 id="test-doubles">Test Doubles</h2>
<p>So, first things first. One of the biggest misconceptions is that doubles are
types of objects that are used in testing.</p>
<p>Dummies, mocks, stubs, fakes and spies <strong>are test doubles</strong>. Test double is the
<strong>category</strong> of these test objects. I think that the confusion around this
concept arises from the naming that the popular testing frameworks use for
these objects.</p>
<p>So remember - dummies, mocks, stubs, fakes and spies <strong>are test doubles</strong>.
Also, another thing to keep in mind is the word <strong>mock</strong>. The words mock and
doubles were used interchangeably in the past and their definitions got skewed.</p>
<h2 id="dummy">Dummy</h2>
<p>Now, that we got this right, what is a dummy?</p>
<p>The simplest type of test double is test dummy. Basically, the dummy is dumb,
hence the naming. This means that the object is just a placeholder for another
object, but it's interfaces (or methods) do not return anything.</p>
<p>Confusing? Let's see an example.</p>
<p>We have this class <code>Blog</code> that has a <code>publish!</code> method.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Post</span>
  <span style="font-weight:bold">attr_reader</span> <span style="color:#b84">:published</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">publish!</span>
    @published <span style="font-weight:bold">=</span> <span style="font-weight:bold">true</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span>

<span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Blog</span>
  <span style="font-weight:bold">attr_reader</span> <span style="color:#b84">:published_posts</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">initialize</span> author
    @author <span style="font-weight:bold">=</span> author
    @published_posts <span style="font-weight:bold">=</span> <span style="font-weight:bold">[</span><span style="font-weight:bold">]</span>
  <span style="font-weight:bold">end</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">publish!</span> post
    published_posts <span style="font-weight:bold">&lt;&lt;</span> post
    post<span style="font-weight:bold">.</span>publish!
  <span style="font-weight:bold">end</span>

  <span style="color:#998;font-style:italic"># Moar methods...</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>Now, we need to test the <code>publish!</code> method. How do we go about this? We
obviously need to create a <code>Post</code> object first, then create a <code>Blog</code>
object and pass the author as an argument to the initializer. Afterwards, we
need to assert that the <code>publish!</code> method will add the post to the
<code>published_posts</code> array.</p>
<h3 id="minitest">Minitest</h3>
<p>Let's test our method with Minitest:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#999">require</span> <span style="color:#b84">&#39;minitest/autorun&#39;</span>

<span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">BlogTest</span> <span style="font-weight:bold">&lt;</span> <span style="color:#008080">Minitest</span><span style="font-weight:bold">::</span><span style="color:#008080">Test</span>
  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">test_publish_adds_post_to_published_posts</span>
    blog <span style="font-weight:bold">=</span> <span style="color:#008080">Blog</span><span style="font-weight:bold">.</span>new(author)
    post <span style="font-weight:bold">=</span> <span style="color:#008080">Post</span><span style="font-weight:bold">.</span>new
    blog<span style="font-weight:bold">.</span>publish!(post)
    assert_includes(blog<span style="font-weight:bold">.</span>published_posts, post)
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>If we run the test, it will fail. Why? Well, what is <code>author</code>? As you can see
if we exclude author when creating the <code>Blog</code> object it will complain with an
exception, <code>ArgumentError</code>. But, in the code that we are testing, <code>author</code> has
no role to play. It basically does nothing. It is important to the class, but
it's not important to the method under test.</p>
<p>This is a great place to use a dummy. Let's add the author using a dummy.
Minitest and RSpec do not have the concept of a pure dummy, although RSpec has
a trick that you can use.</p>
<p>If you need a dummy in Minitest, you can just use an <code>Object</code>. Or <code>nil</code>.  Or an
empty <code>Hash</code>. Or.. whatever.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#999">require</span> <span style="color:#b84">&#39;minitest/autorun&#39;</span>

<span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">BlogTest</span> <span style="font-weight:bold">&lt;</span> <span style="color:#008080">Minitest</span><span style="font-weight:bold">::</span><span style="color:#008080">Test</span>
  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">test_publish_adds_post_to_published_posts</span>
    author <span style="font-weight:bold">=</span> <span style="color:#008080">Object</span><span style="font-weight:bold">.</span>new
    blog <span style="font-weight:bold">=</span> <span style="color:#008080">Blog</span><span style="font-weight:bold">.</span>new(author)
    post <span style="font-weight:bold">=</span> <span style="color:#008080">Post</span><span style="font-weight:bold">.</span>new
    blog<span style="font-weight:bold">.</span>publish!(post)
    assert_includes(blog<span style="font-weight:bold">.</span>published_posts, post)
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<h3 id="rspec">RSpec</h3>
<p>The same test, but using RSpec:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#999">require</span> <span style="color:#b84">&#39;rspec/autorun&#39;</span>

describe <span style="color:#008080">Post</span> <span style="font-weight:bold">do</span>
  describe <span style="color:#b84">&#34;</span><span style="color:#b84">#</span><span style="color:#b84">publish!</span><span style="color:#b84">&#34;</span> <span style="font-weight:bold">do</span>
    it <span style="color:#b84">&#39;adds the post to the published_posts array&#39;</span> <span style="font-weight:bold">do</span>
      author <span style="font-weight:bold">=</span> <span style="color:#008080">Object</span><span style="font-weight:bold">.</span>new
      blog <span style="font-weight:bold">=</span> <span style="color:#008080">Blog</span><span style="font-weight:bold">.</span>new(author)
      post <span style="font-weight:bold">=</span> <span style="color:#008080">Post</span><span style="font-weight:bold">.</span>new
      blog<span style="font-weight:bold">.</span>publish!(post)
      expect(blog<span style="font-weight:bold">.</span>published_posts)<span style="font-weight:bold">.</span>to <span style="font-weight:bold">include</span>(post)
    <span style="font-weight:bold">end</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>Also, another trick in RSpec is to use a double. A double that doesn't to
anything is a dummy. Remember that this only applies to RSpec:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#999">require</span> <span style="color:#b84">&#39;rspec/autorun&#39;</span>

describe <span style="color:#008080">Post</span> <span style="font-weight:bold">do</span>
  describe <span style="color:#b84">&#34;</span><span style="color:#b84">#</span><span style="color:#b84">publish!</span><span style="color:#b84">&#34;</span> <span style="font-weight:bold">do</span>
    it <span style="color:#b84">&#39;adds the post to the published_posts array&#39;</span> <span style="font-weight:bold">do</span>
      author <span style="font-weight:bold">=</span> double
      blog <span style="font-weight:bold">=</span> <span style="color:#008080">Blog</span><span style="font-weight:bold">.</span>new(author)
      post <span style="font-weight:bold">=</span> <span style="color:#008080">Post</span><span style="font-weight:bold">.</span>new
      blog<span style="font-weight:bold">.</span>publish!(post)
      expect(blog<span style="font-weight:bold">.</span>published_posts)<span style="font-weight:bold">.</span>to <span style="font-weight:bold">include</span>(post)
    <span style="font-weight:bold">end</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>Do not get confused by the <code>double</code> keyword. For now, just pretend that it's
an object that does nothing. Just like <code>Object.new</code> or <code>nil</code>.</p>
<h2 id="stub">Stub</h2>
<p>Stubs are dummies, with one notable difference. Stubs have methods that they
respond to.  But, their methods do not do anything except they return a
predefined value. This means that their methods do not have an effect, they
just return a value which will drive the test through the production code.</p>
<p>Let's see some examples. We have the <code>Blog</code> class which has the <code>publish!</code>
method.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Blog</span>
  <span style="font-weight:bold">attr_reader</span> <span style="color:#b84">:published_posts</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">initialize</span> user
    @user <span style="font-weight:bold">=</span> user
  <span style="font-weight:bold">end</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">publish!</span> post
    published_posts <span style="font-weight:bold">&lt;&lt;</span> post <span style="font-weight:bold">if</span> @user<span style="font-weight:bold">.</span>author?
  <span style="font-weight:bold">end</span>

  <span style="color:#998;font-style:italic"># Moar methods...</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>How can we test the <code>publish!</code> method? Due to the check that occurs in the
<code>publish!</code> method, we need a stub <code>User</code> object, which will return true
when the <code>author?</code> method is called on it.</p>
<h3 id="minitest-1">Minitest</h3>
<p>Creating a stub in Minitest is dead easy. Let's write the test for the publish
method:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#999">require</span> <span style="color:#b84">&#39;minitest/autorun&#39;</span>

<span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">BlogTest</span> <span style="font-weight:bold">&lt;</span> <span style="color:#008080">Minitest</span><span style="font-weight:bold">::</span><span style="color:#008080">Test</span>
  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">test_publish</span>
    post <span style="font-weight:bold">=</span> <span style="color:#008080">Post</span><span style="font-weight:bold">.</span>new
    user <span style="font-weight:bold">=</span> <span style="color:#008080">User</span><span style="font-weight:bold">.</span>new
    blog <span style="font-weight:bold">=</span> <span style="color:#008080">Blog</span><span style="font-weight:bold">.</span>new(user)
    user<span style="font-weight:bold">.</span>stub <span style="color:#b84">:author?</span>, <span style="font-weight:bold">true</span> <span style="font-weight:bold">do</span>
      blog<span style="font-weight:bold">.</span>publish!(post)
      assert_includes blog<span style="font-weight:bold">.</span>published_posts, post
    <span style="font-weight:bold">end</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>Stubbing in Minitest is done by calling <code>.stub</code> on the object/class that you
want to stub a method on, with three arguments: the method name, the return
value of the stub and a block. The block is basically the scope of the stub, or
in other words, the stub will work only in the provided block.</p>
<p>Another way to achieve the same, which is a bit weird, is to avoid creating a
new <code>User</code> object, create a dummy and declare a stub method on it.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#999">require</span> <span style="color:#b84">&#39;minitest/autorun&#39;</span>

<span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">BlogTest</span> <span style="font-weight:bold">&lt;</span> <span style="color:#008080">Minitest</span><span style="font-weight:bold">::</span><span style="color:#008080">Test</span>
  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">test_publish</span>
    post <span style="font-weight:bold">=</span> <span style="color:#008080">Post</span><span style="font-weight:bold">.</span>new
    user <span style="font-weight:bold">=</span> <span style="color:#008080">Object</span><span style="font-weight:bold">.</span>new

    <span style="color:#998;font-style:italic"># Tha stub</span>
    <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold">user</span><span style="font-weight:bold">.</span><span style="color:#900;font-weight:bold">author?</span>
      <span style="font-weight:bold">true</span>
    <span style="font-weight:bold">end</span>

    blog <span style="font-weight:bold">=</span> <span style="color:#008080">Blog</span><span style="font-weight:bold">.</span>new(user)
    blog<span style="font-weight:bold">.</span>publish!(post)
    assert_includes blog<span style="font-weight:bold">.</span>published_posts, post
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>Using this way, we define the <code>author?</code> method on the singleton class of the
user object, which will return <code>true</code>.</p>
<h3 id="rspec-1">RSpec</h3>
<p>The same test, or spec if you will, in RSpec is quite easy to write as well.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#999">require</span> <span style="color:#b84">&#39;rspec/autorun&#39;</span>

describe <span style="color:#008080">Blog</span> <span style="font-weight:bold">do</span>
  describe <span style="color:#b84">&#39;#publish&#39;</span> <span style="font-weight:bold">do</span>
    it <span style="color:#b84">&#39;adds the published post to the published_posts collection&#39;</span> <span style="font-weight:bold">do</span>
      post <span style="font-weight:bold">=</span> <span style="color:#008080">Post</span><span style="font-weight:bold">.</span>new
      user <span style="font-weight:bold">=</span> double(<span style="color:#b84">:author?</span> <span style="font-weight:bold">=</span><span style="font-weight:bold">&gt;</span> <span style="font-weight:bold">true</span>)
      blog <span style="font-weight:bold">=</span> <span style="color:#008080">Blog</span><span style="font-weight:bold">.</span>new(user)
      blog<span style="font-weight:bold">.</span>publish!(post)
      expect(blog<span style="font-weight:bold">.</span>published_posts)<span style="font-weight:bold">.</span>to <span style="font-weight:bold">include</span>(post)
    <span style="font-weight:bold">end</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>As you can see, the RSpec syntax is easy to understand as well. We create a
double, which is basically a dummy (makes sense, right?) and we declare a stub
on it. The stub is the <code>author?</code> which will return a predefined value, or in
our case <code>true</code>.</p>
<h2 id="spy">Spy</h2>
<p>I hope you guessed it - a spy is a stub. It's just an object whose methods do
nothing and return a predefined values to drive the test. However the spy
remembers certain things about the way and occurance of it's methods being
called. For example, sometimes you want to assert that a certain method has
been called. Another time, you might want to test how many times a method has
been called.</p>
<p>That's where spies are used.</p>
<p>Again, let's see some code. Take these classes and methods for example:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Blog</span>
  <span style="font-weight:bold">attr_reader</span> <span style="color:#b84">:published_posts</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">initialize</span> user
    @user <span style="font-weight:bold">=</span> user
  <span style="font-weight:bold">end</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">publish!</span> post
    <span style="font-weight:bold">if</span> @user<span style="font-weight:bold">.</span>author?
      published_posts <span style="font-weight:bold">&lt;&lt;</span> post
      <span style="color:#008080">NotificationService</span><span style="font-weight:bold">.</span>notify_subscribers(post)
    <span style="font-weight:bold">end</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>Now, the <code>NotificationService.notify_subscribers</code> method will send a
notification email to all the subscribers of the blog when a new post is
published.</p>
<p>When testing this method, we are interested in two things:</p>
<ol>
<li>The post will be added to the <code>published_posts</code> array, and</li>
<li>The subscribers will be notified of the new post.</li>
</ol>
<p>Since we already tested the first case in the example before, we'll just focus
on no. 2. Let's test this method.</p>
<h3 id="minitest-2">Minitest</h3>
<p>Minitest does not support spies by default, but as always, we can use another
gem that plays nice with Minitest.</p>
<p><a href="https://github.com/ryanong/spy">Spy</a> is a really simple gem that does exactly
that - spies.</p>
<p>Let's add some spies using <a href="https://github.com/ryanong/spy">Spy</a>.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">BlogTest</span> <span style="font-weight:bold">&lt;</span> <span style="color:#008080">Minitest</span><span style="font-weight:bold">::</span><span style="color:#008080">Test</span>
  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">test_notification_is_sent_when_publishing</span>
    notification_service_spy <span style="font-weight:bold">=</span> <span style="color:#008080">Spy</span><span style="font-weight:bold">.</span>on(<span style="color:#008080">NotificationService</span>, <span style="color:#b84">:notify_subscribers</span>)
    post <span style="font-weight:bold">=</span> <span style="color:#008080">Post</span><span style="font-weight:bold">.</span>new
    user <span style="font-weight:bold">=</span> <span style="color:#008080">User</span><span style="font-weight:bold">.</span>new
    blog <span style="font-weight:bold">=</span> <span style="color:#008080">Blog</span><span style="font-weight:bold">.</span>new(user)

    blog<span style="font-weight:bold">.</span>publish!(post)

    assert notificaion_service_spy<span style="font-weight:bold">.</span>has_been_called?
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>Quite self-explanatory, isn't it?</p>
<h3 id="rspec-2">RSpec</h3>
<p>The RSpec syntactic sugar is really nice and human. This is how we can create
spies in RSpec and use them appropriately.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">describe <span style="color:#008080">Blog</span> <span style="font-weight:bold">do</span>
  describe <span style="color:#b84">&#39;#publish!&#39;</span> <span style="font-weight:bold">do</span>
    it <span style="color:#b84">&#34;</span><span style="color:#b84">sends notification when new post is published</span><span style="color:#b84">&#34;</span> <span style="font-weight:bold">do</span>
      notification_spy <span style="font-weight:bold">=</span> class_spy(<span style="color:#b84">&#34;</span><span style="color:#b84">Invitation</span><span style="color:#b84">&#34;</span>)
      post <span style="font-weight:bold">=</span> <span style="color:#008080">Post</span><span style="font-weight:bold">.</span>new
      user <span style="font-weight:bold">=</span> <span style="color:#008080">User</span><span style="font-weight:bold">.</span>new
      blog <span style="font-weight:bold">=</span> <span style="color:#008080">Blog</span><span style="font-weight:bold">.</span>new(user)

      <span style="color:#998;font-style:italic"># If you want to set the expectation before the action is done:</span>
      expect(notification_spy)<span style="font-weight:bold">.</span>to receive(<span style="color:#b84">:notify_subscribers</span>)<span style="font-weight:bold">.</span>with(post)

      blog<span style="font-weight:bold">.</span>publish!(post)

      <span style="color:#998;font-style:italic"># If you want to assert after the action is done:</span>
      expect(<span style="color:#008080">NotificationService</span>)<span style="font-weight:bold">.</span>to have_received(<span style="color:#b84">:notify_subscribers</span>)<span style="font-weight:bold">.</span>with(post)
    <span style="font-weight:bold">end</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>Also, keep in mind that since spy has the functionality of a stub, it can
return fixed/predefined values. If you need your spy to return a value, you can
do this in RSpec very easily, by chaining the <code>and_return</code> method to the spy:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">describe <span style="color:#008080">Blog</span> <span style="font-weight:bold">do</span>
  describe <span style="color:#b84">&#39;#publish!&#39;</span> <span style="font-weight:bold">do</span>
    it <span style="color:#b84">&#34;</span><span style="color:#b84">sends notification when new post is published</span><span style="color:#b84">&#34;</span> <span style="font-weight:bold">do</span>
      notification_spy <span style="font-weight:bold">=</span> class_spy(<span style="color:#b84">&#34;</span><span style="color:#b84">Invitation</span><span style="color:#b84">&#34;</span>)
      post <span style="font-weight:bold">=</span> <span style="color:#008080">Post</span><span style="font-weight:bold">.</span>new
      user <span style="font-weight:bold">=</span> <span style="color:#008080">User</span><span style="font-weight:bold">.</span>new
      blog <span style="font-weight:bold">=</span> <span style="color:#008080">Blog</span><span style="font-weight:bold">.</span>new(user)

      expect(notification_spy)<span style="font-weight:bold">.</span>to receive(<span style="color:#b84">:notify_subscribers</span>)<span style="font-weight:bold">.</span>with(post)<span style="font-weight:bold">.</span>and_return(<span style="font-weight:bold">true</span>)

      blog<span style="font-weight:bold">.</span>publish!(post)
    <span style="font-weight:bold">end</span>
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<h2 id="true-mock">(True) Mock</h2>
<p>Before we go over the true mock, we have to make sure we understand the
difference between &ldquo;mocking&rdquo;, &ldquo;the RSpec mock&rdquo; and a &ldquo;True Mock&rdquo;.</p>
<p>The whole issue behind the word <strong>mock</strong> is that in the beginning people
started using it for simillar (but not the same) things and the word got left
hanging in the air without a proper defnition.</p>
<p>So, &ldquo;mocking&rdquo; is usually used when thinking about creating objects that
simulate the behavior of real objects or units.</p>
<p>On the other hand, RSpec also has the concept of a mock. From RSpec's
documentation:</p>
<!-- raw HTML omitted -->
<p>As you can see, there's some nomenclature overlapping and/or disagreement.</p>
<p>Now, throw away any knowledge you have about the word <strong>mock</strong>. The True Mock
is a very interesting type of test object. Of course, it has all the
functionalities that a dummy, a stub and a spy have. And, a bit more.</p>
<p>The True Mock is an object that knows the flow of the method under test, and
the test can ask the mock if everything went well, usually called &ldquo;verifying&rdquo;.
This means that the test will rely on the True Mock to track what are the
effects of the method under test and what methods have been called.</p>
<p>Let's see an example. The code under test:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Blog</span>
  <span style="font-weight:bold">attr_reader</span> <span style="color:#b84">:published_posts</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">initialize</span> user
    @user <span style="font-weight:bold">=</span> user
  <span style="font-weight:bold">end</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">publish!</span> post
    published_posts <span style="font-weight:bold">&lt;&lt;</span> post <span style="font-weight:bold">if</span> @user<span style="font-weight:bold">.</span>can?(<span style="color:#b84">:publish</span>)
  <span style="font-weight:bold">end</span>

  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">delete</span> post
    post<span style="font-weight:bold">.</span>delete! <span style="font-weight:bold">if</span> @user<span style="font-weight:bold">.</span>can?(<span style="color:#b84">:delete</span>)
  <span style="font-weight:bold">end</span>

<span style="font-weight:bold">end</span></code></pre></div>
<h3 id="minitest-3">Minitest</h3>
<p>Minitest has this type of testing object - it's called (believe it or not) <code>Mock</code>.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">BlogTest</span> <span style="font-weight:bold">&lt;</span> <span style="color:#008080">Minitest</span><span style="font-weight:bold">::</span><span style="color:#008080">Test</span>
  <span style="font-weight:bold">def</span> <span style="color:#458;font-weight:bold"></span><span style="font-weight:bold"></span><span style="color:#900;font-weight:bold">test_post_deletion</span>
    user <span style="font-weight:bold">=</span> <span style="color:#008080">Minitest</span><span style="font-weight:bold">::</span><span style="color:#008080">Mock</span><span style="font-weight:bold">.</span>new
    post <span style="font-weight:bold">=</span> <span style="color:#008080">Minitest</span><span style="font-weight:bold">::</span><span style="color:#008080">Mock</span><span style="font-weight:bold">.</span>new
    blog <span style="font-weight:bold">=</span> <span style="color:#008080">Blog</span><span style="font-weight:bold">.</span>new(user)

    user<span style="font-weight:bold">.</span>expect <span style="color:#b84">:can?</span>, <span style="font-weight:bold">true</span>
    post<span style="font-weight:bold">.</span>expect <span style="color:#b84">:delete!</span>, <span style="font-weight:bold">true</span>

    blog<span style="font-weight:bold">.</span>delete(post)

    user<span style="font-weight:bold">.</span>verify
    post<span style="font-weight:bold">.</span>verify
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>We create new <code>Minitest::Mock</code> objects and we set an expectation that it should
receive the <code>can?</code> and <code>delete!</code> method, respectively. These will return
<code>true</code>. Although this seems like a stub (setting a return value), the last line
is what it differentiates it from a stub. The test asks the mocks to verify
that the expected method was called, which will result in the test
passing/failing.</p>
<h3 id="rspec-3">RSpec</h3>
<p>With RSpec, it's a bit different. RSpec does not have a <code>Mock</code> object, but it's
jack-of-all-trades <code>double</code> can do the same trick.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">describe <span style="color:#008080">Blog</span> <span style="font-weight:bold">do</span>
  it <span style="color:#b84">&#39;can remove a post&#39;</span> <span style="font-weight:bold">do</span>
    user <span style="font-weight:bold">=</span> double
    post <span style="font-weight:bold">=</span> double
    blog <span style="font-weight:bold">=</span> <span style="color:#008080">Blog</span><span style="font-weight:bold">.</span>new(user)

    expect(user)<span style="font-weight:bold">.</span>to receive(<span style="color:#b84">:can?</span>)<span style="font-weight:bold">.</span>with(<span style="color:#b84">:publish</span>)
    expect(user)<span style="font-weight:bold">.</span>to receive(<span style="color:#b84">:can?</span>)<span style="font-weight:bold">.</span>with(<span style="color:#b84">:delete</span>)
    expect(post)<span style="font-weight:bold">.</span>to receive(<span style="color:#b84">:delete!</span>)

    blog<span style="font-weight:bold">.</span>publish(post)
    blog<span style="font-weight:bold">.</span>delete(post)
  <span style="font-weight:bold">end</span>
<span style="font-weight:bold">end</span></code></pre></div>
<p>This is a bit ambigous, since it's half-way between spies and a true mock
objects.  But if you look in all the examples above, RSpec's <code>double</code> can morph
into anything. It all depends on the programmer what (s)he want's to use it as.
I guess that's why it's called <code>double</code>, because it can be any type of a test
double you want.</p>
<h2 id="fake">Fake</h2>
<p>Last but not least, the fake. The fake is basically a half-baked, half-working
implementation of the test object. It is not production ready, but, it's enough
functional for the test to use it.</p>
<p>The popular testing frameworks do not have the concept of a fake. This is due
to that writing the (needed) implementation for the fake is left for the
programmer to do.</p>
<p>You should avoid fakes because fakes are standalone objects which are not used
in the production code, but, they will grow linearly as the system grows. This
means that in the long run they can turn into code that will be very hard to
maintain.  Also, pretty much every test can be written with one of the
aforementioned testing objects. So, if you are ever using fakes, make sure you
know what you are getting into.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Now, that we got to the end, I hope that this article helped you understand the
theory behind test doubles and their implementations in Ruby. Be careful where
and how you use these test objects. If you go overboard you can create
isolation between your tests and your production code, which can render your
test suite useless.</p>
<p>Wow, you got to the very end. Thanks so much for reading!</p>
<script src="https://f.convertkit.com/ckjs/ck.5.js"></script>
      <form action="https://app.convertkit.com/forms/1215893/subscriptions" class="seva-form formkit-form" method="post" data-sv-form="1215893" data-uid="f786e71c27" data-format="inline" data-version="5" data-options="{&quot;settings&quot;:{&quot;after_subscribe&quot;:{&quot;action&quot;:&quot;message&quot;,&quot;success_message&quot;:&quot;Success! Now check your email to confirm your subscription.&quot;,&quot;redirect_url&quot;:&quot;&quot;},&quot;analytics&quot;:{&quot;google&quot;:null,&quot;facebook&quot;:null,&quot;segment&quot;:null,&quot;pinterest&quot;:null},&quot;modal&quot;:{&quot;trigger&quot;:&quot;timer&quot;,&quot;scroll_percentage&quot;:null,&quot;timer&quot;:5,&quot;devices&quot;:&quot;all&quot;,&quot;show_once_every&quot;:15},&quot;powered_by&quot;:{&quot;show&quot;:false,&quot;url&quot;:&quot;https://convertkit.com?utm_source=dynamic&amp;utm_medium=referral&amp;utm_campaign=poweredby&amp;utm_content=form&quot;},&quot;recaptcha&quot;:{&quot;enabled&quot;:false},&quot;return_visitor&quot;:{&quot;action&quot;:&quot;show&quot;,&quot;custom_content&quot;:&quot;&quot;},&quot;slide_in&quot;:{&quot;display_in&quot;:&quot;bottom_right&quot;,&quot;trigger&quot;:&quot;timer&quot;,&quot;scroll_percentage&quot;:null,&quot;timer&quot;:5,&quot;devices&quot;:&quot;all&quot;,&quot;show_once_every&quot;:15},&quot;sticky_bar&quot;:{&quot;display_in&quot;:&quot;top&quot;,&quot;trigger&quot;:&quot;timer&quot;,&quot;scroll_percentage&quot;:null,&quot;timer&quot;:5,&quot;devices&quot;:&quot;all&quot;,&quot;show_once_every&quot;:15}},&quot;version&quot;:&quot;5&quot;}" min-width="400 500 600 700 800" style="background-color: rgb(249, 250, 251); border-radius: 4px;"><div class="formkit-background" style="opacity: 0.2;"></div><div data-style="minimal"><div class="formkit-header" data-element="header" style="color: rgb(77, 77, 77); font-size: 27px; font-weight: 700;"><h1>Join the Newsletter</h1></div><div class="formkit-subheader" data-element="subheader" style="color: rgb(104, 104, 104); font-size: 18px;"><p>I write about backend technologies, programming and cloud architectures. Join hundreds of other developers that get my newsletter, once a month.</p></div><ul class="formkit-alert formkit-alert-error" data-element="errors" data-group="alert"></ul><div data-element="fields" data-stacked="false" class="seva-fields formkit-fields"><div class="formkit-field"><input class="formkit-input" name="email_address" placeholder="Your email address" required="" type="email" style="color: rgb(0, 0, 0); border-color: rgb(227, 227, 227); border-radius: 4px; font-weight: 400;"></div><button data-element="submit" class="formkit-submit formkit-submit" style="color: rgb(255, 255, 255); background-color: rgb(22, 119, 190); border-radius: 4px; font-weight: 400;"><div class="formkit-spinner"><div></div><div></div><div></div></div><span>Subscribe</span></button></div><div class="formkit-guarantee" data-element="guarantee" style="color: rgb(77, 77, 77); font-size: 13px; font-weight: 400;">

      <p>I respect your privacy. Never spam. Unsubscribe at any time.</p>
      <p>You can also subscribe <a href="/index.xml">via RSS</a> or <a href="https://t.me/ieftimovcom">to my Telegram channel</a>.</p>

      </div></div><style>.formkit-form[data-uid="f786e71c27"] *{box-sizing:border-box;}.formkit-form[data-uid="f786e71c27"]{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}.formkit-form[data-uid="f786e71c27"] legend{border:none;font-size:inherit;margin-bottom:10px;padding:0;position:relative;display:table;}.formkit-form[data-uid="f786e71c27"] fieldset{border:0;padding:0.01em 0 0 0;margin:0;min-width:0;}.formkit-form[data-uid="f786e71c27"] body:not(:-moz-handler-blocked) fieldset{display:table-cell;}.formkit-form[data-uid="f786e71c27"] h1,.formkit-form[data-uid="f786e71c27"] h2,.formkit-form[data-uid="f786e71c27"] h3,.formkit-form[data-uid="f786e71c27"] h4,.formkit-form[data-uid="f786e71c27"] h5,.formkit-form[data-uid="f786e71c27"] h6{color:inherit;font-size:inherit;font-weight:inherit;}.formkit-form[data-uid="f786e71c27"] p{color:inherit;font-size:inherit;font-weight:inherit;}.formkit-form[data-uid="f786e71c27"] ol:not([template-default]),.formkit-form[data-uid="f786e71c27"] ul:not([template-default]),.formkit-form[data-uid="f786e71c27"] blockquote:not([template-default]){text-align:left;}.formkit-form[data-uid="f786e71c27"] p:not([template-default]),.formkit-form[data-uid="f786e71c27"] hr:not([template-default]),.formkit-form[data-uid="f786e71c27"] blockquote:not([template-default]),.formkit-form[data-uid="f786e71c27"] ol:not([template-default]),.formkit-form[data-uid="f786e71c27"] ul:not([template-default]){color:inherit;font-style:initial;}.formkit-form[data-uid="f786e71c27"][data-format="modal"]{display:none;}.formkit-form[data-uid="f786e71c27"][data-format="slide in"]{display:none;}.formkit-form[data-uid="f786e71c27"] .formkit-input,.formkit-form[data-uid="f786e71c27"] .formkit-select,.formkit-form[data-uid="f786e71c27"] .formkit-checkboxes{width:100%;}.formkit-form[data-uid="f786e71c27"] .formkit-button,.formkit-form[data-uid="f786e71c27"] .formkit-submit{border:0;border-radius:5px;color:#ffffff;cursor:pointer;display:inline-block;text-align:center;font-size:15px;font-weight:500;cursor:pointer;margin-bottom:15px;overflow:hidden;padding:0;position:relative;vertical-align:middle;line-height:1.5;}.formkit-form[data-uid="f786e71c27"] .formkit-button:hover,.formkit-form[data-uid="f786e71c27"] .formkit-submit:hover,.formkit-form[data-uid="f786e71c27"] .formkit-button:focus,.formkit-form[data-uid="f786e71c27"] .formkit-submit:focus{outline:none;}.formkit-form[data-uid="f786e71c27"] .formkit-button:hover > span,.formkit-form[data-uid="f786e71c27"] .formkit-submit:hover > span,.formkit-form[data-uid="f786e71c27"] .formkit-button:focus > span,.formkit-form[data-uid="f786e71c27"] .formkit-submit:focus > span{background-color:rgba(0,0,0,0.1);}.formkit-form[data-uid="f786e71c27"] .formkit-button > span,.formkit-form[data-uid="f786e71c27"] .formkit-submit > span{display:block;-webkit-transition:all 300ms ease-in-out;transition:all 300ms ease-in-out;padding:12px 24px;}.formkit-form[data-uid="f786e71c27"] .formkit-input{background:#ffffff;font-size:15px;padding:12px;border:1px solid #e3e3e3;-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;line-height:1.4;margin:0;-webkit-transition:border-color ease-out 300ms;transition:border-color ease-out 300ms;}.formkit-form[data-uid="f786e71c27"] .formkit-input:focus{outline:none;border-color:#1677be;-webkit-transition:border-color ease 300ms;transition:border-color ease 300ms;}.formkit-form[data-uid="f786e71c27"] .formkit-input::-webkit-input-placeholder{color:inherit;opacity:0.8;}.formkit-form[data-uid="f786e71c27"] .formkit-input::-moz-placeholder{color:inherit;opacity:0.8;}.formkit-form[data-uid="f786e71c27"] .formkit-input:-ms-input-placeholder{color:inherit;opacity:0.8;}.formkit-form[data-uid="f786e71c27"] .formkit-input::placeholder{color:inherit;opacity:0.8;}.formkit-form[data-uid="f786e71c27"] [data-group="dropdown"]{position:relative;display:inline-block;width:100%;}.formkit-form[data-uid="f786e71c27"] [data-group="dropdown"]::before{content:"";top:calc(50% - 2.5px);right:10px;position:absolute;pointer-events:none;border-color:#4f4f4f transparent transparent transparent;border-style:solid;border-width:6px 6px 0 6px;height:0;width:0;z-index:999;}.formkit-form[data-uid="f786e71c27"] [data-group="dropdown"] select{height:auto;width:100%;cursor:pointer;color:#333333;line-height:1.4;margin-bottom:0;padding:0 6px;-webkit-appearance:none;-moz-appearance:none;appearance:none;font-size:15px;padding:12px;padding-right:25px;border:1px solid #e3e3e3;background:#ffffff;}.formkit-form[data-uid="f786e71c27"] [data-group="dropdown"] select:focus{outline:none;}.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"]{text-align:left;margin:0;}.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"] [data-group="checkbox"]{margin-bottom:10px;}.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"] [data-group="checkbox"] *{cursor:pointer;}.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"] [data-group="checkbox"]:last-of-type{margin-bottom:0;}.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"] [data-group="checkbox"] input[type="checkbox"]{display:none;}.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"] [data-group="checkbox"] input[type="checkbox"] + label::after{content:none;}.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"] [data-group="checkbox"] input[type="checkbox"]:checked + label::after{border-color:#ffffff;content:"";}.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"] [data-group="checkbox"] input[type="checkbox"]:checked + label::before{background:#10bf7a;border-color:#10bf7a;}.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"] [data-group="checkbox"] label{position:relative;display:inline-block;padding-left:28px;}.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"] [data-group="checkbox"] label::before,.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"] [data-group="checkbox"] label::after{position:absolute;content:"";display:inline-block;}.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"] [data-group="checkbox"] label::before{height:16px;width:16px;border:1px solid #e3e3e3;background:#ffffff;left:0px;top:3px;}.formkit-form[data-uid="f786e71c27"] [data-group="checkboxes"] [data-group="checkbox"] label::after{height:4px;width:8px;border-left:2px solid #4d4d4d;border-bottom:2px solid #4d4d4d;-webkit-transform:rotate(-45deg);-ms-transform:rotate(-45deg);transform:rotate(-45deg);left:4px;top:8px;}.formkit-form[data-uid="f786e71c27"] .formkit-alert{background:#f9fafb;border:1px solid #e3e3e3;border-radius:5px;-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;list-style:none;margin:25px auto;padding:12px;text-align:center;width:100%;}.formkit-form[data-uid="f786e71c27"] .formkit-alert:empty{display:none;}.formkit-form[data-uid="f786e71c27"] .formkit-alert-success{background:#d3fbeb;border-color:#10bf7a;color:#0c905c;}.formkit-form[data-uid="f786e71c27"] .formkit-alert-error{background:#fde8e2;border-color:#f2643b;color:#ea4110;}.formkit-form[data-uid="f786e71c27"] .formkit-spinner{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:0px;width:0px;margin:0 auto;position:absolute;top:0;left:0;right:0;width:0px;overflow:hidden;text-align:center;-webkit-transition:all 300ms ease-in-out;transition:all 300ms ease-in-out;}.formkit-form[data-uid="f786e71c27"] .formkit-spinner > div{margin:auto;width:12px;height:12px;background-color:#fff;opacity:0.3;border-radius:100%;display:inline-block;-webkit-animation:formkit-bouncedelay-formkit-form-data-uid-f786e71c27- 1.4s infinite ease-in-out both;animation:formkit-bouncedelay-formkit-form-data-uid-f786e71c27- 1.4s infinite ease-in-out both;}.formkit-form[data-uid="f786e71c27"] .formkit-spinner > div:nth-child(1){-webkit-animation-delay:-0.32s;animation-delay:-0.32s;}.formkit-form[data-uid="f786e71c27"] .formkit-spinner > div:nth-child(2){-webkit-animation-delay:-0.16s;animation-delay:-0.16s;}.formkit-form[data-uid="f786e71c27"] .formkit-submit[data-active] .formkit-spinner{opacity:1;height:100%;width:50px;}.formkit-form[data-uid="f786e71c27"] .formkit-submit[data-active] .formkit-spinner ~ span{opacity:0;}.formkit-form[data-uid="f786e71c27"] .formkit-powered-by[data-active="false"]{opacity:0.35;}@-webkit-keyframes formkit-bouncedelay-formkit-form-data-uid-f786e71c27-{0%,80%,100%{-webkit-transform:scale(0);-ms-transform:scale(0);transform:scale(0);}40%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1);}}@keyframes formkit-bouncedelay-formkit-form-data-uid-f786e71c27-{0%,80%,100%{-webkit-transform:scale(0);-ms-transform:scale(0);transform:scale(0);}40%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1);}}.formkit-form[data-uid="f786e71c27"] blockquote{padding:10px 20px;margin:0 0 20px;border-left:5px solid #e1e1e1;} .formkit-form[data-uid="f786e71c27"]{border:1px solid #e3e3e3;max-width:700px;position:relative;overflow:hidden;margin:0 auto;}.formkit-form[data-uid="f786e71c27"] .formkit-background{width:100%;height:100%;position:absolute;top:0;left:0;background-size:cover;background-position:center;opacity:0.3;z-index:1;}.formkit-form[data-uid="f786e71c27"] [data-style="minimal"]{padding:20px;width:100%;z-index:2;position:relative;}.formkit-form[data-uid="f786e71c27"] .formkit-header{margin:0 0 27px 0;text-align:center;}.formkit-form[data-uid="f786e71c27"] .formkit-subheader{margin:18px 0;text-align:center;}.formkit-form[data-uid="f786e71c27"] .formkit-guarantee{font-size:13px;margin:10px 0 15px 0;text-align:center;}.formkit-form[data-uid="f786e71c27"] .formkit-guarantee > p{margin:0;}.formkit-form[data-uid="f786e71c27"] .formkit-powered-by{color:#7d7d7d;display:block;font-size:12px;margin:10px 0 0 0;text-align:center;}.formkit-form[data-uid="f786e71c27"] .formkit-fields{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:25px auto 0 auto;}.formkit-form[data-uid="f786e71c27"] .formkit-field{min-width:220px;}.formkit-form[data-uid="f786e71c27"] .formkit-field,.formkit-form[data-uid="f786e71c27"] .formkit-submit{margin:0 0 15px 0;-webkit-flex:1 0 100%;-ms-flex:1 0 100%;flex:1 0 100%;}.formkit-form[data-uid="f786e71c27"][min-width~="600"] [data-style="minimal"]{}.formkit-form[data-uid="f786e71c27"][min-width~="600"] .formkit-fields[data-stacked="false"]{margin-left:-5px;margin-right:-5px;}.formkit-form[data-uid="f786e71c27"][min-width~="600"] .formkit-fields[data-stacked="false"] .formkit-field,.formkit-form[data-uid="f786e71c27"][min-width~="600"] .formkit-fields[data-stacked="false"] .formkit-submit{margin:0 5px 15px 5px;}.formkit-form[data-uid="f786e71c27"][min-width~="600"] .formkit-fields[data-stacked="false"] .formkit-field{-webkit-flex:100 1 auto;-ms-flex:100 1 auto;flex:100 1 auto;}.formkit-form[data-uid="f786e71c27"][min-width~="600"] .formkit-fields[data-stacked="false"] .formkit-submit{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;} </style></form>


			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="/tags/minitest">minitest</a></li>
							
							<li><a href="/tags/rspec">rspec</a></li>
							
							<li><a href="/tags/tdd">tdd</a></li>
							
							<li><a href="/tags/double">double</a></li>
							
							<li><a href="/tags/mock">mock</a></li>
							
							<li><a href="/tags/stub">stub</a></li>
							
							<li><a href="/tags/fake">fake</a></li>
							
							<li><a href="/tags/dummy">dummy</a></li>
							
						</ul>
					
				
			</div><div id="disqus_thread"></div>
<script type="text/javascript">
	(function () {
		
		
		if (window.location.hostname == "localhost")
			return;

		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		var disqus_shortname = 'eftimov';
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the </a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> Copyright  2014 - 2020 Ilija Eftimov |  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-11264459-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
