

<!DOCTYPE html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="true"
><head>
  <meta charset="utf-8" />
  
    <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Testing in Go: Fixtures &middot; Ilija Eftimov üë®‚ÄçüöÄ</title>
    <meta name="title" content="Testing in Go: Fixtures &middot; Ilija Eftimov üë®‚ÄçüöÄ" />
  
  <meta name="description" content="Documenting my experiences and learnings, with the goal of helping other software engineers on their journey" />
  
  
  
  <link rel="canonical" href="https://ieftimov.com/posts/testing-in-go-fixtures/" />
  
  
  
  
  
  
  
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.4801cb831d6359e43865e37733fc89df21983ad1c08157d4e17c36e09cb2501cdbd2e1dcde1db016cfa1554f175134d948555ab487816811cb9e93b19673ce89.css"
    integrity="sha512-SAHLgx1jWeQ4ZeN3M/yJ3yGYOtHAgVfU4Xw24JyyUBzb0uHc3h2wFs&#43;hVU8XUTTZSFVatIeBaBHLnpOxlnPOiQ=="
  />
  
  
  <script type="text/javascript" src="/js/appearance.min.badab316c9287a5a42a843e4eb45da65bb3d194a5a0f5fa4a3e516160e67df0b8c65f4f19a8e146436e29d583699e6cb41d6bbe99e05e1dbaa877763bad9f8e2.js" integrity="sha512-utqzFskoelpCqEPk60XaZbs9GUpaD1&#43;ko&#43;UWFg5n3wuMZfTxmo4UZDbinVg2mebLQda76Z4F4duqh3djutn44g=="></script>
  
    
    
    
  
  
    
    
  
  
  
    
    <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.15ae6e2c9b1ac24a9ccf40003fa689efb1a18db1ee9b73d780b01a6c31b150441415862513e93184f68fe385759e4698b8763cba6a0f79493c1fed99ad5868d4.js" integrity="sha512-Fa5uLJsawkqcz0AAP6aJ77GhjbHum3PXgLAabDGxUEQUFYYlE&#43;kxhPaP44V1nkaYuHY8umoPeUk8H&#43;2ZrVho1A==" data-copy="Copy" data-copied="Copied"></script>
  
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="Testing in Go: Fixtures" />
<meta property="og:description" content="When I was researching the topic of test fixtures, I couldn&rsquo;t find much about their beginnings." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ieftimov.com/posts/testing-in-go-fixtures/" /><meta property="og:image" content="https://ieftimov.com/cards/testing-in-go-fixtures.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-09-16T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-06-16T00:00:00+00:00" /><meta property="og:site_name" content="Ilija Eftimov üë®‚ÄçüöÄ" />

  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://ieftimov.com/cards/testing-in-go-fixtures.png"/>

<meta name="twitter:title" content="Testing in Go: Fixtures"/>
<meta name="twitter:description" content="When I was researching the topic of test fixtures, I couldn&rsquo;t find much about their beginnings."/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Testing in Go: Fixtures",
    "headline": "Testing in Go: Fixtures",
    
    "abstract": "When I was researching the topic of test fixtures, I couldn\u0026rsquo;t find much about their beginnings.",
    "inLanguage": "en",
    "url" : "https:\/\/ieftimov.com\/posts\/testing-in-go-fixtures\/",
    "author" : {
      "@type": "Person",
      "name": "Ilija Eftimov"
    },
    "copyrightYear": "2019",
    "dateCreated": "2019-09-16T00:00:00\u002b00:00",
    "datePublished": "2019-09-16T00:00:00\u002b00:00",
    
    "dateModified": "2021-06-16T00:00:00\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "2493"
  }]
  </script>


  
  <meta name="author" content="Ilija Eftimov" />
  
    
      <link href="https://twitter.com/ilijaio" rel="me" />
    
      <link href="https://www.linkedin.com/in/ieftimov/" rel="me" />
    
      <link href="mailto:blog@ieftimov.com" rel="me" />
    
      <link href="https://captainscodebook.com" rel="me" />
    
      <link href="https://dev.to/fteem" rel="me" />
    
      <link href="https://github.com/fteem" rel="me" />
    
      <link href="https://t.me/ieftimovcom" rel="me" />
    
  
  
  






  
  <script async defer data-domain="ieftimov.com" src="https://plausible.io/js/plausible.js"></script>

  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0"
        href="#main-content"
        ><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400"
          >&darr;</span
        >Skip to main content</a
      >
    </div>
    
    
      <header class="py-6 font-semibold sm:py-10 text-neutral-900 dark:text-neutral print:hidden">
  <nav class="flex justify-between">
    
    <div>
      
        <a
          class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
          rel="me"
          href="/"
          >Ilija Eftimov üë®‚ÄçüöÄ</a
        >
      

    </div>
    
    
      <ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row">
        
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/"
                title=""
                >Home</a
              >
            </li>
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="/posts/"
                title="Posts"
                >Essays</a
              >
            </li>
          
            <li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
                href="https://captainscodebook.com"
                title=""
                >Subscribe</a
              >
            </li>
          
        
        
          <li class="ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
            <button
              id="search-button"
              class="text-base hover:text-primary-600 dark:hover:text-primary-400"
              title="Search (/)"
            >
              

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
          </li>
        
      </ul>
    
  </nav>
</header>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  <article>
    <header class="max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Testing in Go: Fixtures
      </h1>
      <div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
    
  

  

  

  
    
  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2019-09-16 00:00:00 &#43;0000 UTC">16 September 2019</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">12 mins</span>
    

    
    
  </div>

  
  


      </div>
    </header>
    <section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert">
      
        <div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last">
          <div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden">
            <details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700"
  >
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"
  >
    <nav id="TableOfContents">
  <ul>
    <li><a href="#making-a-simple-grade-book">Making a simple grade book</a></li>
    <li><a href="#testing-the-builder-function">Testing the builder function</a></li>
    <li><a href="#testing-the-findbystudent-function">Testing the <code>FindByStudent</code> function</a></li>
    <li><a href="#tidying-up-our-tests">Tidying up our tests</a></li>
  </ul>
</nav>
  </div>
</details>

          </div>
        </div>
      
      <div class="min-w-0 min-h-0 max-w-prose">
        <p>When I was researching the topic of test fixtures, I couldn&rsquo;t find much about
their beginnings. My first search was about the name of the person who coined
&ldquo;test fixtures&rdquo;. Unfortunately, that was not a fruitful endeavor. The next
logical step was to look for the etymology of the phrase &ldquo;test fixtures&rdquo;, but
the only search result that made sense was a <a href="https://en.wikipedia.org/wiki/Test_fixture">Wikipedia
page</a> on the topic.</p>
<p>Judging by the Wiki page, it&rsquo;s clear that Ruby on Rails has heavily popularized
test fixtures as a concept. Likely though, folks that have been in the industry
for a longer time will say that the idea of test fixtures is older than Rails
itself.</p>
<p>Test fixtures contribute to setting up the system for the testing process by
providing it with all the necessary data for initialization. The setup using
fixtures is done to satisfy any preconditions there may be for the code under
test. For example, code that we want to test might require some configuration
before being executed or tested. In such cases, we would have to recreate these
preconditions to run the code every time we have to test the code.</p>
<p>More annoyingly, if the configuration of the tested code would change, we would
have to update the configuration structure everywhere where we test that
particular code.</p>
<p>To avoid such scenarios, we use fixtures. Fixtures allow us to <em>reliably</em> and
<em>repeatably</em> create the state our code relies on upon without worrying about
the details. When the required state of the code under test changes, we need to
tweak a fixture instead of scouring all tests for the code that needs changing.</p>
<p>I know, I know. My introduction made you dizzy from all the praise of fixtures.
So let&rsquo;s stop the sales pitch here and move on to see how simple fixtures can
be and how you can master them as another tool in your testing tool belt.</p>
<h2 id="making-a-simple-grade-book" class="relative group">Making a simple grade book <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#making-a-simple-grade-book" aria-label="Anchor">#</a></span></h2>
<p>As always, when talking about code without having code to look at is not great.
Let&rsquo;s introduce an example representing a grade book populated from a CSV file,
using a builder function. After, we will create a lookup method per column and
add some tests for both functions.</p>
<div class="highlight"><pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">type</span> Record <span style="color:#81a1c1;font-weight:bold">struct</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>	student <span style="color:#81a1c1">string</span>
</span></span><span style="display:flex;"><span>	subject <span style="color:#81a1c1">string</span>
</span></span><span style="display:flex;"><span>	grade   <span style="color:#81a1c1">string</span>
</span></span><span style="display:flex;"><span><span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">type</span> Gradebook <span style="color:#eceff4">[]</span>Record
</span></span></code></pre></div><p>The <code>Record</code> type will have three attributes: <code>student</code>, <code>subject</code> and <code>grade</code>,
all three of type <code>string</code>. The <code>Gradebook</code> type is just a slice of <code>Record</code>s,
nothing more.</p>
<p>Next, let&rsquo;s create a builder function for a <code>Gradebook</code>. We want the function
to be simple - receive a path to a CSV file as an argument and return a
<code>Gradebook</code> with all of the records parsed from the CSV.</p>
<div class="highlight"><pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">func</span> <span style="color:#88c0d0">NewGradebook</span><span style="color:#eceff4">(</span>csvFile io<span style="color:#eceff4">.</span>Reader<span style="color:#eceff4">)</span> <span style="color:#eceff4">(</span>Gradebook<span style="color:#eceff4">,</span> <span style="color:#81a1c1">error</span><span style="color:#eceff4">)</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">var</span> gradebook Gradebook
</span></span><span style="display:flex;"><span>	reader <span style="color:#81a1c1">:=</span> csv<span style="color:#eceff4">.</span><span style="color:#88c0d0">NewReader</span><span style="color:#eceff4">(</span>csvFile<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">for</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>		line<span style="color:#eceff4">,</span> err <span style="color:#81a1c1">:=</span> reader<span style="color:#eceff4">.</span><span style="color:#88c0d0">Read</span><span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">if</span> err <span style="color:#81a1c1">==</span> io<span style="color:#eceff4">.</span>EOF <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#81a1c1;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">if</span> err <span style="color:#81a1c1">!=</span> <span style="color:#81a1c1;font-weight:bold">nil</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#81a1c1;font-weight:bold">return</span> gradebook<span style="color:#eceff4">,</span> err
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">if</span> <span style="color:#81a1c1">len</span><span style="color:#eceff4">(</span>line<span style="color:#eceff4">)</span> <span style="color:#eceff4">&lt;</span> <span style="color:#b48ead">3</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#81a1c1;font-weight:bold">return</span> gradebook<span style="color:#eceff4">,</span> fmt<span style="color:#eceff4">.</span><span style="color:#88c0d0">Errorf</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;Invalid file structure&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		gradebook <span style="color:#eceff4">=</span> <span style="color:#81a1c1">append</span><span style="color:#eceff4">(</span>gradebook<span style="color:#eceff4">,</span> Record<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			student<span style="color:#eceff4">:</span> line<span style="color:#eceff4">[</span><span style="color:#b48ead">0</span><span style="color:#eceff4">],</span>
</span></span><span style="display:flex;"><span>			subject<span style="color:#eceff4">:</span> line<span style="color:#eceff4">[</span><span style="color:#b48ead">1</span><span style="color:#eceff4">],</span>
</span></span><span style="display:flex;"><span>			grade<span style="color:#eceff4">:</span>   line<span style="color:#eceff4">[</span><span style="color:#b48ead">2</span><span style="color:#eceff4">],</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">})</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">return</span> gradebook<span style="color:#eceff4">,</span> <span style="color:#81a1c1;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span><span style="color:#eceff4">}</span>
</span></span></code></pre></div><p>Although a bit bloated, the function doesn&rsquo;t do much. It receives an
<code>io.Reader</code> as an argument (which is the file reader), wraps it in a CSV
reader, and reads it line by line. For each line it reads, it will create a new
<code>Record</code> struct and <code>append</code> it to the collection of <code>Record</code>&rsquo;s <code>gradebook</code>.
After parsing the whole file, it will exit the loop and return the grade book.</p>
<p>Of course, in true Go fashion, we gracefully handle the errors in every step of
the reading and parsing the file. If there&rsquo;s an error in any scenario, the
function will return the error along with the empty <code>gradebook</code>.</p>
<p>The last piece of the puzzle is the function that will find all records in the
grade book for a particular student:</p>
<div class="highlight"><pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">func</span> <span style="color:#eceff4">(</span>gb <span style="color:#81a1c1">*</span>Gradebook<span style="color:#eceff4">)</span> <span style="color:#88c0d0">FindByStudent</span><span style="color:#eceff4">(</span>student <span style="color:#81a1c1">string</span><span style="color:#eceff4">)</span> <span style="color:#eceff4">[]</span>Record <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">var</span> records <span style="color:#eceff4">[]</span>Record
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">for</span> _<span style="color:#eceff4">,</span> record <span style="color:#81a1c1">:=</span> <span style="color:#81a1c1;font-weight:bold">range</span> <span style="color:#81a1c1">*</span>gb <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">if</span> student <span style="color:#81a1c1">==</span> record<span style="color:#eceff4">.</span>student <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			records <span style="color:#eceff4">=</span> <span style="color:#81a1c1">append</span><span style="color:#eceff4">(</span>records<span style="color:#eceff4">,</span> record<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">return</span> records
</span></span><span style="display:flex;"><span><span style="color:#eceff4">}</span>
</span></span></code></pre></div><p>The <code>FindByStudent</code> function takes the <code>student</code> name as argument. First, it
will loop through the <code>Gradebook</code>&rsquo;s records and collect the records where the
student name matches. Then, it will return the records found for the particular
<code>student</code> name.</p>
<p>To manually test the code, let&rsquo;s create a small CSV file, called <code>grades.csv</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>Jane<span style="color:#eceff4">,</span>Chemistry<span style="color:#eceff4">,</span>A
</span></span><span style="display:flex;"><span>John<span style="color:#eceff4">,</span>Biology<span style="color:#eceff4">,</span>A
</span></span><span style="display:flex;"><span>Jane<span style="color:#eceff4">,</span>Algebra<span style="color:#eceff4">,</span>B
</span></span><span style="display:flex;"><span>Jane<span style="color:#eceff4">,</span>Biology<span style="color:#eceff4">,</span>A
</span></span><span style="display:flex;"><span>John<span style="color:#eceff4">,</span>Algebra<span style="color:#eceff4">,</span>B
</span></span><span style="display:flex;"><span>John<span style="color:#eceff4">,</span>Chemistry<span style="color:#eceff4">,</span>C
</span></span></code></pre></div><p>In the <code>main</code> function of the file, we will parse it and then get all of Jane&rsquo;s
grades:</p>
<div class="highlight"><pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">func</span> <span style="color:#88c0d0">main</span><span style="color:#eceff4">()</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>	csvFile<span style="color:#eceff4">,</span> err <span style="color:#81a1c1">:=</span> os<span style="color:#eceff4">.</span><span style="color:#88c0d0">Open</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;grades.csv&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">if</span> err <span style="color:#81a1c1">!=</span> <span style="color:#81a1c1;font-weight:bold">nil</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>		fmt<span style="color:#eceff4">.</span><span style="color:#88c0d0">Println</span><span style="color:#eceff4">(</span>fmt<span style="color:#eceff4">.</span><span style="color:#88c0d0">Errorf</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;error opening file: %v&#34;</span><span style="color:#eceff4">,</span> err<span style="color:#eceff4">))</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>	grades<span style="color:#eceff4">,</span> err <span style="color:#81a1c1">:=</span> <span style="color:#88c0d0">NewGradebook</span><span style="color:#eceff4">(</span>csvFile<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	fmt<span style="color:#eceff4">.</span><span style="color:#88c0d0">Printf</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;%+v\n&#34;</span><span style="color:#eceff4">,</span> grades<span style="color:#eceff4">.</span><span style="color:#88c0d0">FindByStudent</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;Jane&#34;</span><span style="color:#eceff4">))</span>
</span></span><span style="display:flex;"><span><span style="color:#eceff4">}</span>
</span></span></code></pre></div><p>The output of the function will be:</p>
<div class="highlight"><pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ go run grades.go
</span></span><span style="display:flex;"><span><span style="color:#81a1c1">[{</span>student:Jane subject:Chemistry grade:A<span style="color:#81a1c1">}</span> <span style="color:#81a1c1">{</span>student:Jane subject:Algebra grade:B<span style="color:#81a1c1">}</span> <span style="color:#81a1c1">{</span>student:Jane subject:Biology grade:A<span style="color:#81a1c1">}]</span>
</span></span></code></pre></div><p>From the output, it is clear what are Jane&rsquo;s grades in the grade book we have
created. Having these two types and two functions is good enough to explain how
we can use fixtures in the testing we&rsquo;re about to do.</p>
<h2 id="testing-the-builder-function" class="relative group">Testing the builder function <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#testing-the-builder-function" aria-label="Anchor">#</a></span></h2>
<p>Whenever we need to test a piece of code, we have to identify its key
components. In other words, we have to understand the essential steps that that
code takes to accomplish its mission. For example, to test the <code>NewGradebook</code>
function, an overly simplified breakdown of its doings would look like:</p>
<ol>
<li>Read through each of the lines of the CSV</li>
<li>When reading through each line, create a new struct from the data</li>
<li>Put the new struct in the collection of structs</li>
<li>Return the collection of structs</li>
</ol>
<p>Now, there&rsquo;s no need to test if opening a file and parsing it works - we trust
Go to take care of that. So instead, we are interested in two things: will our
function handle invalid CSV files gracefully, and will it create a <code>Gradebook</code>
that we expect from a valid file?</p>
<p>To test the error handling, we will introduce a test function:</p>
<div class="highlight"><pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">func</span> <span style="color:#88c0d0">TestNewGradebook_ErrorHandling</span><span style="color:#eceff4">(</span>t <span style="color:#81a1c1">*</span>testing<span style="color:#eceff4">.</span>T<span style="color:#eceff4">)</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>	cases <span style="color:#81a1c1">:=</span> <span style="color:#eceff4">[]</span><span style="color:#81a1c1;font-weight:bold">struct</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>		fixture   <span style="color:#81a1c1">string</span>
</span></span><span style="display:flex;"><span>		returnErr <span style="color:#81a1c1">bool</span>
</span></span><span style="display:flex;"><span>		name      <span style="color:#81a1c1">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			fixture<span style="color:#eceff4">:</span>   <span style="color:#a3be8c">&#34;testdata/grades/empty.csv&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			returnErr<span style="color:#eceff4">:</span> <span style="color:#81a1c1;font-weight:bold">false</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			name<span style="color:#eceff4">:</span>      <span style="color:#a3be8c">&#34;EmptyFile&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			fixture<span style="color:#eceff4">:</span>   <span style="color:#a3be8c">&#34;testdata/grades/invalid.csv&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			returnErr<span style="color:#eceff4">:</span> <span style="color:#81a1c1;font-weight:bold">true</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			name<span style="color:#eceff4">:</span>      <span style="color:#a3be8c">&#34;InvalidFile&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			fixture<span style="color:#eceff4">:</span>   <span style="color:#a3be8c">&#34;testdata/grades/valid.csv&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			returnErr<span style="color:#eceff4">:</span> <span style="color:#81a1c1;font-weight:bold">false</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			name<span style="color:#eceff4">:</span>      <span style="color:#a3be8c">&#34;ValidFile&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">for</span> _<span style="color:#eceff4">,</span> tc <span style="color:#81a1c1">:=</span> <span style="color:#81a1c1;font-weight:bold">range</span> cases <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>		t<span style="color:#eceff4">.</span><span style="color:#88c0d0">Run</span><span style="color:#eceff4">(</span>tc<span style="color:#eceff4">.</span>name<span style="color:#eceff4">,</span> <span style="color:#81a1c1;font-weight:bold">func</span><span style="color:#eceff4">(</span>t <span style="color:#81a1c1">*</span>testing<span style="color:#eceff4">.</span>T<span style="color:#eceff4">)</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			_<span style="color:#eceff4">,</span> err <span style="color:#81a1c1">:=</span> <span style="color:#88c0d0">NewGradebook</span><span style="color:#eceff4">(</span>tc<span style="color:#eceff4">.</span>fixture<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>			returnedErr <span style="color:#81a1c1">:=</span> err <span style="color:#81a1c1">!=</span> <span style="color:#81a1c1;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#81a1c1;font-weight:bold">if</span> returnedErr <span style="color:#81a1c1">!=</span> tc<span style="color:#eceff4">.</span>returnErr <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>				t<span style="color:#eceff4">.</span><span style="color:#88c0d0">Fatalf</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;Expected returnErr: %v, got: %v&#34;</span><span style="color:#eceff4">,</span> tc<span style="color:#eceff4">.</span>returnErr<span style="color:#eceff4">,</span> returnedErr<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>			<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">})</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span><span style="color:#eceff4">}</span>
</span></span></code></pre></div><p>To run these test cases, we will need three accompanying CSV files in the root
of our project: <code>empty.csv</code>, <code>invalid.csv</code> and <code>valid.csv</code>. An empty CSV, an
invalid CSV and a valid CSV file, respectively.</p>
<p>Each of these files is fixtures - files that go together with the test suite,
enabling us to assume the state of the system that we run our tests on. Now,
the content of these files should be evident from the file names. The
<code>invalid.csv</code> will contain just text, but not in a CSV format. The <code>empty.csv</code>
will be just an empty file, while the <code>valid.csv</code> file will be a real CSV that
our function can parse and use. Lastly, the <code>nonexisting.csv</code> actually will not
be a file ‚Äì we want our tests to fail when this path is passed to the
<code>NewGradebook</code> function. And this is the first thing we need to remember about
fixtures: we can (and should) create as many fixture files as it makes sense,
but not more.</p>
<p>Fixtures should always be placed in a directory (in our example <code>testdata</code>) at
the root of our project. We should always put our fixtures in the <code>testdata</code>
directory at the root of our project because <code>go test</code> will ignore that path
when building our packages. Quoting the output of <code>go help test</code>:</p>
<blockquote>
<p>The go tool will ignore a directory named &ldquo;testdata&rdquo;, making it available
to hold ancillary data needed by the tests.</p>
</blockquote>
<p>Placing it in the root of the package works great because when we run <code>go test</code>, for each package in the directory tree, <code>go test</code> will execute the test
binary with its working directory set to the source directory of the package
under test. (Read more about it in <a href="https://dave.cheney.net/2016/05/10/test-fixtures-in-go">Dave Cheney&rsquo;s
article</a> on the topic.)</p>
<p>In the example above, we used two nested directories: <code>testdata</code> and <code>grades</code>.
We use two nested directories because we want to logically group our fixtures
and leave the room for another kind of fixtures within the same project if need
be. Software is built to grow, so why not set some sane defaults from the
start.</p>
<h2 id="testing-the-findbystudent-function" class="relative group">Testing the <code>FindByStudent</code> function <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#testing-the-findbystudent-function" aria-label="Anchor">#</a></span></h2>
<p>The functionality of the <code>FindByStudent</code> function is a linear search through a
<code>Gradebook</code> type (which is a slice of <code>Record</code>&rsquo;s). It compares the student name
from the argument and the name of each of the records in the <code>Gradebook</code>. When
a match is found, the matching record is added to the collection <code>records</code>.</p>
<p>Testing this function is can be based on a couple of state assumptions. The
first one is to test <code>FindByStudent</code> we have to have a <code>Gradebook</code> available.
The <code>Gradebook</code> can be in three states: empty, without a matching <code>Record</code>, and
with a <code>Record</code> that matches the student name from the argument. If we flipped
this on its head, it would mean that to test the function, we will need three
different <code>Gradebooks</code>: one empty, one without a matching <code>Record</code>, and one
with a matching <code>Record</code>.</p>
<p>To create such <code>Gradebook</code>&rsquo;s, we can take two different approaches: define the
<code>Gradebook</code>&rsquo;s directly in the test or use a fixture file. Using the first
approach might be preferable, but we will use the second approach to see how we
can use fixtures. While we already have the fixture files from the previous
test, we can use them in the test of the <code>FindByStudent</code> function:</p>
<div class="highlight"><pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">func</span> <span style="color:#88c0d0">TestFindByStudent</span><span style="color:#eceff4">(</span>t <span style="color:#81a1c1">*</span>testing<span style="color:#eceff4">.</span>T<span style="color:#eceff4">)</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>	cases <span style="color:#81a1c1">:=</span> <span style="color:#eceff4">[]</span><span style="color:#81a1c1;font-weight:bold">struct</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>		fixture <span style="color:#81a1c1">string</span>
</span></span><span style="display:flex;"><span>		student <span style="color:#81a1c1">string</span>
</span></span><span style="display:flex;"><span>		want    Gradebook
</span></span><span style="display:flex;"><span>		name    <span style="color:#81a1c1">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			fixture<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;fixtures/grades/empty.csv&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			student<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;Jane&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			want<span style="color:#eceff4">:</span>    Gradebook<span style="color:#eceff4">{},</span>
</span></span><span style="display:flex;"><span>			name<span style="color:#eceff4">:</span>    <span style="color:#a3be8c">&#34;EmptyFixture&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			fixture<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;fixtures/grades/valid.csv&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			student<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;Jane&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			want<span style="color:#eceff4">:</span> Gradebook<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>				Record<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>					student<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;Jane&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>					subject<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;Chemistry&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>					grade<span style="color:#eceff4">:</span>   <span style="color:#a3be8c">&#34;A&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>				<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>				Record<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>					student<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;Jane&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>					subject<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;Algebra&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>					grade<span style="color:#eceff4">:</span>   <span style="color:#a3be8c">&#34;A&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>				<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>			<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>                        name<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;ValidFixtures&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">for</span> _<span style="color:#eceff4">,</span> tc <span style="color:#81a1c1">:=</span> <span style="color:#81a1c1;font-weight:bold">range</span> cases <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>		t<span style="color:#eceff4">.</span><span style="color:#88c0d0">Run</span><span style="color:#eceff4">(</span>tc<span style="color:#eceff4">.</span>name<span style="color:#eceff4">,</span> <span style="color:#81a1c1;font-weight:bold">func</span><span style="color:#eceff4">(</span>t <span style="color:#81a1c1">*</span>testing<span style="color:#eceff4">.</span>T<span style="color:#eceff4">)</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			gradebook<span style="color:#eceff4">,</span> err <span style="color:#81a1c1">:=</span> <span style="color:#88c0d0">NewGradebook</span><span style="color:#eceff4">(</span>tc<span style="color:#eceff4">.</span>fixture<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>			<span style="color:#81a1c1;font-weight:bold">if</span> err <span style="color:#81a1c1">!=</span> <span style="color:#81a1c1;font-weight:bold">nil</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>				t<span style="color:#eceff4">.</span><span style="color:#88c0d0">Fatalf</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;Cannot create gradebook: %v&#34;</span><span style="color:#eceff4">,</span> err<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>			<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			got <span style="color:#81a1c1">:=</span> gradebook<span style="color:#eceff4">.</span><span style="color:#88c0d0">FindByStudent</span><span style="color:#eceff4">(</span>tc<span style="color:#eceff4">.</span>student<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>			<span style="color:#81a1c1;font-weight:bold">for</span> idx<span style="color:#eceff4">,</span> gotGrade <span style="color:#81a1c1">:=</span> <span style="color:#81a1c1;font-weight:bold">range</span> got <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>				wantedGrade <span style="color:#81a1c1">:=</span> tc<span style="color:#eceff4">.</span>want<span style="color:#eceff4">[</span>idx<span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>				<span style="color:#81a1c1;font-weight:bold">if</span> gotGrade <span style="color:#81a1c1">!=</span> wantedGrade <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>					t<span style="color:#eceff4">.</span><span style="color:#88c0d0">Errorf</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;Expected: %v, got: %v&#34;</span><span style="color:#eceff4">,</span> wantedGrade<span style="color:#eceff4">,</span> gotGrade<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>				<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">})</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#eceff4">}</span>
</span></span></code></pre></div><p>In this test function, we have defined two test cases: the first one uses the
<code>empty.csv</code> fixture, while the other uses the <code>valid.csv</code> fixture. By looking
at the test cases, it is clear what we expect to get from each one. For
example, when working with the empty CSV, we hope to get a blank grade book -
no grades, no grade book. But, on the other hand, when working with the
<code>valid.csv</code> we expect to get a <code>Gradebook</code>, with all student grades specified.</p>
<p>The test function does not have any magic. It merely builds a <code>Gradebook</code> using
the <code>NewGradebook</code> function and the fixture file. Then, we invoke the
<code>FindByStudent</code> function on the <code>Gradebook</code>, and we make sure that all of the
grades that we got are the ones we expected.</p>
<p>If we run the test, we&rsquo;ll get an output looking like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ go <span style="color:#81a1c1">test</span> -v -run<span style="color:#81a1c1">=</span>TestFindByStudent
</span></span><span style="display:flex;"><span><span style="color:#81a1c1">===</span> RUN   TestFindByStudent
</span></span><span style="display:flex;"><span><span style="color:#81a1c1">===</span> RUN   TestFindByStudent/EmptyFixture
</span></span><span style="display:flex;"><span><span style="color:#81a1c1">===</span> RUN   TestFindByStudent/ValidFixture
</span></span><span style="display:flex;"><span>--- PASS: TestFindByStudent <span style="color:#81a1c1">(</span>0.00s<span style="color:#81a1c1">)</span>
</span></span><span style="display:flex;"><span>    --- PASS: TestFindByStudent/EmptyFixture <span style="color:#81a1c1">(</span>0.00s<span style="color:#81a1c1">)</span>
</span></span><span style="display:flex;"><span>    --- PASS: TestFindByStudent/ValidFixture <span style="color:#81a1c1">(</span>0.00s<span style="color:#81a1c1">)</span>
</span></span><span style="display:flex;"><span>PASS
</span></span><span style="display:flex;"><span>ok  	_/Users/Ilija/Documents/fixtures	0.004s
</span></span></code></pre></div><p>The tests pass - building the <code>Gradebook</code>s with the fixtures worked well, so we
could <code>range</code> over the test cases and test our expectations.</p>
<h2 id="tidying-up-our-tests" class="relative group">Tidying up our tests <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#tidying-up-our-tests" aria-label="Anchor">#</a></span></h2>
<p>Looking at both test functions that we wrote at the beginning of the <code>t.Run</code>
blocks, we can notice that we have to create a new <code>Gradebook</code> using the
<code>NewGradebook</code> builder function. In essence, this is the test setup in these
two test functions - we have to have an instance of the <code>Gradebook</code> type to run
our tests.</p>
<p>When we use fixtures, the failure to use a fixture can mean that we can&rsquo;t run
the tests - they depend on the fixture files being available and usable. If the
fixture renders to be unusable, we have to stop the tests further and bail out
with an error.</p>
<p>It is a quick win to extract a test helper to use in the test setup for such
reasons. We can extract all error handling for loading the fixture and test
setup outside of the test functions. Let&rsquo;s create a small function that will do
just that:</p>
<div class="highlight"><pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">func</span> <span style="color:#88c0d0">buildGradebook</span><span style="color:#eceff4">(</span>t <span style="color:#81a1c1">*</span>testing<span style="color:#eceff4">.</span>T<span style="color:#eceff4">,</span> path <span style="color:#81a1c1">string</span><span style="color:#eceff4">)</span> <span style="color:#81a1c1">*</span>Gradebook <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>	gradebook<span style="color:#eceff4">,</span> err <span style="color:#81a1c1">:=</span> <span style="color:#88c0d0">NewGradebook</span><span style="color:#eceff4">(</span>path<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">if</span> err <span style="color:#81a1c1">!=</span> <span style="color:#81a1c1;font-weight:bold">nil</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>		t<span style="color:#eceff4">.</span><span style="color:#88c0d0">Fatalf</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;Cannot create Gradebook: %v&#34;</span><span style="color:#eceff4">,</span> err<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">return</span> <span style="color:#81a1c1">&amp;</span>gradebook
</span></span><span style="display:flex;"><span><span style="color:#eceff4">}</span>
</span></span></code></pre></div><p>The <code>buildGradebook</code> is simply a wrapper around the call to <code>NewGradebook</code>,
with one key difference: if a <code>Gradebook</code> cannot be produced using
<code>NewGradebook</code> it will mark the test as failed. Signaling the failure is done
using <code>t.Fatalf</code>, where instead of returning an empty <code>Gradebook</code>, we
immediately make the test fail. In other words: being unable to create a
<code>Gradebook</code> is an unrecoverable error. A nice side-effect is that the caller
function of <code>buildGradebook</code> does not need to handle the error that might be
returned from <code>NewGradebook</code> - that will all be handled by <code>buildGradebook</code>.</p>
<p>If we revisit our <code>TestFindByStudent</code> function now, it will not have changed
much. Still, it will contain the improvements coming from the <code>buildGradebook</code>
function:</p>
<div class="highlight"><pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">func</span> <span style="color:#88c0d0">TestFindByStudent</span><span style="color:#eceff4">(</span>t <span style="color:#81a1c1">*</span>testing<span style="color:#eceff4">.</span>T<span style="color:#eceff4">)</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>	cases <span style="color:#81a1c1">:=</span> <span style="color:#eceff4">[]</span><span style="color:#81a1c1;font-weight:bold">struct</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>		fixture <span style="color:#81a1c1">string</span>
</span></span><span style="display:flex;"><span>		student <span style="color:#81a1c1">string</span>
</span></span><span style="display:flex;"><span>		want    Gradebook
</span></span><span style="display:flex;"><span>		name    <span style="color:#81a1c1">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			fixture<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;fixtures/grades/empty.csv&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			student<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;Jane&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			want<span style="color:#eceff4">:</span>    Gradebook<span style="color:#eceff4">{},</span>
</span></span><span style="display:flex;"><span>			name<span style="color:#eceff4">:</span>    <span style="color:#a3be8c">&#34;EmptyFixture&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">{</span> fixture<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;fixtures/grades/valid.csv&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			student<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;Jane&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>			want<span style="color:#eceff4">:</span> Gradebook<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>				Record<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>					student<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;Jane&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>					subject<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;Chemistry&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>					grade<span style="color:#eceff4">:</span>   <span style="color:#a3be8c">&#34;A&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>				<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>				Record<span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>					student<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;Jane&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>					subject<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;Algebra&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>					grade<span style="color:#eceff4">:</span>   <span style="color:#a3be8c">&#34;A&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>				<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>			<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>			name<span style="color:#eceff4">:</span> <span style="color:#a3be8c">&#34;ValidFixture&#34;</span><span style="color:#eceff4">,</span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">},</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">for</span> _<span style="color:#eceff4">,</span> tc <span style="color:#81a1c1">:=</span> <span style="color:#81a1c1;font-weight:bold">range</span> cases <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>		t<span style="color:#eceff4">.</span><span style="color:#88c0d0">Run</span><span style="color:#eceff4">(</span>tc<span style="color:#eceff4">.</span>name<span style="color:#eceff4">,</span> <span style="color:#81a1c1;font-weight:bold">func</span><span style="color:#eceff4">(</span>t <span style="color:#81a1c1">*</span>testing<span style="color:#eceff4">.</span>T<span style="color:#eceff4">)</span> <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>			gradebook <span style="color:#81a1c1">:=</span> <span style="color:#88c0d0">buildGradebook</span><span style="color:#eceff4">(</span>t<span style="color:#eceff4">,</span> tc<span style="color:#eceff4">.</span>fixture<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			got <span style="color:#81a1c1">:=</span> gradebook<span style="color:#eceff4">.</span><span style="color:#88c0d0">FindByStudent</span><span style="color:#eceff4">(</span>tc<span style="color:#eceff4">.</span>student<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>			<span style="color:#81a1c1;font-weight:bold">for</span> idx<span style="color:#eceff4">,</span> gotGrade <span style="color:#81a1c1">:=</span> <span style="color:#81a1c1;font-weight:bold">range</span> got <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>				wantedGrade <span style="color:#81a1c1">:=</span> tc<span style="color:#eceff4">.</span>want<span style="color:#eceff4">[</span>idx<span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>				<span style="color:#81a1c1;font-weight:bold">if</span> gotGrade <span style="color:#81a1c1">!=</span> wantedGrade <span style="color:#eceff4">{</span>
</span></span><span style="display:flex;"><span>					t<span style="color:#eceff4">.</span><span style="color:#88c0d0">Errorf</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;Expected: %v, got: %v&#34;</span><span style="color:#eceff4">,</span> wantedGrade<span style="color:#eceff4">,</span> gotGrade<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>				<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#eceff4">})</span>
</span></span><span style="display:flex;"><span>	<span style="color:#eceff4">}</span>
</span></span><span style="display:flex;"><span><span style="color:#eceff4">}</span>
</span></span></code></pre></div><p>If we would remove any of the fixture files, we will see how the test will be
marked as failed due to the <code>t.Fatal</code> invocation:</p>
<div class="highlight"><pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rm testdata/grades/valid.csv <span style="color:#616e87;font-style:italic"># We remove the fixture</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ go <span style="color:#81a1c1">test</span> ./... -count<span style="color:#81a1c1">=</span><span style="color:#b48ead">1</span> -v -run<span style="color:#81a1c1">=</span>TestFindByStudent
</span></span><span style="display:flex;"><span><span style="color:#81a1c1">===</span> RUN   TestFindByStudent
</span></span><span style="display:flex;"><span><span style="color:#81a1c1">===</span> RUN   TestFindByStudent/ValidFixture
</span></span><span style="display:flex;"><span><span style="color:#81a1c1">===</span> RUN   TestFindByStudent/EmptyFixture
</span></span><span style="display:flex;"><span>--- FAIL: TestFindByStudent <span style="color:#81a1c1">(</span>0.00s<span style="color:#81a1c1">)</span>
</span></span><span style="display:flex;"><span>    --- FAIL: TestFindByStudent/ValidFixture <span style="color:#81a1c1">(</span>0.00s<span style="color:#81a1c1">)</span>
</span></span><span style="display:flex;"><span>        grades_test.go:8: Cannot create Gradebook: open testdata/grades/valid.csv: no such file or directory
</span></span><span style="display:flex;"><span>    --- PASS: TestFindByStudent/EmptyFixture <span style="color:#81a1c1">(</span>0.00s<span style="color:#81a1c1">)</span>
</span></span><span style="display:flex;"><span>FAIL
</span></span><span style="display:flex;"><span>FAIL	_/Users/Ilija/Documents/fixtures	0.004s
</span></span></code></pre></div><p>By having another function that takes care of building the <code>Gradebook</code>, we can
offload the complexity of the missing fixtures outside of the tests themselves.
While these concepts are simple, they&rsquo;re powerful as they lead to cleaner tests
with local test functions that are easy to maintain.</p>
<hr/>
<p><strong>EDIT October 8, 2019</strong>: As <a href="https://github.com/lyckade">Andreas Schr√∂pfer</a>
suggested in the comments, it&rsquo;s more idiomatic Go when the function receives a
<code>io.Reader</code> instead of a file path. I have updated the example code and the
article to reflect that. Thanks Andreas!</p>
<iframe src="https://captainscodebook.com/embed" width="100%" height="400" style="margin-top:2em" frameborder="0" scrolling="no"></iframe>


      </div>
    </section>
    <footer class="pt-8 max-w-prose print:hidden">
      
  <div class="flex">
    
      
      
        
        <img
          class="w-24 h-24 !mt-0 !mb-0 ltr:mr-4 rtl:ml-4 rounded-full"
          width="96"
          height="96"
          alt="Ilija Eftimov"
          src="/img/avatar_huae39953c6189b6aa60e47103b358d088_112612_192x192_fill_q75_box_smart1.jpg"
        />
      
    
    <div class="place-self-center">
      
        <div class="text-[0.6rem] leading-3 text-neutral-500 dark:text-neutral-400 uppercase">
          Author
        </div>
        <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
          Ilija Eftimov
        </div>
      
      
      <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://twitter.com/ilijaio"
          target="_blank"
          aria-label="Twitter"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://www.linkedin.com/in/ieftimov/"
          target="_blank"
          aria-label="Linkedin"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="mailto:blog@ieftimov.com"
          target="_blank"
          aria-label="Email"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://captainscodebook.com"
          target="_blank"
          aria-label="Substack"
          rel="me noopener noreferrer"
          >

</a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://dev.to/fteem"
          target="_blank"
          aria-label="Dev"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M120.12 208.29c-3.88-2.9-7.77-4.35-11.65-4.35H91.03v104.47h17.45c3.88 0 7.77-1.45 11.65-4.35 3.88-2.9 5.82-7.25 5.82-13.06v-69.65c-.01-5.8-1.96-10.16-5.83-13.06zM404.1 32H43.9C19.7 32 .06 51.59 0 75.8v360.4C.06 460.41 19.7 480 43.9 480h360.2c24.21 0 43.84-19.59 43.9-43.8V75.8c-.06-24.21-19.7-43.8-43.9-43.8zM154.2 291.19c0 18.81-11.61 47.31-48.36 47.25h-46.4V172.98h47.38c35.44 0 47.36 28.46 47.37 47.28l.01 70.93zm100.68-88.66H201.6v38.42h32.57v29.57H201.6v38.41h53.29v29.57h-62.18c-11.16.29-20.44-8.53-20.72-19.69V193.7c-.27-11.15 8.56-20.41 19.71-20.69h63.19l-.01 29.52zm103.64 115.29c-13.2 30.75-36.85 24.63-47.44 0l-38.53-144.8h32.57l29.71 113.72 29.57-113.72h32.58l-38.46 144.8z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/fteem"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://t.me/ieftimovcom"
          target="_blank"
          aria-label="Telegram"
          rel="me noopener noreferrer"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z"/></svg>

  </span>

</a
        >
      
    
  </div>

</div>
    </div>
  </div>


      
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
        <a
          class="bg-neutral-300 text-neutral-700 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800 m-1 hover:bg-primary-500 hover:text-neutral rounded min-w-[2.4rem] inline-block text-center p-1"
          href="https://www.facebook.com/sharer/sharer.php?u=https://ieftimov.com/posts/testing-in-go-fixtures/&amp;quote=Testing%20in%20Go:%20Fixtures"
          title="Share on Facebook"
          aria-label="Share on Facebook"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="bg-neutral-300 text-neutral-700 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800 m-1 hover:bg-primary-500 hover:text-neutral rounded min-w-[2.4rem] inline-block text-center p-1"
          href="https://twitter.com/intent/tweet/?url=https://ieftimov.com/posts/testing-in-go-fixtures/&amp;text=Testing%20in%20Go:%20Fixtures"
          title="Tweet on Twitter"
          aria-label="Tweet on Twitter"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="bg-neutral-300 text-neutral-700 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800 m-1 hover:bg-primary-500 hover:text-neutral rounded min-w-[2.4rem] inline-block text-center p-1"
          href="https://reddit.com/submit/?url=https://ieftimov.com/posts/testing-in-go-fixtures/&amp;resubmit=true&amp;title=Testing%20in%20Go:%20Fixtures"
          title="Submit to Reddit"
          aria-label="Submit to Reddit"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="bg-neutral-300 text-neutral-700 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800 m-1 hover:bg-primary-500 hover:text-neutral rounded min-w-[2.4rem] inline-block text-center p-1"
          href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://ieftimov.com/posts/testing-in-go-fixtures/&amp;title=Testing%20in%20Go:%20Fixtures"
          title="Share on LinkedIn"
          aria-label="Share on LinkedIn"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</a
        >
      
    
      
        <a
          class="bg-neutral-300 text-neutral-700 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800 m-1 hover:bg-primary-500 hover:text-neutral rounded min-w-[2.4rem] inline-block text-center p-1"
          href="mailto:?body=https://ieftimov.com/posts/testing-in-go-fixtures/&amp;subject=Testing%20in%20Go:%20Fixtures"
          title="Send via email"
          aria-label="Send via email"
          >

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</a
        >
      
    
  </section>


      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group" href="/posts/testing-in-go-subtests/">
              <span
                class="mr-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Testing in Go: Subtests</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2019-07-27 00:00:00 &#43;0000 UTC">27 July 2019</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group" href="/posts/simple-golang-database-seeding-abstraction-gorm/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Simple Golang database seeding abstraction for Gorm</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2019-11-16 00:00:00 &#43;0000 UTC">16 November 2019</time>
                  
                </span>
              </span>
              <span
                class="ml-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        
          <div
            class="absolute top-[100vh] ltr:right-0 rtl:left-0 w-12 pointer-events-none bottom-0"
          >
            <a
              href="#the-top"
              class="w-12 h-12 sticky pointer-events-auto top-[calc(100vh-5.5rem)] bg-neutral/50 dark:bg-neutral-800/50 backdrop-blur rounded-full text-xl flex items-center justify-center text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400"
              aria-label="Scroll to top"
              title="Scroll to top"
            >
              &uarr;
            </a>
          </div>
        
      </main><footer class="py-10 print:hidden">
  
  
    <nav class="pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
          <li
            class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"
          >
            <a
              class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
              href="/analytics"
              title=""
              >Analytics</a
            >
          </li>
        
          <li
            class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"
          >
            <a
              class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
              href="/index.xml"
              title=""
              >RSS</a
            >
          </li>
        
          <li
            class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"
          >
            <a
              class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
              href="https://forms.gle/orfXK5jh1LRaiFzo8"
              title=""
              >Suggest a topic</a
            >
          </li>
        
      </ul>
    </nav>
  
  <div class="flex items-center justify-between">
    <div>
      
      
        <p class="text-sm text-neutral-500 dark:text-neutral-400">
            &copy;
            2024
            Ilija Eftimov
        </p>
      
      
      
        <p class="text-xs text-neutral-500 dark:text-neutral-400">
          
          
          Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
            href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href="https://git.io/hugo-congo" target="_blank" rel="noopener noreferrer">Congo</a>
        </p>
      
    </div>
    
    
      <div
        class="text-sm cursor-pointer text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-14 rtl:ml-14"
      >
        <button
          id="appearance-switcher"
          class="w-12 h-12 "
          type="button"
          title="Switch to dark appearance"
        >
          <span class="inline dark:hidden">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>

</span>
          <span class="hidden dark:inline">

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>

</span>
        </button>
      </div>
    
  </div>
  
  
</footer>
<div
  id="search-wrapper"
  class="fixed inset-0 z-50 flex flex-col p-4 sm:p-6 md:p-[10vh] lg:p-[12vh] w-screen h-screen cursor-default bg-neutral-500/50 backdrop-blur-sm dark:bg-neutral-900/50 invisible"
  data-url="https://ieftimov.com/"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg border-neutral-200 top-20 bg-neutral dark:bg-neutral-800 dark:border-neutral-700"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative inline-block align-text-bottom icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-transparent focus:outline-2"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative inline-block align-text-bottom icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
</html>
